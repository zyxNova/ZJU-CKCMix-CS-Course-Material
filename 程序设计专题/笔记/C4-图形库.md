## å›¾å½¢åº“



[TOC]

### åŸºæœ¬æ¦‚å¿µ

- åæ ‡å•ä½æ˜¯inch
- åæ ‡ç³»å’Œæ­£å¸¸ä½¿ç”¨çš„åæ ‡ç³»ä¸€æ ·ï¼ŒåŸç‚¹åœ¨å·¦ä¸‹è§’

### åŸºæœ¬å‡½æ•°

#### mainåŠåˆå§‹åŒ–

```
void Main() 
{
	InitGraphics();
	OpenConsole();//å¦‚æœè¦è¾“å…¥å­—ç¬¦
	CloseConsole();
}
```

#### ç»˜å›¾å‡½æ•°

- è·å–å±å¹•ä¸­å¤®åæ ‡

`cx = GetWindowWidth()/2;`

`cy = GetWindowHeight()/2;`

- è·å–å½“å‰åæ ‡

```
x = GetCurrentX();
y = GetCurrentY();
```

- ç§»åŠ¨ç”»ç¬” 
  - æŠŠç”»ç¬”ç§»åˆ°(x,y)å¤„
  - ä¸ç”»çº¿

```c
MovePen(x, y);
```

- ç”»çº¿
  - ä»å½“å‰ä½ç½®å¼€å§‹ç”»
  - å‚æ•°æ˜¯åç§»é‡ï¼Œå•ä½æ˜¯inch
  - æ–°çš„ç”»ç¬”ä½ç½®æ˜¯çº¿æœ«ç«¯

```c
DrawLine(dx, dy);
```

- ç”»åœ†
  - å§‹ç»ˆä»å½“å‰ä½ç½®å¼€å§‹ç”»
  - ç¬¬äºŒä¸ªå‚æ•°
    - å¦‚æœæ˜¯0ï¼Œåˆ™ä»ğŸ•’å¼€å§‹ç”»
    - å¦‚æœæ˜¯90ï¼Œåˆ™ä»ğŸ•›å¼€å§‹ç”»
    - å¦‚æœæ˜¯180ï¼Œåˆ™ä»ğŸ•˜å¼€å§‹ç”»
    - å¦‚æœæ˜¯-90ï¼Œåˆ™ä»ğŸ••å¼€å§‹ç”»
  - ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šåœ†çš„è§’åº¦ï¼Œå•ä½æ˜¯åº¦

```
DrawArc(r, 0, 360);
```

- ä¸­å¿ƒåœ†

```c
//è‡ªå·±å†™ä¸€ä¸ªç”»ä¸­å¿ƒåœ†çš„å‡½æ•°ï¼
void DrawCenterCircle(double x,double y,double r) {
  MovePen(x+r,y);
  DrawArc(r,0,360);
}
```



#### è®¡æ—¶å™¨

- è®¡æ—¶å™¨å‡½æ•°åŸå‹

```c
void TimerEvent(int timerID);//timerIDæ˜¯è®¡æ—¶å™¨ç¼–å·
```

- ä¸»ç¨‹åºä¸­æ³¨å†Œå›è°ƒå‡½æ•°

`registerTimerEvent(TimerEvent);//æ³¨å†Œå›è°ƒå‡½æ•°`

- æ‰“å¼€å’Œå…³é—­è®¡æ—¶å™¨

`startTimer(timerID,interval);//æ¯éš”intervalå¯åŠ¨è®¡æ—¶å™¨ï¼Œå•ä½ms`

`cancelTimer(timerID);`



#### é”®ç›˜

- é”®ç›˜å‡½æ•°åŸå‹

`void KeyboardEventProcess(int key,int event);`

> `key`æ˜¯æŒ‰é”®çš„è™šæ‹Ÿç ï¼Œå¦‚`VS_ESCAPE`
>
> `event`åªæœ‰ä¸¤ç§ï¼Œ`KEY_DOWN`å’Œ`KEY_UP`

- æ³¨å†Œé”®ç›˜å›è°ƒå‡½æ•°

`registerKeyboardEvent(KeyboardEventProcess);`



#### é¼ æ ‡

- é¼ æ ‡å‡½æ•°åŸå‹



- æ³¨å†Œé¼ æ ‡å›è°ƒå‡½æ•°

### åº”ç”¨ä¸¾ä¾‹

#### é—ªçƒ - SetEraseMode å’Œ TimerEvent

```c
static bool isDisplayCircle = true;
if (timerID == TIMER_BLINK100) {
	bool erasemode = GetEraseMode();//åˆå§‹åŒ–æ“¦é™¤å‡½æ•°
	SetEraseMode(isDisplayCircle);//è®¾ç½®æ˜¯å¦æ“¦é™¤
	DrawCenterCircle(cx,cy,radius);
	SetEraseMode(erasemode);
	isDisplayCircle=!isDisplayCircle;
}
```

- å‡½æ•°åŠŸèƒ½ï¼š*Flash a circle drawn in the center of a window once every 500 milliseconds. The ESCAPE key is used as a switch to toggle the blink.*

```c
#include <windows.h>
#include "genlib.h"
#include "graphics.h"
#define TIMERB 1
const int mseconds = 500;
static double ccx = 1.0, ccy = 1.0; static double radius = 1.0;
static bool isB = FALSE;
static bool isD = TRUE;
void DrawCenteredCircle(double x, double y, double r); void KeyboardEventProcess(int key,int event);
void TimerEventProcess(int timerID);
void Main()
{
	InitGraphics(); 
  registerKeyboardEvent(KeyboardEventProcess); 
  registerTimerEvent(TimerEventProcess);
	ccx = GetWindowWidth()/2; 
  ccy = GetWindowHeight()/2; 
  DrawCenteredCircle(ccx, ccy, radius);
	if(isB) startTimer(TIMERB, mseconds);
}

void DrawCenteredCircle(double x, double y, double r) {
	MovePen(x+r, y);
	DrawArc(r, 0.0, 360.0); }
void KeyboardEventProcess(int key,int event) { if(event == KEY_DOWN && key == VK_ESCAPE) {
	isB = !isB; 
  if (isB) {	
    startTimer(TIMERB, mseconds); 
  } 
  else {
    cancelTimer(TIMERB);
		DrawCenteredCircle(ccx, ccy, radius); 
  }
  
void TimerEventProcess(int timerID) 
{ 
  if(timerID == TIMERB) 
  {
		bool erasemode = GetEraseMode(); 
    SetEraseMode(isD); //trueï¼Œåˆ™ç”»ç¬”è®¾ç½®ä¸ºèƒŒæ™¯è‰²ï¼›falseï¼Œåˆ™ç”»ç¬”ä¸ºæ­£å¸¸é¢œè‰²
    DrawCenteredCircle(ccx, ccy, radius); 
    SetEraseMode(erasemode); 
    isD=!isD;
  }
}
```



#### åˆ†å½¢æ ‘

```c
void FractalTree(int n, double x, double y, double length, double theta) {
	if (n > 0) {//åˆ†å½¢æ¬¡æ•°ï¼Œä¹Ÿå³é€’å½’æ ‘æ·±åº¦
	double radians = theta / 180.0 * PI;//è§’åº¦è½¬å¼§åº¦
	int dx = length * cos(radians);//è®¡ç®—xæ–¹å‘åç§»é‡
	int dy = length * sin(radians);//è®¡ç®—yæ–¹å‘åç§»é‡
	MovePen(x, y);
	DrawLine(dx, dy);//ç”»ç¬¬ä¸€æ¡ç«–çº¿
	FractalTree(n-1, x+dx, y+dy, length*0.75, theta + 15); //å³æ ‘
  FractalTree(n-1, x+dx, y+dy, length*0.75, theta - 15);//å·¦æ ‘
	} 
}
void Main() { 
  int n;
	double length;
	InitGraphics();
	OpenConsole();
	n = GetInteger();
	length = GetReal();
	CloseConsole();
	FractalTree(n, GetWindowWidth()/2.0, 0, length, 90); 
  return;
}
```

#### ç­‰è¾¹ä¸‰è§’å½¢åˆ†å½¢

```c
#include "graphics.h" 
#include <math.h> 
#define LEN 6.0 
#define PI 3.14159 
#define EPS 0.05 
typedef struct {
double x, y;
} VERTEX;
VERTEX MidPoint(VERTEX A, VERTEX B);
void DrawTriangle(VERTEX A, VERTEX B, VERTEX C); 
void FraTriangle(VERTEX A, VERTEX B, VERTEX C); 
void Main()
{
	VERTEX A, B, C;
	double cx, cy;
	InitGraphics();
	cx = GetWindowWidth()/2;
	cy = GetWindowHeight()/2;
	A.x = cx; 
  A.y = cy + LEN/2*sin(PI/3);
	B.x = cx - LEN/2; 
  B.y = cy - LEN/2*sin(PI/3); 
  C.x = cx + LEN/2; 
  C.y = B.y;
	FraTriangle(A, B, C); 
}
void DrawTriangle(VERTEX A, VERTEX B, VERTEX C)/*Draw â–³ABC*/
{
	MovePen(A.x, A.y); 
  DrawLine(B.x-A.x, B.y-A.y); 
  DrawLine(C.x-B.x, C.y-B.y); 
  DrawLine(A.x-C.x, A.y-C.y);
}
VERTEX MidPoint(VERTEX A, VERTEX B) {
	VERTEX mAB;
	mAB.x = (A.x + B.x) / 2; 
  mAB.y = (A.y + B.y) / 2; 
  return ___(1)___ ;//mAB
}
void FraTriangle(VERTEX A, VERTEX B, VERTEX C) {
	VERTEX mAB, mBC, mCA;
	if (fabs(A.x-B.x) < EPS) return;
	___(2)___;//DrawTriangle(A,B,C);
	mAB = MidPoint(A, B); mBC = MidPoint(B, C); mCA = MidPoint(C, A);
	___(3)___;//FracTriangle(A,mAB,mCA);
	___(4)___;//FracTriangle(mAB,B,mBC);
	___(5)___;//FracTriangle(mCA,mBC,C);

}
```

- æ€»ç»“ä»¥ä¸Šä¸¤ä¸ªç¨‹åºï¼Œéƒ½æ˜¯åœ¨Mainé‡Œç›´æ¥è°ƒç”¨é€’å½’å‡½æ•°
- å°†næ¬¡åˆ†å½¢ï¼Œæ‹†è§£æˆ1 + (n-1)æ¬¡åˆ†å½¢ã€‚å³å…ˆç”»å‡ºç¬¬ä¸€æ­¥ï¼Œåé¢ç”±é€’å½’å®ç°
- åˆ†å½¢æ ‘çš„ **ç¬¬ä¸€æ­¥** æ˜¯ç”»å‡ºæ ‘å¹²
- ä¸‰è§’å½¢çš„ **ç¬¬ä¸€æ­¥** æ˜¯ç”»å‡ºå¤§ä¸‰è§’å½¢