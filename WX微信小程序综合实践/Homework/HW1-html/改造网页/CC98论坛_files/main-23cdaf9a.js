!function(c){function e(e){for(var t,n,a=e[0],r=e[1],s=e[2],o=0,i=[];o<a.length;o++)n=a[o],Object.prototype.hasOwnProperty.call(u,n)&&u[n]&&i.push(u[n][0]),u[n]=0;for(t in r)Object.prototype.hasOwnProperty.call(r,t)&&(c[t]=r[t]);for(p&&p(e);i.length;)i.shift()();return m.push.apply(m,s||[]),l()}function l(){for(var e,t=0;t<m.length;t++){for(var n=m[t],a=!0,r=1;r<n.length;r++){var s=n[r];0!==u[s]&&(a=!1)}a&&(m.splice(t--,1),e=o(o.s=n[0]))}return e}var n={},u={16:0},m=[];function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=c,o.c=n,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var t=window.webpackJsonp=window.webpackJsonp||[],a=t.push.bind(t);t.push=e,t=t.slice();for(var r=0;r<t.length;r++)e(t[r]);var p=a;m.push([1230,0]),l()}({1230:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"userLogIn",function(){return q}),n.d(a,"userLogOff",function(){return J}),n.d(a,"usercenterPageLoadUnfinish",function(){return G}),n.d(a,"userNotFound",function(){return Q}),n.d(a,"userCenterLoading",function(){return K}),n.d(a,"userCenterLoaded",function(){return X}),n.d(a,"userCenterSolveError",function(){return Z}),n.d(a,"usercenterPageLoadFinish",function(){return ee}),n.d(a,"changeUserInfo",function(){return te}),n.d(a,"changeCurrentVisitingUserPage",function(){return ne}),n.d(a,"userCenterError",function(){return ae}),n.d(a,"changeUserFavoriteBoards",function(){return re}),n.d(a,"changeUserRecentTopics",function(){return se}),n.d(a,"changeUserRecentPosts",function(){return oe}),n.d(a,"changeUserHotPosts",function(){return ie}),n.d(a,"changeUserFavoritePosts",function(){return ce}),n.d(a,"changeUserFansInfo",function(){return le}),n.d(a,"changeUserFollowingsInfo",function(){return ue}),n.d(a,"changeUserCenterPage",function(){return me}),n.d(a,"followUser",function(){return pe}),n.d(a,"unfollowUser",function(){return de}),n.d(a,"userCenterTransferWealthSuccess",function(){return he});var r={};n.r(r),n.d(r,"throwError",function(){return fe}),n.d(r,"solveError",function(){return ge});var s={};n.r(s),n.d(s,"changeMessageCount",function(){return ve});var o={};n.r(o),n.d(o,"LogOut",function(){return Gt}),n.d(o,"TopicDeleted",function(){return Qt}),n.d(o,"Disconnected",function(){return Kt}),n.d(o,"UnauthorizedBoard",function(){return Xt}),n.d(o,"UnauthorizedTopic",function(){return Zt}),n.d(o,"UnauthorizedOperation",function(){return en}),n.d(o,"NotFoundBoard",function(){return tn}),n.d(o,"NotFoundTopic",function(){return nn}),n.d(o,"CannotPost",function(){return an}),n.d(o,"NotFoundUser",function(){return rn}),n.d(o,"ServerError",function(){return sn}),n.d(o,"ContentNeeded",function(){return on}),n.d(o,"OperationForbidden",function(){return cn}),n.d(o,"PageNotFound",function(){return ln}),n.d(o,"TooFrequentSearch",function(){return un});var x=n(2),I=(n(509),n(511),n(0)),i=n.n(I),c=n(11),l=n(483),u=n.n(l),m=n(181),p=n(138),d=n(485),h="USER_LOG_ON",f="USER_LOG_OFF",g="CHANGE_USERINFO",v="CHANGE_VISITING_USER",b="CHANGE_USER_FAVORITE_BOARDS",y="CHANGE_USER_FAVORITE_POSTS",E="CHANGE_USER_FANS_INFO",w="CHANGE_USER_FOLLOWINGS_INFO",C="CHANGE_USER_RECENT_TOPICS",N="CHANGE_USER_RECENT_POSTS",T="CHANGE_USER_HOT_POSTS",S="CHNAGE_USER_CENTER_PAGE",k="USER_NOT_FOUND",P="USER_CENTER_LOADING",U="USER_CENTER_LOADED",M="USER_CENTER_FETCH_ERROR",R="USER_CENTER_SOLVE_ERROR",O="USER_CENTER_PAGE_LOAD_UNFINISH",D="USER_CENTER_PAGE_LOAD_FINISH",j="USER_CENTER_FOLLOW_USER",L="USER_CENTER_UNFOLLOW_USER",F="USER_CENTER_TRANSFER_WEALTH_SUCCESS",B="THROW_ERROR",A="SOLVE_ERROR",_="CHANGE_MESSAGE_COUNT";function z(e,t){return t||function(){return{type:e}}}var V,H,W,Y,q=z(h),J=z(f),G=z(O),Q=z(k),K=z(P),X=z(U),Z=z(R),ee=z(D,function(e){return{type:D,payload:{totalPage:e}}}),te=z(g,function(e){return{type:g,payload:{newInfo:e}}}),ne=z(v,function(e,t){return void 0===e&&(e="exact"),{type:v,payload:{page:e,id:t}}}),ae=z(M,function(e){return{type:M,payload:{message:e}}}),re=z(b,function(e){return{type:b,payload:{boardsInfo:e}}}),se=z(C,function(e){return{type:C,payload:{posts:e}}}),oe=z(N,function(e){return{type:N,payload:e}}),ie=z(T,function(e){return{type:T,payload:e}}),ce=z(y,function(e){return{type:y,payload:{posts:e}}}),le=z(E,function(e){return{type:E,payload:{fansInfo:e}}}),ue=z(w,function(e){return{type:w,payload:{followingsInfo:e}}}),me=z(S,function(e){return{type:S,payload:{page:e}}}),pe=z(j,function(e){return{type:j,payload:{userId:e}}}),de=z(L,function(e){return{type:L,payload:{userId:e}}}),he=z(F,function(e){return{type:F,payload:{userNames:e}}}),fe=z(B,function(e){return{type:B,payload:{message:e}}}),ge=z(A),ve=z(_,function(e){return{type:_,payload:{message:e}}}),be=function(){this.isError=!1,this.errorMessage=""},ye=n(237),Ee=n(13),Ie=function(){this.isInQuote=!1,this.islastQuote=!1,this.imageCount=0},we=function(){function e(e,t){this._engine=e,this._options=t}return Object.defineProperty(e.prototype,"engine",{get:function(){return this._engine},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._engine.data},enumerable:!0,configurable:!0}),e}(),Ce=function(){this.autoDetectUrl=!0,this.allowExternalUrl=!0,this.allowImage=!0,this.allowExternalImage=!0,this.allowToolbox=!1,this.allowMediaContent=!0,this.allowAutoPlay=!0,this.allowEmotion=!0,this.compatibility=V.Recommended,this.allowMarkDown=!0,this.maxImageCount=1/0};(H=V||(V={}))[H.Transitional=0]="Transitional",H[H.Recommended=1]="Recommended",H[H.EnforceMorden=2]="EnforceMorden",(Y=W||(W={}))[Y.String=0]="String",Y[Y.ItemSeperator=1]="ItemSeperator",Y[Y.NameValueSeperator=2]="NameValueSeperator";var Ne,Te,Se=function(){function t(e,t){this.type=e,this.value=t}return t.stringValue=function(e){return new t(W.String,e)},t.itemSeperator=new t(W.ItemSeperator,null),t.nameValueSeperator=new t(W.NameValueSeperator,null),t}();(Te=Ne||(Ne={}))[Te.Text=0]="Text",Te[Te.Tag=1]="Tag";var xe,ke,Pe=function(){function e(e){this._parent=e}return Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),e}(),Ue=function(a){function t(e,t){var n=a.call(this,t)||this;return n._text=e,n}return x.c(t,a),Object.defineProperty(t.prototype,"type",{get:function(){return Ne.Text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),t.prototype.clone=function(e){return new t(this._text,e)},t}(Pe),Me=function(a){function o(e,t){var n=a.call(this,t)||this;return n._isClosed=!1,n._subSegments=[],n._tagData=e,n}return x.c(o,a),Object.defineProperty(o.prototype,"type",{get:function(){return Ne.Tag},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isClosed",{get:function(){return this._isClosed},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"tagData",{get:function(){return this._tagData},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"subSegments",{get:function(){return this._subSegments},enumerable:!0,configurable:!0}),o.forceClose=function(e,t){if(e.type===Ne.Text)t._subSegments.push(e.clone(t));else{var n=e;if(n.isClosed)t._subSegments.push(e.clone(t));else{console.warn("标签 %s 没有正确关闭，已经被转换为纯文字。",n.tagData.tagName),t._subSegments.push(new Ue(n.tagData.startTagString,e.parent));for(var a=0,r=n._subSegments;a<r.length;a++){var s=r[a];o.forceClose(s,t)}}}},o.prototype.close=function(){var e=this._subSegments;this._subSegments=[];for(var t=0,n=e;t<n.length;t++){var a=n[t];o.forceClose(a,this)}this._isClosed=!0},o.prototype.clone=function(e){var t=new o(this._tagData,e);t._content=this._content,t._isClosed=this._isClosed;for(var n=0,a=this._subSegments;n<a.length;n++){var r=a[n];t._subSegments.push(r.clone(t))}return t},o.prototype.getContentText=function(){for(var e=[],t=0,n=this._subSegments;t<n.length;t++){var a=n[t];a.type===Ne.Text?e.push(a.text):e.push(a.getFullText())}return e.join("")},o.prototype.getFullText=function(){return this.tagData.startTagString+this.getContentText()+this.tagData.endTagString},o}(Pe),Re=function(){function n(e,t){if(!t)throw new Error("参数不能为空。");this._originalString=e,this._parameters=t,this._namedParameters={};for(var n=0,a=t;n<a.length;n++){var r=a[n];r.name&&(this._namedParameters[r.name]=r.value)}}return Object.defineProperty(n.prototype,"orignalString",{get:function(){return this._originalString},enumerable:!0,configurable:!0}),n.parse=function(c){if(!c)return null;var e=function(i){var c=0;function e(e){function t(e){var t=i[c],n=i.indexOf(e,c+1);n<0&&(console.error("UBB: 解析标签字符串 %s 时无法找到位置 %d 处 %s 对应的结束字符串。",i,c,t),n=i.length);var a=c+1;return c=n+1,i.substring(a,n)}for(;;){if(c>=i.length)return null;var n=i[c];if(!/\s/i.test(n)){if(","===n)return c++,Se.itemSeperator;if("="===n)return c++,Se.nameValueSeperator;if('"'===n||"'"===n)return Se.stringValue(t(n));var a=c,r=e===W.ItemSeperator?/[=,]/i:/,/i,s=i.substring(c+1).match(r);if(s){var o=s.index+c+1;return c=o,Se.stringValue(i.substring(a,o))}return c=i.length,Se.stringValue(i.substring(a))}c++}}var t=[],n=W.ItemSeperator;for(;;){var a=e(n);if(!a)break;t.push(a),n=a.type}return t}(c);if(0===e.length)return null;var t=function(e){var t=[];if(!e||0===e.length)return console.error("UBB: 无法将标签字符串 %s 解析为参数的集合。",c),t;for(var n=null,a=null,r=W.ItemSeperator,s=0,o=e;s<o.length;s++){var i=o[s];switch(i.type){case W.ItemSeperator:t.push(new Oe(n,a)),a=n=null,r=W.ItemSeperator;break;case W.NameValueSeperator:if(r!==W.String)throw new Error("名称值分隔符只能出现在值之后。");n=a,a=null,r=W.NameValueSeperator;break;default:if(r===W.String)throw new Error("不能连续出现多个值。");a=i.value,r=W.String}}t.push(new Oe(n,a)),t[0].name||(t[0]=new Oe(t[0].value,null));return t}(e);return new n(c,t)},Object.defineProperty(n.prototype,"tagName",{get:function(){return this._parameters[0].name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"startTagString",{get:function(){return"["+this.orignalString+"]"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endTagString",{get:function(){return"[/"+this.tagName+"]"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mainValue",{get:function(){return this._parameters[0].value},enumerable:!0,configurable:!0}),n.prototype.value=function(e){if("number"==typeof e)return this._parameters[e].value;if("string"==typeof e)return this._namedParameters[e];throw new Error("参数必须是字符串或者数字。")},n.prototype.name=function(e){return this._parameters[e].name},Object.defineProperty(n.prototype,"parameterCount",{get:function(){return this._parameters.length},enumerable:!0,configurable:!0}),n.prototype.parameter=function(e){return this._parameters[e]},n}(),Oe=function(){function e(e,t){this._name=e,this._value=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();(ke=xe||(xe={}))[ke.Recursive=0]="Recursive",ke[ke.Text=1]="Text",ke[ke.Empty=2]="Empty";var De=function(){},je=function(){function e(){}return e.prototype.getTagMode=function(e){return xe.Recursive},e.renderTagAsString=function(e,t){return[e.startTagString,t,e.endTagString]},e}(),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.exec=function(e,t){return this.execCore(e.getContentText(),e.tagData,t)},t}(je),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.exec=function(e,t){for(var n=[],a=0,r=e.subSegments;a<r.length;a++){var s=r[a];n.push(t.engine.execSegment(s,t))}return this.execCore(n,e.tagData,t)},t}(je),Be=function(){function e(){this._namedTagHandlerList={},this._unnamedTagHanlderList=[],this._textHandlers=[]}return Object.defineProperty(e.prototype,"textHandlers",{get:function(){return this._textHandlers},enumerable:!0,configurable:!0}),e.prototype.getHandler=function(e){var t=this._namedTagHandlerList[e];if(t)return t;for(var n=0,a=this._unnamedTagHanlderList;n<a.length;n++){var r=a[n];if(r.supportedTagNames.test(e))return r}return null},e.prototype.register=function(e){this.registerInstance(new e)},e.prototype.registerInstance=function(e){if(!e||!e.supportedTagNames)throw new Error("参数 tagHandler 无效，或者未提供正确的标签名称。");"string"==typeof e.supportedTagNames?this.registerNamedCore([e.supportedTagNames],e):e.supportedTagNames instanceof Array?this.registerNamedCore(e.supportedTagNames,e):this.registerUnnamedCore(e)},e.prototype.registerText=function(e){this.registerTextInstance(new e)},e.prototype.registerTextInstance=function(e){if(!e)throw new Error("参数 textHandler 无效。");this._textHandlers.push(e)},e.prototype.registerNamedCore=function(e,t){for(var n=0,a=e;n<a.length;n++){var r=a[n];r in this._namedTagHandlerList?console.error("标签 %s 的处理程序已经被注册。",r):this._namedTagHandlerList[r]=t}},e.prototype.registerUnnamedCore=function(e){this._unnamedTagHanlderList.push(e)},e}(),Ae=function(){function b(){this._handlers=new Be,this._data=new Ie}return Object.defineProperty(b.prototype,"handlers",{get:function(){return this._handlers},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),b.prototype.getHandler=function(e){return this._handlers.getHandler(e)},b.prototype.exec=function(e,t){var n=new we(this,t);return this.execCore(e,n)},b.tryHandleEndTag=function(e,t){for(var n=t;n&&n.tagData;){if(n.tagData.tagName===e)return n.close(),n.parent;n=n.parent}return console.warn("UBB: 找不到结束标签 %s 的开始标签，该标签将被作为一般文字处理。",e),t.subSegments.push(new Ue("[/"+e+"]",t)),t},b.prototype.buildSegmentsCore=function(e,t){for(var n={lastIndex:0,exec:function(e){var t=this.lastIndex,n=e.indexOf("[",t);if(-1===n)return null;var a=e.indexOf("]",n);return-1===a?null:(this.lastIndex=a+1,[e.slice(t,n),e.slice(n+1,a)])}};;){var a=n.lastIndex,r=n.exec(e);if(!r){var s=e.substring(a);return void(s&&t.subSegments.push(new Ue(s,t)))}var o=r[0],i=r[1];o&&t.subSegments.push(new Ue(o,t));var c=i.match(/^\/(.+)$/i);if(c){var l=c[1];t=b.tryHandleEndTag(l,t)}else try{var u=Re.parse(i),m=this._handlers.getHandler(u.tagName);if(!m){console.warn("UBB: 标签字符串 %s 中给定的标签名 %s 没有有效的处理程序，将被视为一般文字",i,u.tagName),t.subSegments.push(new Ue(u.startTagString,t));continue}switch(m.getTagMode(u)){case xe.Recursive:var p=new Me(u,t);t.subSegments.push(p),t=p;break;case xe.Text:var d=e.indexOf(u.endTagString,n.lastIndex);if(-1===d)console.warn("UBB: 找不到标签字符串 %s 对应的结束标签，该内容将被视为一般文字。",u.startTagString),t.subSegments.push(new Ue(u.startTagString,t));else{var h=e.substring(n.lastIndex,d),f=new Me(u,t);t.subSegments.push(f);var g=new Ue(h,t=f);f.subSegments.push(g),f.close(),n.lastIndex=d+u.endTagString.length}break;case xe.Empty:var v=new Me(u,t);t.subSegments.push(v),v.close(),e.startsWith(u.endTagString,n.lastIndex)&&(n.lastIndex+=u.endTagString.length);break;default:throw new Error("UBB: 标签 "+u.tagName+" 的处理程序发生错误")}}catch(e){console.warn("UBB: 标签字符串 %s 解析失败，将被视为普通文字。",i),t.subSegments.push(new Ue("["+i+"]",t))}}},b.prototype.execCore=function(e,t){var n=new Me(null,null);this.buildSegmentsCore(e,n),n.close();for(var a=[],r=0,s=n.subSegments;r<s.length;r++){var o=s[r];a.push(this.execSegment(o,t))}return a},b.prototype.execTextCore=function(e,t){for(var n=0,a=this.handlers.textHandlers;n<a.length;n++){var r=a[n],s=e.match(r.supportedContent);if(s){var o=e.substr(0,s.index),i=e.substr(s.index+s[0].length),c=[];return o&&c.push(this.execTextCore(o,t)),c.push(r.exec(s,t)),i&&c.push(this.execTextCore(i,t)),c}}return e},b.prototype.execText=function(e,t){return this.execTextCore(e,t)},b.prototype.execSegment=function(e,t){if(e.type===Ne.Text){var n=e.text;return this.execText(n,t)}var a=e,r=this.getHandler(a.tagData.tagName);return r?r.exec(a,t):(console.warn("没有找到标签 %s 的处理程序，将被视为一般文字。",a.tagData.tagName),a.getFullText())},b}(),_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"noubb"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return n.options.compatibility!==V.Transitional?I.createElement("code",null,e):I.createElement("span",null,e)},t}(Le),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"b"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return I.createElement("span",{style:{fontWeight:"bold"}},e)},t}(Fe),Ve=n(222),He=n.n(Ve),We=n(223),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"img"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a=e,r=t.value("title"),s=parseInt(t.value("img")),o=n.options,i=o.allowImage,c=o.allowExternalImage,l=o.allowToolbox;return c||We(a).hostname.includes("cc98.org")||(i=!1),!i||n.data.imageCount>=n.options.maxImageCount?I.createElement("p",null,"签名档禁止使用外链图片"):(n.data.imageCount+=1,n.options.compatibility===V.EnforceMorden?1===s?I.createElement(Ye,{imageUri:a,title:r,isShowed:!1,allowToolbox:l}):I.createElement("figure",null,I.createElement(Ye,{imageUri:a,title:r,isShowed:!0,allowToolbox:l}),I.createElement("figcaption",null,r)):1===s?I.createElement(Ye,{imageUri:a,title:r,isShowed:!1,allowToolbox:l}):I.createElement(Ye,{imageUri:a,title:r,isShowed:!0,allowToolbox:l}))},t}(Le),Ye=function(n){function e(e){var t=n.call(this,e)||this;return t.toggleIsShowed=function(){t.setState(function(e){return{isShowed:!e.isShowed}})},t.toggleToolbox=function(e){t.setState(function(){return{isToolboxOn:e}})},t.state={isShowed:t.props.isShowed,isToolboxOn:!1,neverShowToolbox:!1,rotate:0},t}return x.c(e,n),e.prototype.rotateImage=function(t){this.setState(function(e){return{rotate:e.rotate+t}})},e.prototype.render=function(){var e=this,t={height:300,once:!0,offset:100};if(this.state.isShowed){if(!0!==this.props.allowToolbox||!1!==this.state.neverShowToolbox)return I.createElement(He.a,x.a({},t),I.createElement("img",{style:{maxWidth:"100%"},src:this.props.imageUri,alt:this.props.title}));var n=null;return n=this.state.isToolboxOn?I.createElement("div",{className:"ubb-image-toolbox"},I.createElement("button",{onClick:function(){return e.rotateImage(90)}},I.createElement("i",{className:"fa fa-rotate-right"})),I.createElement("button",{onClick:function(){return e.rotateImage(-90)}},I.createElement("i",{className:"fa fa-rotate-left"})),I.createElement("button",{onClick:function(){return window.open(e.props.imageUri)}},I.createElement("i",{className:"fa fa-search-plus"})),I.createElement("button",{onClick:this.toggleIsShowed},I.createElement("i",{className:"fa fa-eye-slash"})),I.createElement("button",{onClick:function(){return e.setState({neverShowToolbox:!0})}},I.createElement("i",{className:"fa fa-close"}))):null,I.createElement("div",{onMouseLeave:function(){return e.toggleToolbox(!1)},onMouseEnter:function(){return e.toggleToolbox(!0)}},n,I.createElement(He.a,x.a({},t),I.createElement("img",{style:{maxWidth:"100%",transform:"rotate("+this.state.rotate+"deg)"},src:this.props.imageUri,alt:this.props.title})))}return I.createElement("div",{className:"hiddenImage",onClick:this.toggleIsShowed},"点击查看图片")},e}(I.Component),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"i"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return I.createElement("i",null,e)},t}(Fe),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"size"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a=parseInt(t.value("size"));if(isNaN(a)||a<=0)return e;a=7<a?3.5:a/2;var r={fontSize:(a/=1.5)+"rem"};return I.createElement("span",{style:r},e)},t}(Fe),Ge=function(f){function e(){return null!==f&&f.apply(this,arguments)||this}return x.c(e,f),Object.defineProperty(e.prototype,"supportedTagNames",{get:function(){return["quote","quotex"]},enumerable:!0,configurable:!0}),e.prototype.exec=function(e,n){var a=this;if(n.data.isInQuote)return f.prototype.exec.call(this,e,n);n.data.isInQuote=!0;var t,r,s=function(e){if(e.type!==Ne.Tag)return!1;var t=e.tagData.tagName;return-1!==a.supportedTagNames.indexOf(t)},o=[e],i=e;do{t=!1;for(var c=i.subSegments,l=0,u=c;l<u.length;l++){var m=u[l];if(s(m))i=c.splice(c.indexOf(m),1)[0],o.push(i),t=!0}}while(t);if(1<o.length){o.reverse(),o[0].subSegments.splice(1,0,new Ue("\n",o[0]));for(var p=1;p<o.length;p++)if((r=o[p].subSegments)[0]&&r[0].type===Ne.Tag&&r[0].subSegments[0]&&r[0].subSegments[0].type===Ne.Text&&0===r[0].subSegments[0].text.indexOf("以下是引用")&&r.slice(1,r.length).every(function(e){return e.type===Ne.Text&&!e.text.match(/\S/)})){var d=o[p].subSegments.shift().clone(o[p-1]);o[p-1].subSegments.unshift(d),o[p-1].subSegments.splice(1,0,new Ue("\n",o[p-1])),o.splice(p,1),p--}}var h=o.map(function(e,t){return t===o.length-1?n.data.islastQuote=!0:n.data.islastQuote=!1,n.engine.execSegment(e,n)});return n.data.isInQuote=!1,I.createElement(Qe,{quoteItems:h})},e.prototype.execCore=function(e,t,n){var a={boxSizing:"border-box",width:"100%",padding:"10px 0 10px 0",borderBottom:"1px solid rgb(204,204,204)",overflowY:"hidden"};return n.data.islastQuote&&(a.borderBottom=null),I.createElement("div",{style:a},e)},e}(Fe),Qe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={isShowed:e.props.quoteItems.length<=2},e}return x.c(e,t),e.prototype.showButtonClick=function(){this.setState({isShowed:!0})},e.prototype.render=function(){var e=I.createElement("div",{style:{display:"flex",justifyContent:"center",padding:"14px 0",borderBottom:"1px solid rgb(204,204,204)"}},I.createElement("button",{style:{width:"auto",marginTop:0,alignSelf:"center"},className:"hiddenImage",type:"button",onClick:this.showButtonClick.bind(this)},"展开剩余引用")),t=this.state.isShowed,n=this.props.quoteItems,a=t?n:n.slice(n.length-2);return I.createElement("div",{style:{backgroundColor:"#F5FAFF",border:"1px solid rgb(204,204,204)",padding:"0 17px 0 17px",maxHeight:"800px",overflowY:"auto"}},!t&&e,a)},e}(I.PureComponent),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"color"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a={color:t.value("color")};return I.createElement("span",{style:a},e)},t}(Fe),Xe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return x.c(r,e),Object.defineProperty(r.prototype,"supportedTagNames",{get:function(){return"url"},enumerable:!0,configurable:!0}),r.isSafe=function(e){return-1===[" ","javascript:","data:"].indexOf(e.protocol)},r.prototype.execCore=function(e,t,n){var a=We(t.value("url")||e,{});return r.isSafe(a)?!1===n.options.allowExternalUrl&&"www.cc98.org"!==a.host?e:I.createElement("a",{href:a.href,target:"_blank",className:"urlStyle"},e):e},r}(Fe),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"u"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return n.options.compatibility===V.EnforceMorden?I.createElement("span",{style:{textDecoration:"underline"}},e):I.createElement("u",null,e)},t}(Fe),et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"del"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return I.createElement("span",{style:{textDecoration:"line-through"}},e)},t}(Fe),tt=n(727),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return["mp3","audio"]},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){if(!1===n.options.allowMediaContent)return e;var a=t.value("title");return I.createElement(at,{src:e,title:a})},t}(Le),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){try{this.ap=new tt({element:this.div,autoplay:!1,preload:"metadata",music:{url:encodeURI(this.props.src),title:this.props.title?this.props.title:encodeURI(this.props.src),author:"",pic:"/static/images/audio_cover.png"}}),this.div.getElementsByClassName("aplayer-author")[0].innerHTML=""}catch(e){}},t.prototype.componentWillUnmount=function(){this.ap&&this.ap.destroy()},t.prototype.render=function(){var t=this;return I.createElement("div",{className:"aplayer",style:{whiteSpace:"normal",width:"30rem"},ref:function(e){return t.div=e}})},t}(I.Component),rt=n(728),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"video"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return!1===n.options.allowMediaContent?e:I.createElement(ot,{src:e})},t}(Le),ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dp=null,t.state={height:"28.8984375rem"},t.initPlayer=function(e){try{t.dp=new rt({element:t.div,autoplay:!1,preload:"metadata",video:{url:encodeURI(t.props.src),type:e}})}catch(e){}t.dp&&(t.dp.on("abort",function(e){return null}),t.dp.on("fullscreen",function(e){return t.setState({height:"auto"})}),t.dp.on("fullscreen_cancel",function(e){return t.setState({height:"28.8984375rem"})}),t.dp.on("webfullscreen",function(e){return t.setState({height:"100%"})}),t.dp.on("webfullscreen_cancel",function(e){return t.setState({height:"28.8984375rem"})}),t.div.getElementsByClassName("dplayer-menu")[0].innerHTML='<div class="dplayer-menu-item"><a target="_blank" href="https://github.com/MoePlayer/DPlayer">关于 DPlayer 播放器</a></div>')},t}return x.c(t,e),t.prototype.componentDidMount=function(){var t=this;if(this.props.src.match(/\.m3u8$/))try{new Hls,this.initPlayer("hls")}catch(e){var n=document.createElement("script");n.src="/static/content/hls.min.js",document.getElementsByTagName("head")[0].appendChild(n),n.onload=function(){t.initPlayer("hls")}}else this.initPlayer()},t.prototype.componentWillUnmount=function(){this.dp&&(this.dp.destroy(),this.div.innerHTML="")},t.prototype.render=function(){var t=this;return I.createElement("div",{style:{display:"flex"}},I.createElement("div",{className:"dplayer",style:{whiteSpace:"normal",height:this.state.height},ref:function(e){return t.div=e}}))},t}(I.Component),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"cursor"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a={cursor:t.value("cursor")};return I.createElement("span",{style:a},e)},t}(Fe),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"english"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return I.createElement("span",{style:{fontFamily:"Arial"}},e)},t}(Fe),lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"user"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a=e;return I.createElement("a",{href:"/user/name"+encodeURI(a),style:{cursor:"pointer"}},a)},t}(Le),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"code"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){for(var a=e.split("\n");!a[0]&&0<a.length;)a.shift();for(;!a[a.length-1]&&0<a.length;)a.pop();var r=a.map(function(e,t){return I.createElement("li",null,e)});return I.createElement("div",{className:"ubb-code"},I.createElement("ol",null,r))},t}(Le),mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"font"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a={fontFamily:t.value("font")};return I.createElement("span",{style:a},e)},t}(Fe),pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"align"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a={textAlign:t.value("align")};return I.createElement("span",{style:a},I.createElement("div",null,e))},t}(Fe),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"upload"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a,r=e,s=t.value(0),o=n.options.allowToolbox;switch(1===t.parameterCount&&(a=0),2===t.parameterCount&&(a=parseInt(t.value(1))),s){case"jpg":case"jpeg":case"png":case"gif":case"bmp":case"webp":return n.options.allowImage?n.options.compatibility===V.EnforceMorden?1===a?I.createElement(Ye,{imageUri:r,title:"upload图片",isShowed:!1,allowToolbox:o}):I.createElement("figure",null,I.createElement(Ye,{imageUri:r,title:"upload图片",isShowed:!0,allowToolbox:o}),I.createElement("figcaption",null,"upload图片")):1===a?I.createElement(Ye,{imageUri:r,title:"upload图片",isShowed:!1,allowToolbox:o}):I.createElement(Ye,{imageUri:r,title:"upload图片",isShowed:!0,allowToolbox:o}):I.createElement("a",{href:r},r);default:return I.createElement("a",{className:"download-file",href:r},"点击下载文件")}},t}(Le),ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"left"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return I.createElement("span",{style:{textAlign:"left"}},I.createElement("div",null,e))},t}(Fe),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"center"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return I.createElement("span",{style:{textAlign:"center"}},I.createElement("div",null,e))},t}(Fe),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"right"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return I.createElement("span",{style:{textAlign:"right"}},I.createElement("div",null,e))},t}(Fe),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"table"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return I.createElement("table",{className:"UBBTableTag"},e)},t}(Fe),bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"td"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a=1,r=1;return 2===t.parameterCount&&(a=parseInt(t.value(0)),r=parseInt(t.value(1))),I.createElement("td",{rowSpan:a,colSpan:r},e)},t}(Fe),yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"th"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a=1,r=1;return 2===t.parameterCount&&(a=parseInt(t.value(0)),r=parseInt(t.value(1))),I.createElement("th",{rowSpan:a,colSpan:r},e)},t}(Fe),Et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"tr"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){return I.createElement("tr",null,e)},t}(Fe),It=n(319),wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"topic"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a,r=e;t.value(0);1===t.parameterCount&&(a=parseInt(t.value(0))),2===t.parameterCount&&(a=parseInt(t.value(1)));var s="/topic/"+a;return I.createElement(It.a,{to:s},r)},t}(Fe),Ct=n(362),Nt=n(384),Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"md"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a=e;return n.options.allowMarkDown?I.createElement(St,{content:a}):I.createElement("div",null,a)},t}(Le),St=function(r){function e(e,t){var n=r.call(this,e,t)||this,a=Math.floor(1e6*Math.random());return n.state={divid:"Markdown"+a},n}return x.c(e,r),e.prototype.render=function(){var e=this.props.content.replace(/\n>[\s\S]*?\n\n/g,function(e){return e.replace(/\n[^\n](?!>)/g,function(e){return e.replace(/\n(?!>)/,"\n>")})});if(">"===e[0]){var t=e.indexOf("\n\n");if(-1===t)e=e.replace(/\n[^\n](?!>)/g,function(e){return e.replace(/\n(?!>)/,"\n>")});else e=e.substr(0,t).replace(/\n[^\n](?!>)/g,function(e){return e.replace(/\n(?!>)/,"\n>")})+e.substr(t+1,e.length)}return e=e.replace(/发言：\*\*\n/g,"发言：**\n\n"),I.createElement("div",{id:this.state.divid,style:{maxWidth:"80%",overflow:"hidden"}},Ct().use(Nt).processSync(e).contents)},e}(I.Component),xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"pm"},enumerable:!0,configurable:!0}),t.prototype.execCore=function(e,t,n){var a="/message/message?name="+t.value(0);return I.createElement(It.a,{to:a},e)},t}(Fe),kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"bili"},enumerable:!0,configurable:!0}),t.prototype.getBiliPage=function(e){for(var t=e.split("?")[1],n=t?t.split("&"):"",a=0;a<n.length;a++){var r=n[a].split("=");if("p"==r[0])return r[1]}return"1"},t.prototype.execCore=function(e,t,n){if(!1===n.options.allowMediaContent)return e;var a=parseInt(t.value("bili"))||1,r="",s=/^\d+$/.test(e),o=/^BV[A-Za-z0-9]+/.test(e),i=/(https?:\/\/)?www.bilibili.com\/video\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/.test(e);if(s)r="https://player.bilibili.com/player.html?aid="+e+"&page="+a;else if(o)r="https://player.bilibili.com/player.html?bvid="+e+"&page="+a;else{if(!i)return e;var c=/^(https?:\/\/)?www\.bilibili\.com\/video\/av[0-9]+/.test(e),l=/^(https?:\/\/)?www\.bilibili\.com\/video\/BV[0-9A-Za-z]+/.test(e),u=this.getBiliPage(e);if(c){r="https://player.bilibili.com/player.html?aid="+e.split("bilibili.com/video/av")[1].split("?")[0].split("/")[0]+"&page="+u}else{if(!l)return e;r="https://player.bilibili.com/player.html?bvid="+e.split("bilibili.com/video/")[1].split("?")[0].split("/")[0]+"&page="+u}}return I.createElement("div",null,I.createElement("iframe",x.a({},{border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"},{src:r,allowfullscreen:"allowfullscreen",style:{border:"none"},width:"640",height:"480",scrolling:"no"})))},t}(Le),Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"line"},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return xe.Empty},t.prototype.execCore=function(e,t,n){return I.createElement("hr",null)},t}(Fe),Ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/em\d{2}/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return xe.Empty},t.prototype.execCore=function(e,t,n){var a="/static/images/em/em"+t.tagName.match(/\d{2}/).toString()+".gif";return n.options.allowEmotion?I.createElement("div",{style:{display:"inline"}},I.createElement("img",{src:a,alt:""}),e):I.createElement("div",{style:{display:"inline"}},e)},t}(Fe),Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/ac\d{2}/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return xe.Empty},t.prototype.execCore=function(e,t,n){var a="/static/images/ac/"+t.tagName.replace(/ac/gi,"")+".png";return n.options.allowEmotion?I.createElement("div",{style:{display:"inline"}},I.createElement("img",{src:a,alt:""}),e):I.createElement("div",{style:{display:"inline"}},e)},t}(Fe),Rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/[acf]:/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return xe.Empty},t.prototype.getAnimalUrl=function(e){return"/static/images/mahjong/animal2017/"+e+".png"},t.prototype.getCartoonUrl=function(e){switch(e){case"018":case"049":case"096":return"/static/images/mahjong/carton2017/"+e+".gif";default:return"/static/images/mahjong/carton2017/"+e+".png"}},t.prototype.getFaceUrl=function(e){switch(e){case"004":case"009":case"056":case"061":case"062":case"087":case"115":case"120":case"137":case"168":case"169":case"175":case"206":return"/static/images/mahjong/face2017/"+e+".gif";default:return"/static/images/mahjong/face2017/"+e+".png"}},t.prototype.execCore=function(e,t,n){var a=t.tagName,r=a.match(/[acf]/gi)[0],s=a.replace(r+":",""),o="";switch(r){case"a":o=this.getAnimalUrl(s);break;case"c":o=this.getCartoonUrl(s);break;case"f":o=this.getFaceUrl(s)}return I.createElement("div",{style:{display:"inline"}},I.createElement("img",{src:o,alt:""}),e)},t}(Fe),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/tb\d{2}/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return xe.Empty},t.prototype.execCore=function(e,t,n){var a="/static/images/tb/tb"+t.tagName.match(/\d{2}/).toString()+".png";return I.createElement("div",{style:{display:"inline"}},I.createElement("img",{src:a,alt:""}),e)},t}(Fe),Dt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._pattern=/(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/i,e}return x.c(e,t),Object.defineProperty(e.prototype,"supportedContent",{get:function(){return this._pattern},enumerable:!0,configurable:!0}),e.prototype.exec=function(e,t){var n=e[0];return t.options.autoDetectUrl?I.createElement("a",{href:n,target:"_blank",className:"urlStyle"},n):n},e}(De),jt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._pattern=/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]\.(com|org|cn|net|cc|xyz|top|club|shop|xin|wang|vip|ink|link|tv|work|me|info|mobi|online|site|tech|ren|pro|ltd|fun|kim|red|group|store|biz|name|wiki|game|help|co|so|hk|tel|asia|lol|studio|design|live|lawyer|software|band|press|space|website|date|trade|party|win|video|news|pw|photo|pub|click|loan|bid|moe)/i,e}return x.c(e,t),Object.defineProperty(e.prototype,"supportedContent",{get:function(){return this._pattern},enumerable:!0,configurable:!0}),e.prototype.exec=function(e,t){var n=e[0];return t.options.autoDetectUrl?I.createElement("a",{href:"http://"+n,target:"_blank",className:"urlStyle"},n):n},e}(De),Lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return"needreply"},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return xe.Empty},t.prototype.execCore=function(e,t,n){return I.createElement("div",null,I.createElement("hr",null),I.createElement("div",{style:{backgroundColor:"#F5FAFF",border:"1px solid rgb(204,204,204)",padding:"10px 17px",color:"red",margin:"6px 0"}},"该内容回复后才可浏览"),I.createElement("hr",null))},t}(Fe),Ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/ms\d{2}/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return xe.Empty},t.prototype.execCore=function(e,t,n){var a="/static/images/ms/ms"+t.tagName.replace(/ms/gi,"")+".png";return n.options.allowEmotion?I.createElement("div",{style:{display:"inline"}},I.createElement("img",{src:a,alt:""}),e):I.createElement("div",{style:{display:"inline"}},e)},t}(Fe),Bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),Object.defineProperty(t.prototype,"supportedTagNames",{get:function(){return/CC98\d{2}/i},enumerable:!0,configurable:!0}),t.prototype.getTagMode=function(e){return xe.Empty},t.prototype.execCore=function(e,t,n){var a="/static/images/CC98/CC98"+t.tagName.replace(/CC98/gi,"")+".gif";return n.options.allowEmotion?I.createElement("div",{style:{display:"inline"}},I.createElement("img",{src:a,alt:""}),e):I.createElement("div",{style:{display:"inline"}},e)},t}(Fe);var At,_t,zt,Vt,Ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e,t,n=this.props.isSignature,a=this.props.engine||n?((t=new Ae).handlers.register(ze),t.handlers.register($e),t.handlers.register(qe),t.handlers.register(Je),t.handlers.register(Ke),t.handlers.register(Xe),t.handlers.register(Ze),t.handlers.register(et),t.handlers.register(nt),t.handlers.register(mt),t.handlers.register(pt),t.handlers.register(ht),t.handlers.register(ft),t.handlers.register(gt),t.handlers.register(wt),t.handlers.register(xt),t.handlers.register(_e),t.handlers.registerText(Dt),t.handlers.registerText(jt),t):((e=new Ae).handlers.register(ze),e.handlers.register($e),e.handlers.register(qe),e.handlers.register(Je),e.handlers.register(Ge),e.handlers.register(Ke),e.handlers.register(Xe),e.handlers.register(Ze),e.handlers.register(et),e.handlers.register(nt),e.handlers.register(st),e.handlers.register(it),e.handlers.register(ct),e.handlers.register(lt),e.handlers.register(ut),e.handlers.register(mt),e.handlers.register(pt),e.handlers.register(dt),e.handlers.register(ht),e.handlers.register(ft),e.handlers.register(gt),e.handlers.register(vt),e.handlers.register(bt),e.handlers.register(yt),e.handlers.register(Et),e.handlers.register(wt),e.handlers.register(Tt),e.handlers.register(Pt),e.handlers.register(xt),e.handlers.register(_e),e.handlers.register(kt),e.handlers.register(Ut),e.handlers.register(Mt),e.handlers.register(Rt),e.handlers.register(Ft),e.handlers.register(Bt),e.handlers.register(Ot),e.handlers.register(Lt),e.handlers.registerText(Dt),e.handlers.registerText(jt),e),r=this.props.options||new Ce,s=this.props.code,o=a.exec(String(s),r),i={whiteSpace:"pre-wrap",width:"100%"};return r.compatibility===V.Transitional?I.createElement("blockquote",{style:i},o):I.createElement("article",{style:i},o)},t}(I.PureComponent),Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){var e=this.props.title||"CC98论坛";document.title=e},t.prototype.componentWillReceiveProps=function(e){if(e.title!==this.props.title){var t=e.title||"CC98论坛";document.title=t}},t.prototype.render=function(){return this.props.children?I.Children.only(this.props.children):null},t}(I.Component),$t=n(1241),Yt=n(486),qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=this.props,t=e.text,n=e.url,a=e.active;return I.createElement("li",{className:"page-item"},I.createElement(It.a,{className:"page-link"+(a?" active":""),to:n},t))},t}(I.PureComponent),Jt=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.handleInput=function(e){var t=parseInt(e.target.value,10);isNaN(t)||t<1||t>n.props.totalPage||n.setState({nextPage:t})},n.state={nextPage:n.props.page},n}return x.c(e,a),e.prototype.render=function(){var e=this.props,t=e.page,n=e.url,a=e.totalPage,r=[],s=Math.max(1,t-3),o=Math.min(a,t+3);if(o-s!=6){var i=6-(o-t),c=6-(t-s);s=Math.max(1,t-i),o=Math.min(a,t+c)}for(var l=s;l<=o;l++)r.push(l);var u=1!==r[0],m=r[r.length-1]!==a,p=1!==s,d=o!==a,h=20<a;return I.createElement("div",{className:"pagination"},I.createElement("ul",{className:"page-nav"},u&&I.createElement(qt,{text:"1",url:n+"1#1"}),p&&I.createElement(qt,{text:"‹",url:""+n+(t-1)+"#1"}),r.map(function(e){return I.createElement(qt,{key:e,text:""+e,url:""+n+e+"#1",active:t===e})}),d&&I.createElement(qt,{text:"›",url:""+n+(t+1)+"#1"}),m&&I.createElement(qt,{text:""+a,url:""+n+a+"#1"})),h&&I.createElement("div",{className:"page-goto"},I.createElement("div",null,I.createElement("input",{onChange:this.handleInput,placeholder:"跳转到"})),I.createElement("div",null,I.createElement(It.a,{to:""+n+this.state.nextPage+"#1"}," Go "))))},e}(I.Component),Gt=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"您未登录 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/401.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"您当前未登录"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/logon"},"点我登录")))},Qt=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"帖子被删除了 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"帖子被删除"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},Kt=function(){return I.createElement("div",null,I.createElement(Wt,{title:"网络中断 - CC98论坛"}),I.createElement("div",null,"网络连接中断"))},Xt=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"您没有权限进入这个版面 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/401.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"您没有权限进入这个版面或未登陆"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/logon"},"点我登录")))},Zt=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"您没有权限进入这个主题 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/401.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"您没有权限进入这个主题"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},en=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"您没有权限执行这个操作 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/401.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"您没有权限进行这个操作"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},tn=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"版面不存在 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"版面不存在"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},nn=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"帖子不存在 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"帖子不存在"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},an=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"您还不能发帖 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/403.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"你无法在本版发帖，可能的原因有：权限不足、未达到发帖门槛、版面已锁定、账号受到处罚等。"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},rn=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"用户不存在 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"用户不存在"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},sn=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"服务器发送错误 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/500.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"服务器发送错误"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},on=function(){return I.createElement("div",null,I.createElement(Wt,{title:"请输入内容 - CC98论坛"}),I.createElement("div",{className:"errorText"},"402需要输入内容"))},cn=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"操作失败或被拒绝 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/403.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"操作失败或被拒绝"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},ln=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"页面不存在 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/404.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"页面不存在"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},un=function(){return I.createElement("div",{className:"errorState"},I.createElement(Wt,{title:"操作失败或被拒绝 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{className:"errorIcon",src:"/static/images/403.png"})),I.createElement("div",{className:"errorTitle"},"糟糕！好像出错了"),I.createElement("div",{className:"errorText"},"可能的原因有："),I.createElement("div",{className:"errorText"},"1. 你没有权限进行该操作；"),I.createElement("div",{className:"errorText"},"2. 你的请求过快。出于服务器性能考虑，目前设定为10秒内最多搜索一次。"),I.createElement("div",{className:"row returnIndexBtn"},I.createElement(It.a,{to:"/"},"返回首页")))},mn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=this.props.data;return""==e?I.createElement("div",null):I.createElement("div",{className:"announcement"},I.createElement("div",{className:"mainPageTitle1"},I.createElement("div",{className:"mainPageTitleRow",style:{width:"100%"}},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{style:{flexGrow:1},className:"mainPageTitleText"},"全站公告"))),I.createElement("div",{className:"announcementContent"},I.createElement(Ht,{code:e})))},t}(I.Component),pn=function(n){function e(e){var t=n.call(this,e)||this;return t.state={index:0},t.handleMouseEnter=t.handleMouseEnter.bind(t),t.convertButton=t.convertButton.bind(t),t}return x.c(e,n),e.prototype.componentWillReceiveProps=function(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){return t=n.data.length,this.setState({index:Math.floor(Math.random()*t)}),[2]})})},e.prototype.handleMouseEnter=function(e){this.setState({index:e})},e.prototype.convertButton=function(e,t,n){var a=this,r=e?"recommendedReadingButtonSelected":"recommendedReadingButton";return I.createElement("div",{className:r,onMouseEnter:function(){a.handleMouseEnter(t)}})},e.prototype.render=function(){var e=this.props.data,t=e.length,n=this.state.index,a=new Array(t);a.fill(0),a[n]=1;var r=a.map(this.convertButton),s=t?e[n].imageUrl:"",o=t?e[n].url:"",i=t?e[n].title:"",c=t?e[n].content:"";return I.createElement("div",{className:"recommendedReading"},I.createElement("div",{className:"mainPageTitle2"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},"推荐阅读"))),I.createElement("div",{className:"recommendedReadingContent"},I.createElement("div",{className:"recommendedReadingImage"},I.createElement("img",{src:s})),I.createElement("div",{className:"column",style:{flexGrow:1}},I.createElement("div",{className:"recommendedReadingTitle"},I.createElement("a",{href:o,target:"_blank"},i)),I.createElement("div",{className:"recommendedReadingAbstract"},c),I.createElement("div",{className:"recommendedReadingButtons"},r))))},e}(I.Component),dn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.convertMainPageTopic=function(e){if(!e.id)return I.createElement("div",null,e.title);var t="/board/"+e.boardId,n="/topic/"+e.id+"/1";return I.createElement("div",{className:"mainPageListRow"},I.createElement("div",{className:"mainPageListBoardName"}," ",I.createElement("a",{href:t,target:"_blank"},"[",e.boardName,"]")),I.createElement("div",{className:"mainPageListTitle"},I.createElement("a",{href:n,target:"_blank"},e.title)))},t.prototype.render=function(){var e=this.props.data;if(e===[]){var t=Gn("mainPageHotTopic");e=t||[{title:"数据库正在计算新的十大数据，请前辈等会再来~",id:0,boardName:"错误提示",boardId:0}]}return I.createElement("div",{className:"mainPageList"},I.createElement("div",{className:"mainPageTitle1"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},"热门话题")),I.createElement("div",{className:"mainPageTitleRow"},I.createElement("div",{className:"mainPageTitleText"},I.createElement("a",{href:"/topic/hot-weekly",target:"_blank"},"本周")),I.createElement("div",{className:"mainPageTitleText"},I.createElement("a",{href:"/topic/hot-monthly",target:"_blank"},"本月")),I.createElement("div",{className:"mainPageTitleText"},I.createElement("a",{href:"/topic/hot-history",target:"_blank"},"历史上的今天")))),I.createElement("div",{className:"mainPageListContent1"},e.map(this.convertMainPageTopic)))},t}(I.Component),hn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.convertMainPageTopic=function(e){var t="/topic/"+e.id+"/1";return I.createElement("div",{className:"mainPageListRow"},I.createElement("div",{className:"mainPageListTitle"},I.createElement("a",{href:t,target:"_blank"},e.title)))},t.prototype.render=function(){var e=this.props.mores.map(function(e){return I.createElement("div",{className:"mainPageTitleText"},I.createElement("a",{href:e.url,target:"_blank"},e.name))}),t=this.props.style;return"black"===t?I.createElement("div",{className:"mainPageList"},I.createElement("div",{className:"mainPageTitle2"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},this.props.name)),I.createElement("div",{className:"mainPageTitleRow"},e)),I.createElement("div",{className:"mainPageListContent2"},this.props.data.map(this.convertMainPageTopic))):"blue"===t?I.createElement("div",{className:"mainPageList"},I.createElement("div",{className:"mainPageTitle1"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},this.props.name)),I.createElement("div",{className:"mainPageTitleRow"},e)),I.createElement("div",{className:"mainPageListContent1"},this.props.data.map(this.convertMainPageTopic))):void 0},t}(I.Component),fn=(function(n){function e(e){var t=n.call(this,e)||this;return t.state={testContent:""},t.handleChange=t.handleChange.bind(t),t.urlTextHanderler=t.urlTextHanderler.bind(t),t}x.c(e,n),e.prototype.handleChange=function(e){this.setState({testContent:e.target.value})},e.prototype.urlTextHanderler=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){return t=/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+/gim,n=/cc98\.org/i,a=/zju\.edu\.cn/i,r=/nexushd\.org/i,s=this.state.testContent,(o=s.match(t))&&(i=o[0],n.test(i)||a.test(i)||r.test(i)),[2]})})},e.prototype.postAd=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return"/index/column/24",t={type:4,title:"一个图片不一样的广告",url:"www.cc98.org",imageUrl:"/images/推荐功能.jpg",enable:!0,days:10},n=JSON.stringify(t),a=Gn("accessToken"),(r=new Headers).append("Authorization",a),r.append("Content-Type","application/json"),[4,Zn("/index/column/24",{method:"PUT",headers:r,body:n})];case 1:return e.sent(),[2]}})})},e.prototype.signIn=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return"/me/signin",t=Gn("accessToken"),(n=new Headers).append("Authorization",t),n.append("Content-Type","application/json"),n.append("Content-Type","application/json"),[4,Zn("/me/signin",{method:"POST",headers:n,body:"日常"})];case 1:return e.sent(),[2]}})})},e.prototype.render=function(){return I.createElement("div",{className:"mainPageList"},I.createElement("div",{className:"mainPageTitle2"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},"测试区"))),I.createElement("div",{className:"mainPageListContent2"},I.createElement("div",null,"这里是可爱的adddna测试的地方~"),I.createElement("input",{name:"testContent",type:"text",id:"loginName",onChange:this.handleChange,value:this.state.testContent}),I.createElement("div",null,"封印封印")))}}(I.Component),function(e,t,n,a){this.imageUrl=e,this.title=t,this.url=n,this.content=a}),gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.convertRecommendedFunction=function(e){return I.createElement("div",{className:"recommendedFunctionRow"},I.createElement("div",{className:"recommendedFunctionImage"},I.createElement("img",{src:e.imageUrl})),I.createElement("div",{className:"recommendedFunctionTitle"},I.createElement("a",{href:e.url,target:"_blank"},e.title)))},t.prototype.render=function(){return I.createElement("div",{className:"recommendedFunction"},I.createElement("div",{className:"mainPageTitle1"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},"推荐功能"))),I.createElement("div",{className:"recommendedFunctionContent"},this.props.data.map(this.convertRecommendedFunction)))},t}(I.Component),vn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.convertSchoolNews=function(e){return I.createElement("div",{className:"schoolNewsRow"},I.createElement("div",{className:"schoolNewsTitle"},I.createElement("a",{href:e.url,target:"_blank"},e.title)))},t.prototype.render=function(){return I.createElement("div",{className:"schoolNews"},I.createElement("div",{className:"mainPageTitle2"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},"校园新闻"))),I.createElement("div",{className:"schoolNewsContent"},this.props.data.map(this.convertSchoolNews)))},t}(I.Component),bn=function(a){function e(e){var t=a.call(this,e)||this,n=Yn("mainAds");return n||(n=new Array),t.state={ads:n,index:0},t.changeIndex=t.changeIndex.bind(t),t.handleMouseEnter=t.handleMouseEnter.bind(t),t.convertButton=t.convertButton.bind(t),t}return x.c(e,a),e.prototype.getAds=function(){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return(t=Yn("mainAds"))?[2,t]:[3,1];case 1:return t=new Array,[4,Zn("/config/global/advertisement")];case 2:return[4,e.sent().json()];case 3:for(n=e.sent(),a=0;a<n.length;a++)t[a]=new fn(n[a].imageUrl,n[a].title,n[a].url,n[a].content);return $n("mainAds",t),[2,t]}})})},e.prototype.componentWillMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,this.getAds()];case 1:return t=e.sent(),n=t.length,this.setState({ads:t,index:Math.floor(Math.random()*n)}),[2]}})})},e.prototype.componentDidMount=function(){var e=this;this.timer=setInterval(function(){e.changeIndex(e.state.index)},2e4)},e.prototype.componentWillUnmount=function(){clearInterval(this.timer)},e.prototype.changeIndex=function(e){var t=e+1;this.state.ads.length<=t&&(t=0),this.setState({index:t})},e.prototype.handleMouseEnter=function(e){this.setState({index:e})},e.prototype.convertButton=function(e,t,n){var a=this,r=e?"adButtonSelected":"adButton";return I.createElement("div",{key:t,className:r,onMouseEnter:function(){a.handleMouseEnter(t)}})},e.prototype.render=function(){var e=this.state.ads,t=this.state.index,n=e.length,a=new Array(n);a.fill(0),a[t]=1;var r=a.map(this.convertButton),s=e.length?e[t].url:"",o=e.length?e[t].imageUrl:"";return I.createElement("div",{style:{position:"relative",width:"18.75rem",height:"6.25rem"}},I.createElement("div",null,I.createElement("a",{href:s,target:"_blank"},I.createElement("img",{src:o,style:{width:"18.75rem",height:"6.25rem"}}))),I.createElement("div",{className:"adButtons",style:{position:"absolute",left:"50%",marginLeft:"-8rem",bottom:"0.25rem"}},r))},e}(I.Component),yn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=this.props.data;return I.createElement("div",{className:"mainPageCount"},I.createElement("div",{className:"mainPageTitle1"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},"论坛统计"))),I.createElement("div",{className:"mainPageCountContent"},I.createElement("div",{className:"mainPageCountRow"},I.createElement("div",{className:"mainPageCountTitle"},"今日帖数"),I.createElement("div",{className:"mainPageCountTitle"},e.todayCount||0)),I.createElement("div",{className:"mainPageCountRow"},I.createElement("div",{className:"mainPageCountTitle"},"今日主题数"),I.createElement("div",{className:"mainPageCountTitle"},e.todayTopicCount||0)),I.createElement("div",{className:"mainPageCountRow"},I.createElement("div",{className:"mainPageCountTitle"},"论坛总主题数"),I.createElement("div",{className:"mainPageCountTitle"},e.topicCount||0)),I.createElement("div",{className:"mainPageCountRow"},I.createElement("div",{className:"mainPageCountTitle"},"论坛总回复数"),I.createElement("div",{className:"mainPageCountTitle"},e.postCount||0)),I.createElement("div",{className:"mainPageCountRow"},I.createElement("div",{className:"mainPageCountTitle"},"在线用户数"),I.createElement("div",{className:"mainPageCountTitle"},e.onlineUserCount||0)),I.createElement("div",{className:"mainPageCountRow"},I.createElement("div",{className:"mainPageCountTitle"},"总用户数"),I.createElement("div",{className:"mainPageCountTitle"},e.userCount||0)),I.createElement("div",{className:"mainPageCountRow"},I.createElement("div",{className:"mainPageCountTitle"},"欢迎新用户"),I.createElement("div",{className:"mainPageCountTitle"},I.createElement(It.a,{to:"/user/name/"+encodeURIComponent(e.lastUserName)},e.lastUserName)))))},t}(I.Component),En=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}x.c(t,e),t.prototype.render=function(){return I.createElement("div",null)}}(I.Component),function(e,t,n,a,r,s,o){this.todayCount=e,this.todayTopicCount=t,this.topicCount=n,this.postCount=a,this.onlineUserCount=r,this.userCount=s,this.lastUserName=o}),In=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{style:{display:"flex",flexDirection:"column",marginTop:"2rem"}},I.createElement("div",{className:"mainPageTitle2"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},"CC98小程序"))),I.createElement("div",{style:{marginTop:"1rem",marginBottom:"1rem"}},I.createElement("img",{style:{width:"100%"},src:"/static/images/QRCode.png"})),I.createElement("div",{className:"mainPageTitle2"},I.createElement("div",{className:"mainPageTitleRow"},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{className:"mainPageTitleText"},"98淘书小程序"))),I.createElement("div",{style:{marginTop:"1rem"}},I.createElement("img",{style:{width:"100%"},src:"/static/images/taoshu.jpg"})))},t}(I.Component),wn=function(n){function e(e){var t=n.call(this,e)||this;return t.state={data:{academics:[],announcement:"",emotion:[],fleaMarket:[],fullTimeJob:[],hotTopic:[],lastUserName:"",partTimeJob:[],postCount:0,recommendationFunction:[],recommendationReading:[],schoolEvent:[],schoolNews:[],study:[],todayCount:0,topicCount:0,userCount:0}},t}return x.c(e,n),e.prototype.getData=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return(t=Gn("mainPageData"))?[3,3]:[4,Zn("/config/index")];case 1:return[4,e.sent().json()];case 2:return t=e.sent(),(n=t.hotTopic)&&n.length&&(Jn("mainPageData",t,60),Jn("mainPageHotTopic",t)),[2,t];case 3:return[2,t]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,this.getData()];case 1:return t=e.sent(),this.setState({data:t}),[2]}})})},e.prototype.render=function(){var e=this.state.data,t=new Array({name:"学习",url:"/board/68"},{name:"外语",url:"/board/304"},{name:"考研",url:"/board/263"},{name:"出国",url:"/board/102"}),n=new Array({name:"缘分",url:"/board/152"},{name:"小屋",url:"/board/114"},{name:"感性",url:"/board/81"}),a=new Array({name:"数码",url:"/board/562"},{name:"生活",url:"/board/80"},{name:"服饰",url:"/board/563"}),r=new Array({name:"更多",url:"/board/235"}),s=new Array({name:"更多",url:"/board/459"}),o=new En(e.todayCount,e.todayTopicCount,e.topicCount,e.postCount,e.onlineUserCount,e.userCount,e.lastUserName);return I.createElement("div",{className:"mainPage"},I.createElement(Wt,{title:"CC98论坛"}),I.createElement("div",{className:"leftPart"},I.createElement(mn,{data:e.announcement}),I.createElement(pn,{data:e.recommendationReading}),I.createElement("div",{className:"row",style:{justifyContent:"space-between"}},I.createElement(dn,{data:e.hotTopic}),I.createElement(hn,{data:e.schoolEvent,name:"校园活动",fetchUrl:"/topic/school-event",style:"blue",mores:[]})),I.createElement("div",{className:"row",style:{justifyContent:"space-between"}},I.createElement(hn,{data:e.academics,name:"学术信息",fetchUrl:"/topic/academics",style:"black",mores:[]}),I.createElement(hn,{data:e.study,name:"学习园地",fetchUrl:"/topic/study",style:"black",mores:t})),I.createElement("div",{className:"row",style:{justifyContent:"space-between"}},I.createElement(hn,{data:e.emotion,name:"感性·情感",fetchUrl:"/topic/emotion",style:"blue",mores:n}),I.createElement(hn,{data:e.fleaMarket,name:"跳蚤市场",fetchUrl:"/topic/flea-market",style:"blue",mores:a})),I.createElement("div",{className:"row",style:{justifyContent:"space-between"}},I.createElement(hn,{data:e.fullTimeJob,name:"求职广场",fetchUrl:"/topic/full-time-job",style:"black",mores:r}),I.createElement(hn,{data:e.partTimeJob,name:"实习兼职",fetchUrl:"/topic/part-time-job",style:"black",mores:s}))),I.createElement("div",{className:"rightPart"},I.createElement(gn,{data:e.recommendationFunction}),I.createElement(vn,{data:e.schoolNews}),I.createElement(bn,null),I.createElement(yn,{data:o}),I.createElement(In,null)))},e}(I.Component),Cn=n(12),Nn=n.n(Cn),Tn=n(111),Sn=n(238),xn=n(18),kn=n(80),Pn=function(n){function e(e,t){return n.call(this,e,t)||this}return x.c(e,n),Object.defineProperty(e.prototype,"match",{get:function(){return this.props.match},enumerable:!0,configurable:!0}),e}(I.Component),Un=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.showModal=function(){return x.b(n,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,ur(this.match.params.boardId,0,5)];case 1:return t=e.sent(),this.setState({visible:!0,tpList:t}),[2]}})})},n.handleOk=function(e){n.setState({visible:!1})},n.handleCancel=function(e){n.setState({visible:!1})},n.cancelTp=function(a){return x.b(n,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,La(a.userId,this.match.params.boardId)];case 1:return"ok"!==(t=e.sent())?[3,3]:[4,ur(this.match.params.boardId,0,5)];case 2:return n=e.sent(),this.setState({tpList:n}),[3,4];case 3:alert("操作失败,原因："+t),e.label=4;case 4:return[2]}})})},n.state={boardId:null,boardInfo:{bigPaper:"",masters:[],name:""},page:1,fetchState:"ok",visible:!1,tpList:[],loading:!1,hasMore:!0,isMaster:!1},n}return x.c(e,a),e.prototype.componentDidMount=function(){var e=Ha(this.state.boardInfo.boardMasters);this.setState({isMaster:e})},e.prototype.componentWillReceiveProps=function(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,za(n.match.params.boardId)];case 1:return t=e.sent(),this.setState({boardInfo:t,boardId:this.match.params.boardId}),[2]}})})},e.prototype.componentWillMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,za(this.match.params.boardId)];case 1:return t=e.sent(),this.setState({boardInfo:t,boardId:this.match.params.boardId,fetchState:t}),[2]}})})},e.prototype.render=function(){var t=this;switch(this.state.fetchState){case"ok":return I.createElement("div",null);case"not found":return I.createElement(nn,null);case"unauthorized":return I.createElement(Xt,null);case"server error":return I.createElement(sn,null)}var e="/board/"+this.match.params.boardId+"/record/";return I.createElement("div",{id:"listRoot"},I.createElement(Wt,{title:this.state.boardInfo.name+" - CC98论坛"}),I.createElement(Mn,{boardId:this.match.params.boardId,boardInfo:this.state.boardInfo}),I.createElement(Rn,{key:this.state.page,boardId:this.match.params.boardId,boardInfo:this.state.boardInfo}),I.createElement(Dn,{boardInfo:this.state.boardInfo,adsUrl:null}),I.createElement($t.a,null,I.createElement(Yt.a,{exact:!0,path:"/board/:boardid/tags/:tag1Id/:tag2Id/:page?",component:Bn}),I.createElement(Yt.a,{exact:!0,path:"/board/:boardId/tag/tag1/:tagId/:page?",component:Fn}),I.createElement(Yt.a,{exact:!0,path:"/board/:boardId/tag/tag2/:tagId/:page?",component:Fn}),I.createElement(Yt.a,{exact:!0,path:"/board/:boardId/best/:page?",component:_n}),I.createElement(Yt.a,{exact:!0,path:"/board/:boardId/save/:page?",component:zn}),I.createElement(Yt.a,{exact:!0,path:"/board/:boardId/record/:page?",component:An}),I.createElement(Yt.a,{exact:!0,path:"/board/:boardId/:page?",component:Ln})),I.createElement("div",{style:{display:"flex",width:"100%",justifyContent:"flex-end"}},I.createElement(It.a,{to:e},I.createElement(xn.a,{type:"primary"},"查看版面事件")),I.createElement(xn.a,{style:{marginLeft:"2rem"},type:"primary",onClick:this.showModal},"小黑屋")),I.createElement(Tn.a,{title:"小黑屋",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,width:this.state.isMaster?"60rem":"45rem"},I.createElement(Sn.a,{dataSource:this.state.tpList,pagination:{onChange:function(r){return x.b(t,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return t=5*(r-1),[4,ur(this.match.params.boardId,t,5)];case 1:return n=e.sent(),a=this.state.tpList.concat(n),this.setState({tpList:a}),[2]}})})},pageSize:5},renderItem:function(e){return I.createElement(Sn.a.Item,{key:e.userId},I.createElement(Sn.a.Item.Meta,{title:I.createElement("a",{href:"https://cc98.org/user/"+e.userId},e.userName),description:I.createElement("div",null,I.createElement("span",null,"天数:",e.days),I.createElement("span",{style:{marginLeft:"2rem",marginRight:"2rem"}},"到期时间:",Cn(e.expiredTime).format("YYYY-MM-DD HH:mm:ss")),I.createElement(xn.a,{onClick:t.cancelTp.bind(t,e),type:"primary",style:{display:t.state.isMaster?"":"none"}},"解除tp"))}),I.createElement("div",null,"操作人:",e.operatorUserName))}},this.state.loading&&this.state.hasMore&&I.createElement("div",{className:"demo-loading-container"},I.createElement(kn.a,null)))))},e}(Pn),Mn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e="/board/"+this.props.boardId;return I.createElement("div",{className:"row",style:{alignItems:"baseline",width:"100% ",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem",marginLeft:"0.5rem"},to:"/boardlist"},"版面列表"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem"},to:e},this.props.boardInfo.name))},t}(I.Component),Rn=function(a){function e(e,t){var n=a.call(this,e,t)||this;n.changeBigPaper=function(){return x.b(n,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),t="/board/"+this.props.boardId+"/big-paper",[4,Kn()];case 1:return n=e.sent(),(a=new Headers).append("Authorization",n),a.append("Content-Type","application/json"),[4,Zn(t,{method:"PUT",headers:a,body:JSON.stringify({content:this.state.curDesc})})];case 2:if(200!==e.sent().status)throw new Error;return this.setState({info:"修改成功"}),[3,4];case 3:return r=e.sent(),this.setState({info:"修改失败 "+r.message}),[3,4];case 4:return[2]}})})},n.state={isFollow:Ra(n.props.boardId),isExtend:!1,isEditing:!1,curDesc:e.boardInfo.bigPaper,info:""};Ra(n.props.boardId);return n.follow=n.follow.bind(n),n.unfollow=n.unfollow.bind(n),n.generateMasters=n.generateMasters.bind(n),n}return x.c(e,a),e.prototype.follow=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return[4,Oa(this.props.boardId)];case 1:return e.sent(),this.setState({isFollow:!0}),[2]}})})},e.prototype.unfollow=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return[4,ja(this.props.boardId)];case 1:return e.sent(),this.setState({isFollow:!1}),[2]}})})},e.prototype.generateMasters=function(e){var t=e.toString(),n="/user/name/"+encodeURIComponent(e.toString());return I.createElement("div",{style:{marginRight:"10px",fontSize:"0.75rem"}},I.createElement("a",{style:{color:this.state.isExtend?"#fff":"#000"},href:n},t))},e.prototype.componentWillReceiveProps=function(e){this.setState({isFollow:Ra(e.boardInfo.isFollow)})},e.prototype.onError=function(e){e.preventDefault(),e.target.src="/static/images/_CC98.png"},e.prototype.render=function(){var t=this,e="/board/"+this.props.boardId,n=(this.props.boardId,"/static/images/_"+this.props.boardInfo.name+".png"),a=Ha(this.props.boardInfo.boardMasters),r=I.createElement("div",{className:"row",style:{width:"100%"}},this.props.boardInfo.name);return this.props.boardInfo&&8<this.props.boardInfo.name.length&&(r=I.createElement("div",{className:"row",style:{width:"100%",fontSize:"14px"}},this.props.boardInfo.name)),this.state.isExtend?I.createElement("div",{className:"row",style:{width:"100%",overflow:"hidden",maxHeight:"50rem",transition:"max-height 1.5s"}},I.createElement("div",{className:"boardMessage"},I.createElement("div",{className:"row",style:{height:"4rem",marginTop:"1.25rem"}},I.createElement("img",{style:{marginLeft:"1.25rem"},onError:this.onError,src:n}),I.createElement("div",{className:"boardMessageDetails"},I.createElement("div",{className:"row",style:{width:"100%"}},this.props.boardInfo.name),I.createElement("div",{className:"row",style:{width:"100%",alignItems:"center"}},I.createElement("div",{style:{fontSize:"0.75rem",width:"4.5rem"}},this.props.boardInfo.todayCount,"/",this.props.boardInfo.topicCount),I.createElement("div",{className:"boardFollow",onClick:this.state.isFollow?this.unfollow:this.follow},this.state.isFollow?"取关":"关注"," ")))),I.createElement("div",{className:"boardDescription"},I.createElement("div",null,this.props.boardInfo.description)),I.createElement("div",{className:"boardMasters"},I.createElement("div",null,"版主"),I.createElement("div",null,this.props.boardInfo.boardMasters.map(this.generateMasters)))),I.createElement("div",{className:"bigPaper",style:{display:"block"}},I.createElement("button",{className:"fa fa-angle-double-up",style:{float:"right",backgroundColor:"#fff",cursor:"pointer",border:"none"},type:"button",onClick:function(){return t.setState({isExtend:!1})}},"收起"),I.createElement("div",{className:"bigPaperTitle"},Ha(this.props.boardInfo.boardMasters)?I.createElement("button",{type:"button",onClick:function(){return t.setState({isEditing:!0})}},"编辑"):null,this.state.isEditing?I.createElement("button",{type:"button",onClick:function(){t.changeBigPaper()}},"提交"):null,I.createElement("p",null,this.state.info)),this.state.isEditing?I.createElement("div",null,I.createElement("textarea",{style:{width:"50rem",height:"15rem",resize:"none"},onChange:function(e){return t.setState({curDesc:e.target.value})}},this.state.curDesc)):I.createElement("div",{style:{maxWidth:"53.25rem"}},I.createElement(Ht,{code:this.props.boardInfo.bigPaper})))):I.createElement("div",{className:"row",style:{width:"100%",overflow:"hidden",maxHeight:"6rem",transition:"max-height 1s"}},I.createElement(It.a,{to:e},I.createElement("div",{className:"boardMessage"},I.createElement("div",{className:"row",style:{height:"4rem",marginTop:"1.25rem"}},I.createElement("img",{style:{marginLeft:"1.25rem"},onError:this.onError,src:n}),I.createElement("div",{className:"boardMessageDetails"},r,I.createElement("div",{className:"row",style:{width:"100%",alignItems:"center"}},I.createElement("div",{style:{fontSize:"0.75rem",width:"4.5rem"}},this.props.boardInfo.todayCount,"/",this.props.boardInfo.topicCount),I.createElement("div",{className:"boardFollow",onClick:this.state.isFollow?this.unfollow:this.follow},this.state.isFollow?"取关":"关注"," ")))))),I.createElement("div",{className:"bigPaper",style:{display:"block"}},this.props.boardInfo.bigPaper?I.createElement("button",{className:"fa fa-angle-double-down",style:{float:"right",backgroundColor:"#fff",cursor:"pointer",border:"none"},type:"button",onClick:function(){return t.setState({isExtend:!0})}},"展开"):a?I.createElement("button",{style:{float:"right"},type:"button",onClick:function(){return t.setState({isEditing:!0,isExtend:!0})}},"编辑"):null,I.createElement("div",null,I.createElement("div",null,"版面简介：",this.props.boardInfo.description)),I.createElement("div",null,I.createElement("div",{style:{display:"flex",marginTop:".5rem",fontSize:"0.75rem"}},"版主：",this.props.boardInfo.boardMasters.map(this.generateMasters)))))},e}(Pn),On=function(n){function e(e,t){return n.call(this,e,t)||this}return x.c(e,n),e.prototype.generateTagButton=function(e){var t="/board/"+this.props.boardid+"/tag/tag1/"+e.id;return I.createElement("div",null,I.createElement(It.a,{to:t},I.createElement("button",{className:"chooseTag"},e.name,I.createElement("span",{className:"tagNumber"}))))},e.prototype.generateTag2Button=function(e){var t="/board/"+this.props.boardid+"/tag/tag2/"+e.id;return I.createElement("div",null,I.createElement(It.a,{to:t},I.createElement("button",{className:"chooseTag"},e.name,I.createElement("span",{className:"tagNumber"}))))},e.prototype.render=function(){var e=null,t=null,n="/board/"+this.props.boardid;return this.props.tag&&1<=this.props.tag.length&&(e=I.createElement("div",{style:{maxWidth:"35rem",lineHeight:"3rem",display:"flex",flexDirection:"row",justifyContent:"flex-start",width:"100%",marginLeft:"0.3125rem",marginRight:"0.3125rem",borderTop:"dashed #EAEAEA thin",marginBottom:"0.5rem"}},I.createElement("div",{className:"row",style:{display:"flex",flexWrap:"wrap",maxWidth:"35rem"}},I.createElement("div",null,I.createElement("button",{className:"chooseTag"},I.createElement(It.a,{to:n},"全部"))),this.props.tag[0].tags.map(this.generateTagButton.bind(this))))),this.props.tag&&2===this.props.tag.length&&(t=I.createElement("div",{style:{maxWidth:"35rem",lineHeight:"3rem",display:"flex",flexDirection:"row",justifyContent:"flex-start",width:"100%",marginLeft:"0.3125rem",marginRight:"0.3125rem",borderTop:"dashed #EAEAEA thin",marginBottom:"0.5rem"}},I.createElement("div",{className:"row",style:{display:"flex",flexWrap:"wrap",maxWidth:"35rem"}},I.createElement("div",null,I.createElement("button",{className:"chooseTag"},I.createElement(It.a,{to:n},"全部"))),this.props.tag[1].tags.map(this.generateTag2Button.bind(this))))),I.createElement("div",{className:"row",style:{width:"100%",marginLeft:"0.3125rem",marginRight:"0.3125rem",marginTop:"0.9375rem",marginBottom:"1rem",justifyContent:"space-between",alignItems:"flex-end"}},I.createElement("div",null,e,t),I.createElement(Jt,{page:this.props.page,url:this.props.url,totalPage:this.props.totalPage}))},e}(I.Component),Dn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.clickListener=function(){var e=!1,t=!0,n=!1;Gn("userInfo")&&(e=!0),Gn("userInfo")&&!Gn("userInfo").isVerified&&(t=!1),Gn("userInfo")&&0!==Gn("userInfo").lockState&&(n=!0),e?t?n&&alert("您的账号被全站禁言！"):alert("您的帐号未认证，无法发言，请先前往https://account.cc98.org 认证激活。"):alert("请登陆！")},t.prototype.render=function(){var e=null,t=!1,n=!1,a=!0,r=null;Gn("userInfo")?(t=!0,Gn("userInfo").isVerified?n=!0:(n=!1,r=I.createElement("div",{style:{marginLeft:"1rem",color:"red"}},"您的帐号未认证，无法发言，请先前往"," ",I.createElement("a",{href:"https://account.cc98.org"},"https://account.cc98.org")," ","认证激活。")),0!==Gn("userInfo").lockState?(a=!0,r=I.createElement("div",{style:{marginLeft:"1rem",color:"red"}},"您被全站禁言。")):a=!1):r=I.createElement("div",{style:{marginLeft:"1rem",color:"red"}},"您还未登录，不能发帖，请先登录");var s="/editor/postTopic/"+this.props.boardInfo.id;return e=this.props.boardInfo.canVote?I.createElement("div",null,I.createElement(It.a,{className:"button bgcolor",to:s},"发主题"),I.createElement(It.a,{style:{marginLeft:"2rem"},className:"button bgcolor",to:"/editor/postVoteTopic/"+this.props.boardInfo.id},"发投票")):I.createElement(It.a,{className:"button bgcolor",to:s},"发主题"),!a&&t&&n||(e=I.createElement("div",{style:{display:"flex",alignItems:"center"}},r)),I.createElement("div",{className:"row",style:{width:"100%",height:"6.25rem",alignItems:"flex-end",justifyContent:"space-between",marginTop:"1rem"}},e,I.createElement("div",{style:{height:"6.25rem"}}," ",I.createElement(bn,null)))},t}(I.Component),jn=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.state={data:[]},n}return x.c(e,a),e.prototype.convertTopicToElement=function(e){return I.createElement(Vn,x.a({key:e.id},e))},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,function(i){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/topic/toptopics?boardid="+i,{headers:t})];case 2:return[4,e.sent().json()];case 3:for(n=e.sent(),a=[],r=0;r<n.length;r++)a[r]=x.a({},n[r],{replyCount:n[r].replyCount||0});for(r=0;r<a.length-1;r++)for(s=0;s<a.length-1-r;s++)a[s].topState<=a[s+1].topState&&(o=a[s],a[s]=a[s+1],a[s+1]=o);return[2,a]}})})}(this.props.boardId)];case 1:return t=e.sent(),this.setState({data:t}),[2]}})})},e.prototype.render=function(){return I.createElement("div",null,this.state.data.map(this.convertTopicToElement))},e}(I.Component),Ln=(function(n){function e(e){var t=n.call(this,e)||this;return t.state={data:[]},t}x.c(e,n),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,ka(this.props.boardId,this.props.curPage)];case 1:return t=e.sent(),this.setState({data:t}),[2]}})})},e.prototype.convertTopicToElement=function(e){return I.createElement(Vn,x.a({key:e.id},e))},e.prototype.render=function(){return I.createElement("div",null,this.state.data.map(this.convertTopicToElement))}}(I.Component),function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.tpList=function(){},n.state={items:[],totalPage:0,boardInfo:{masters:[],topicCount:1},fetchState:"ok",tags:[]},n}return x.c(e,a),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return(t=this.match.params.page)||(t=1),[4,za(this.match.params.boardId)];case 1:return n=e.sent(),[4,ra(t,this.match.params.boardId,n.topicCount)];case 2:return a=e.sent(),r=this.getTotalListPage(n.topicCount),[4,Wa(this.match.params.boardId)];case 3:return s=e.sent(),this.setState({items:a,totalPage:r,boardInfo:n,fetchState:a,tags:s}),[2]}})})},e.prototype.convertTopicToElement=function(e){return I.createElement(Vn,x.a({key:e.id},e))},e.prototype.componentWillReceiveProps=function(o){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return n=o.match.params.page,t=n?parseInt(n):1,[4,za(this.match.params.boardId)];case 1:return a=e.sent(),r=this.getTotalListPage(a.topicCount),[4,ra(t,o.match.params.boardId,a.topicCount)];case 2:return s=e.sent(),this.setState({items:s,totalPage:r}),[2]}})})},e.prototype.getTotalListPage=function(e){return Ia(e)},e.prototype.getCheckValue=function(){var n=[];return Ee(".opTitleCheckboxValue").each(function(){var e,t;Ee(this).is(":checked")&&n.push("id="+(e=Ee(this).attr("id"),t=e.lastIndexOf("_"),e=e.substring(t+1,e.length)))}),n.join("&")},e.prototype.lockUI=function(){Ee("#deleteUI").css("display","none"),Ee("#lockUI").css("display",""),Ee(".opTitleCheckbox").css("display","flex")},e.prototype.deleteUI=function(){Ee("#lockUI").css("display","none"),Ee("#deleteUI").css("display",""),Ee(".opTitleCheckbox").css("display","flex")},e.prototype.manageUI=function(){Ee("#manageUI").css("display","")},e.prototype.lock=function(){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return t=Ee("#opDays").val(),"自定义"==(n=Ee("#opReason").val())&&(n=Ee("#hideReason").val()),a=this.getCheckValue(),[4,function(s,o,i){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return t="/topic/multi-lock?"+i,[4,Xn()];case 1:return(n=e.sent()).append("Content-Type","application/json"),a=JSON.stringify({reason:o,value:s}),Ee("#mutlilock-btn").attr("disabled","disabled"),[4,Zn(t,{method:"PUT",headers:n,body:a})];case 2:return 200==(r=e.sent()).status?(Ee("#mutlilock-btn").removeAttr("disabled"),Ee("#mutlioptip").text("操作成功")):(Ee("#mutlilock-btn").removeAttr("disabled"),Ee("#mutlioptip").text("操作失败")),[2,r.status]}})})}(t,n,a)];case 1:return 200==e.sent()&&(document.location.href="/board/"+this.match.params.boardId),[2]}})})},e.prototype.delete=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return"自定义"==(t=Ee("#opReason").val())&&(t=Ee("#hideReason1").val()),n=this.getCheckValue(),[4,function(s,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return t="/topic/multi-delete?"+o,[4,Xn()];case 1:return(n=e.sent()).append("Content-Type","application/json"),a=JSON.stringify({reason:s}),Ee("#mutlidelete-btn").attr("disabled","disabled"),[4,Zn(t,{method:"PUT",headers:n,body:a})];case 2:return 200==(r=e.sent()).status?(Ee("#mutlidelete-btn").removeAttr("disabled"),Ee("#mutliopdtip").text("操作成功")):(Ee("#mutlidelete-btn").removeAttr("disabled"),Ee("#mutliopdtip").text("操作失败")),[2,r.status]}})})}(t,n)];case 1:return 200==e.sent()&&(document.location.href="/board/"+this.match.params.boardId),[2]}})})},e.prototype.changeReason=function(){"自定义"==Ee("#opReason").val()?Ee("#hideReason").css("display",""):Ee("#hideReason").css("display","none")},e.prototype.changeDeleteReason=function(){"自定义"==Ee("#opReason").val()?Ee("#hideReason1").css("display",""):Ee("#hideReason1").css("display","none")},e.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1,t=null;1!==parseInt(this.match.params.page)&&this.match.params.page||(t=I.createElement("div",null,I.createElement(jn,{boardId:this.match.params.boardId})));var n=(this.state.items||[]).map(this.convertTopicToElement),a="/board/"+this.match.params.boardId+"/best/",r="/board/"+this.match.params.boardId+"/save/",s="/board/"+this.match.params.boardId+"/",o=I.createElement("div",null,I.createElement(ye.a,null,"处理理由"),I.createElement("select",{id:"opReason",onChange:this.changeReason.bind(this),className:"react-bootstrap-select"},I.createElement("option",{className:"react-bootstrap-option",value:"重复发帖"},"重复发帖"),I.createElement("option",{className:"react-bootstrap-option",value:"管理要求"},"管理要求"),I.createElement("option",{className:"react-bootstrap-option",value:"已解决"},"已解决"),I.createElement("option",{className:"react-bootstrap-option",value:"内容不符"},"内容不符"),I.createElement("option",{className:"react-bootstrap-option",value:"违反版规"},"违反版规"),I.createElement("option",{className:"react-bootstrap-option",value:"自定义"},"自定义")),I.createElement("input",{id:"hideReason",className:"react-bootstrap-text",style:{display:"none"}})),i=I.createElement("div",null,I.createElement(ye.a,null,"处理理由"),I.createElement("select",{id:"opReason",onChange:this.changeDeleteReason.bind(this),className:"react-bootstrap-select"},I.createElement("option",{className:"react-bootstrap-option",value:"重复发帖"},"重复发帖"),I.createElement("option",{className:"react-bootstrap-option",value:"管理要求"},"管理要求"),I.createElement("option",{className:"react-bootstrap-option",value:"已解决"},"已解决"),I.createElement("option",{className:"react-bootstrap-option",value:"内容不符"},"内容不符"),I.createElement("option",{className:"react-bootstrap-option",value:"违反版规"},"违反版规"),I.createElement("option",{className:"react-bootstrap-option",value:"自定义"},"自定义")),I.createElement("input",{id:"hideReason1",className:"react-bootstrap-text",style:{display:"none"}})),c=I.createElement("div",null," ",I.createElement(ye.a,null,"下沉天数"),I.createElement("select",{id:"opDays",className:"react-bootstrap-select"},I.createElement("option",{value:"7"},"7"),I.createElement("option",{value:"30"},"30"),I.createElement("option",{value:"98"},"98"),I.createElement("option",{value:"1000"},"1000"))),l=I.createElement("div",{id:"lockUI",style:{display:"none"}},o,c,I.createElement("button",{type:"button",id:"mutlilock-btn",onClick:this.lock.bind(this),className:"react-bootstrap-button"},"确认"),I.createElement("div",{id:"mutlioptip"})),u=I.createElement("div",{id:"deleteUI",style:{display:"none"}},i,I.createElement("button",{type:"button",id:"mutlidelete-btn",onClick:this.delete.bind(this),className:"react-bootstrap-button"},"确认"),I.createElement("div",{id:"mutliopdtip"})),m=I.createElement("div",{id:"manageUI",style:{display:"none"}},I.createElement("div",{onClick:this.lockUI.bind(this),className:"react-bootstrap-button"},"批量锁沉"),I.createElement("div",{onClick:this.deleteUI.bind(this),className:"react-bootstrap-button"},"批量删除"),l,u),p=null;return Ha(this.state.boardInfo.boardMasters)&&(p=I.createElement(xn.a,{type:"primary",onClick:this.manageUI.bind(this)},"批量管理")),I.createElement("div",{className:"listContent "},I.createElement(On,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:s,tag:this.state.tags}),I.createElement("div",{className:"column tagColumn"},I.createElement("div",{className:"row board-topBar"},I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:s},"全部")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:a},"精华")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:r},"保存"))),I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{style:{marginRight:"14rem"}},I.createElement("span",null,"作者")),I.createElement("div",{style:{marginRight:"8rem"}},I.createElement("span",null,"最后回复")))),t,I.createElement("div",null,n)),I.createElement("div",{className:"row",style:{marginTop:"0.5rem"}},I.createElement("div",{className:"listContentBottom",style:{flexGrow:1}},I.createElement(Jt,{page:e,totalPage:this.state.totalPage,url:s})),p),m)},e}(Pn)),Fn=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.state={items:[],totalPage:0,boardInfo:{masters:[],topicCount:1},fetchState:"ok",tags:[],layer:1},n}return x.c(e,a),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return(t=this.match.params.page)||(t=1),[4,za(this.match.params.boardId)];case 1:return n=e.sent(),[4,Wa(this.match.params.boardId)];case 2:return a=e.sent(),r=Za(this.match.params.tagId,a),[4,Qa(this.match.params.tagId,this.match.params.boardId,r,t)];case 3:return s=e.sent(),o=this.getTotalListPage(s.count),this.setState({items:s.topics,totalPage:o,boardInfo:n,fetchState:s,tags:a,layer:r}),[2]}})})},e.prototype.convertTopicToElement=function(e){return I.createElement(Vn,x.a({key:e.id},e))},e.prototype.componentWillReceiveProps=function(c){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:return n=c.match.params.page,t=n?parseInt(n):1,[4,za(c.match.params.boardId)];case 1:return a=e.sent(),[4,Wa(c.match.params.boardId)];case 2:return r=e.sent(),s=Za(c.match.params.tagId,r),[4,Qa(c.match.params.tagId,c.match.params.boardId,s,t)];case 3:return o=e.sent(),i=this.getTotalListPage(o.count),this.setState({items:o.topics,totalPage:i,boardInfo:a,fetchState:o,tags:r,layer:s}),[2]}})})},e.prototype.getTotalListPage=function(e){return Ia(e)},e.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1;1!==parseInt(this.match.params.page)&&this.match.params.page||I.createElement("div",null,I.createElement(jn,{boardId:this.match.params.boardId}));var t=(this.state.items||[]).map(this.convertTopicToElement),n="/board/"+this.match.params.boardId+"/tag/tag"+this.state.layer+"/"+this.match.params.tagId+"/",a="/board/"+this.match.params.boardId+"/",r="/board/"+this.match.params.boardId+"/best/",s="/board/"+this.match.params.boardId+"/save/";this.match.params.boardId;return I.createElement("div",{className:"listContent "},I.createElement(On,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:n,tag:this.state.tags}),I.createElement("div",{className:"column tagColumn"},I.createElement("div",{className:"row board-topBar"},I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:a}," 全部")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:r},"精华")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:s},"保存"))),I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{style:{marginRight:"14rem"}},I.createElement("span",null,"作者")),I.createElement("div",{style:{marginRight:"8rem"}},I.createElement("span",null,"最后回复")))),I.createElement("div",null,t)),I.createElement("div",{className:"listContentBottom"},I.createElement(Jt,{page:e,totalPage:this.state.totalPage,url:n})))},e}(Pn),Bn=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.state={items:[],totalPage:0,boardInfo:{masters:[],topicCount:1},fetchState:"ok",tags:[]},n}return x.c(e,a),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return(t=this.match.params.page)||(t=1),[4,za(this.match.params.boardId)];case 1:return n=e.sent(),[4,Ka(this.match.params.tag1Id,this.match.params.tag2Id,this.match.params.boardId,t)];case 2:return a=e.sent(),[4,Wa(this.match.params.boardId)];case 3:return r=e.sent(),s=this.getTotalListPage(a.count),this.setState({items:a.topics,totalPage:s,boardInfo:n,fetchState:a,tags:r}),[2]}})})},e.prototype.convertTopicToElement=function(e){return I.createElement(Vn,x.a({key:e.id},e))},e.prototype.componentWillReceiveProps=function(i){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return n=i.match.params.page,t=n?parseInt(n):1,[4,za(i.match.params.boardId)];case 1:return a=e.sent(),[4,Wa(i.match.params.boardId)];case 2:return r=e.sent(),[4,Ka(i.match.params.tag1Id,i.match.params.tag2Id,i.match.params.boardId,t)];case 3:return s=e.sent(),o=this.getTotalListPage(s.count),this.setState({items:s.topics,totalPage:o,boardInfo:a,fetchState:s,tags:r}),[2]}})})},e.prototype.getTotalListPage=function(e){return Ia(e)},e.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1;1!==parseInt(this.match.params.page)&&this.match.params.page||I.createElement("div",null,I.createElement(jn,{boardId:this.match.params.boardId}));var t=(this.state.items||[]).map(this.convertTopicToElement),n="/board/"+this.match.params.boardId+"/tags/tag1/"+this.match.params.tag1Id+"/tag2/"+this.match.params.tag2Id+"/",a="/board/"+this.match.params.boardId+"/",r="/board/"+this.match.params.boardId+"/best/",s="/board/"+this.match.params.boardId+"/save/";this.match.params.boardId;return I.createElement("div",{className:"listContent "},I.createElement(On,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:n,tag:this.state.tags}),I.createElement("div",{className:"column tagColumn"},I.createElement("div",{className:"row board-topBar"},I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:a}," 全部")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:r},"精华")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:s},"保存"))),I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{style:{marginRight:"14rem"}},I.createElement("span",null,"作者")),I.createElement("div",{style:{marginRight:"8rem"}},I.createElement("span",null,"最后回复")))),I.createElement("div",null,t)),I.createElement("div",{className:"listContentBottom"},I.createElement(Jt,{page:e,totalPage:this.state.totalPage,url:n})))},e}(Pn),An=function(n){function e(e){var t=n.call(this,e)||this;return t.state={boardId:135,totalPage:1,curPage:1,tags:null,data:[]},t}return x.c(e,n),e.prototype.componentWillReceiveProps=function(i){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return(t=i.match.params.page)||(t=1),[4,cr(n=this.match.params.boardId,20*(t-1),20)];case 1:return a=e.sent(),r=parseInt(((a.count-.5)/20+1).toString()),s=a.boardEvents,[4,Wa(this.match.params.boardId)];case 2:return o=e.sent(),this.setState({boardId:n,totalPage:r,curPage:t,tags:o,data:s}),[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return t=this.match.params.boardId,(n=this.match.params.page)||(n=1),[4,cr(t,20*(n-1),20)];case 1:return a=e.sent(),r=parseInt(((a.count-.5)/20+1).toString()),s=a.boardEvents,[4,Wa(this.match.params.boardId)];case 2:return o=e.sent(),this.setState({boardId:t,totalPage:r,curPage:n,tags:o,data:s}),[2]}})})},e.prototype.convertRecordToElement=function(e){return I.createElement(Hn,{id:e.id,topicId:e.topicId,boardId:e.boardId,targetUserName:e.targetUserName,operatorUserName:e.operatorUserName,content:e.content,time:e.time,ip:e.ip,isDeleted:e.isDeleted})},e.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1,t=this.state.data.map(this.convertRecordToElement),n="/board/"+this.match.params.boardId+"/record/";return I.createElement("div",{className:"listContent "},I.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},I.createElement(Jt,{page:e,totalPage:this.state.totalPage,url:n})),I.createElement("div",{className:"column tagColumn"},I.createElement("div",{className:"row board-topBar"},I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{className:"listContentTag",style:{alignItems:"center",width:"5rem",textAlign:"center"}},I.createElement("span",null,"对象")),I.createElement("div",{className:"listContentTag",style:{alignItems:"center",width:"46rem",textAlign:"center"}},I.createElement("span",null,"内容")),I.createElement("div",{className:"listContentTag",style:{alignItems:"center",width:"6rem",textAlign:"center"}},I.createElement("span",null,"时间")),I.createElement("div",{className:"listContentTag",style:{alignItems:"center",width:"11rem",textAlign:"center"}},I.createElement("span",null,"操作人")))),I.createElement("div",null,t)),I.createElement(Jt,{page:e,totalPage:this.state.totalPage,url:n}))},e}(Pn),_n=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.state={items:[],totalPage:0,tags:[]},n}return x.c(e,a),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return(t=this.match.params.page)||(t=1),[4,ka(t,this.match.params.boardId)];case 1:return n=e.sent(),[4,Wa(this.match.params.boardId)];case 2:return a=e.sent(),r=n.totalPage,this.setState({items:n.boardtopics,totalPage:r,tags:a}),[2]}})})},e.prototype.convertTopicToElement=function(e){return I.createElement(Vn,x.a({key:e.id},e))},e.prototype.componentWillReceiveProps=function(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return t=r.match.params.page,[4,ka(t?parseInt(t):1,r.match.params.boardId)];case 1:return n=e.sent(),a=n.totalPage,this.setState({items:n.boardtopics,totalPage:a}),[2]}})})},e.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1,t=null;1!==parseInt(this.match.params.page)&&this.match.params.page||(t=I.createElement("div",null,I.createElement(jn,{boardId:this.match.params.boardId})));var n=(this.state.items||[]).map(this.convertTopicToElement),a="/board/"+this.match.params.boardId+"/best/",r="/board/"+this.match.params.boardId+"/save/",s="/board/"+this.match.params.boardId+"/",o="/board/"+this.match.params.boardId+"/record/";return I.createElement("div",{className:"listContent "},I.createElement(On,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:a,tag:this.state.tags}),I.createElement("div",{className:"column tagColumn"},I.createElement("div",{className:"row board-topBar"},I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:s},"全部")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:a},"精华")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:r},"保存"))),I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{style:{marginRight:"14rem"}},I.createElement("span",null,"作者")),I.createElement("div",{style:{marginRight:"8rem"}},I.createElement("span",null,"最后回复")))),t,I.createElement("div",null,n)),I.createElement("div",{className:"listContentBottom"},I.createElement(Jt,{page:e,totalPage:this.state.totalPage,url:a}),I.createElement(It.a,{to:o},I.createElement("div",{className:"boardRecordBtn"},"查看版面事件"))))},e}(Pn),zn=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.state={items:[],totalPage:0,tags:[]},n}return x.c(e,a),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return(t=this.match.params.page)||(t=1),[4,Pa(t,this.match.params.boardId)];case 1:return n=e.sent(),a=n.totalPage,[4,Wa(this.match.params.boardId)];case 2:return r=e.sent(),this.setState({items:n.boardtopics,totalPage:a,tags:r}),[2]}})})},e.prototype.convertTopicToElement=function(e){return I.createElement(Vn,x.a({key:e.id},e))},e.prototype.componentWillReceiveProps=function(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t=a.match.params.page,[4,Pa(t?parseInt(t):1,a.match.params.boardId)];case 1:return n=e.sent(),this.setState({items:n.boardtopics}),[2]}})})},e.prototype.render=function(){var e=this.match.params.page?parseInt(this.match.params.page):1,t=null;1!==parseInt(this.match.params.page)&&this.match.params.page||(t=I.createElement("div",null,I.createElement(jn,{boardId:this.match.params.boardId})));var n=(this.state.items||[]).map(this.convertTopicToElement),a="/board/"+this.match.params.boardId+"/best/",r="/board/"+this.match.params.boardId+"/save/",s="/board/"+this.match.params.boardId+"/",o="/board/"+this.match.params.boardId+"/record/";return I.createElement("div",{className:"listContent "},I.createElement(On,{page:e,totalPage:this.state.totalPage,boardid:this.match.params.boardId,url:r,tag:this.state.tags}),I.createElement("div",{className:"column tagColumn"},I.createElement("div",{className:"row board-topBar"},I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:s},"全部")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:a},"精华")),I.createElement("div",{className:"listContentTag"},I.createElement(It.a,{to:r},"保存"))),I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{style:{marginRight:"14rem"}},I.createElement("span",null,"作者")),I.createElement("div",{style:{marginRight:"8rem"}},I.createElement("span",null,"最后回复")))),t,I.createElement("div",null,n)),I.createElement("div",{className:"listContentBottom"},I.createElement(Jt,{page:e,totalPage:this.state.totalPage,url:r}),I.createElement(It.a,{to:o},I.createElement("div",{className:"boardRecordBtn"},"查看版面事件"))))},e}(Pn),Vn=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.state={pager:[],tag1:"",tag2:""},n}return x.c(e,a),e.prototype.componentWillMount=function(){if("number"==typeof this.props.replyCount){var e=this.props.replyCount+1,t=e%10==0?e/10:(e-e%10)/10+1,n=[];if(1===t);else if(t<=7)for(var a=1;a<=t;a++)n.push(a);else n.push(1,2,3,4,-1,t-2,t-1,t);this.props.id;this.setState({pager:n})}},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return"number"==typeof this.props.replyCount&&(t="#title"+this.props.id,null!=this.props.highlightInfo&&(1==this.props.highlightInfo.isBold&&Ee(t).css("font-weight","bold"),1==this.props.highlightInfo.isItalic&&Ee(t).css("font-style","italic"),null!=this.props.highlightInfo.color&&Ee(t).css("color",this.props.highlightInfo.color))),[4,Ga(this.props.tag1)];case 1:return n=e.sent(),[4,Ga(this.props.tag2)];case 2:return a=e.sent(),r={tag1:n||"",tag2:a||""},this.setState(r),[2]}})})},e.prototype.generateListPager=function(e){var t="/topic/"+this.props.id+"/"+e;return-1!=e?I.createElement("div",{style:{marginRight:"0.3rem"}},I.createElement(It.a,{style:{color:"#79b8ca"},to:t},e)):I.createElement("div",{style:{marginRight:"0.3rem"}},"...")},e.prototype.render=function(){if("number"!=typeof this.props.replyCount)return this.props,null;var e=void 0;e=0===this.props.topState?"changeColor":"changeTopColor";var t="topic"+this.props.id,n="/topic/"+this.props.id,a="title"+this.props.id,r=void 0,s=void 0;s=Gn("userInfo")?Gn("userInfo").name:"",0===this.props.topState&&(r=I.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},I.createElement("i",{style:{color:"#B0B0B0"},className:"fa fa-envelope fa-lg"}))),s===this.props.userName&&(r=I.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},I.createElement("i",{style:{color:"#FFC90E"},className:"fa fa-envelope fa-lg"}))),100<this.props.replyCount&&0===this.props.topState&&(r=I.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},I.createElement("i",{style:{color:"red"},className:"fa fa-envelope-open fa-lg"}))),1===this.props.state&&(r=I.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},I.createElement("i",{style:{color:"#B0B0B0"},className:"fa fa-lock fa-lg"})));var o=this.props.hitCount;1e5<this.props.hitCount?o=((this.props.hitCount-this.props.hitCount%1e4)/1e4).toString()+"万":1e4<this.props.hitCount&&(o=(this.props.hitCount/1e4).toFixed(1).toString()+"万"),1===this.props.bestState&&(r=I.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},I.createElement("i",{style:{color:"#FF1493"},className:"fa fa-star fa-lg"}))),2===this.props.topState?r=I.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},I.createElement("i",{style:{color:"orange"},className:"fa fa-chevron-circle-up fa-lg"})):4===this.props.topState&&(r=I.createElement("div",{style:{width:"1rem",justifyContent:"flex-start"}},I.createElement("i",{style:{color:"red"},className:"fa fa-arrow-circle-up fa-lg"})));var i="#000",c="normal",l="normal";this.props.highlightInfo&&(this.props.highlightInfo.isBold&&(c="bold"),this.props.highlightInfo.isItalic&&(l="italic"),this.props.highlightInfo.color&&(i=this.props.highlightInfo.color));var u=null;if(0===this.props.topState){var m="topic_"+this.props.id;u=I.createElement("div",{className:"opTitleCheckbox",style:{alignContent:"center",display:"none"}},I.createElement("input",{id:m,className:"opTitleCheckboxValue",type:"checkbox"}))}var p="";return this.state.tag2&&!this.props.topState&&(p="["+this.state.tag2+"]"+p),this.state.tag1&&!this.props.topState&&(p="["+this.state.tag1+"]"+p),this.props.isVote&&(p="[投票]"+p),I.createElement("div",{style:{display:"flex"},id:e},u,I.createElement(It.a,{to:n},I.createElement("div",{className:"rofw topicInList",id:t},I.createElement("div",{className:"listTitleAndPager"},I.createElement("div",{className:"row listTitleAndIcon"},r,I.createElement("div",{className:"listTitle",id:a,style:{marginLeft:"1rem",color:i,fontWeight:c,fontStyle:l}},I.createElement("span",{className:"listTitleTag",style:{}},p),this.props.title)),I.createElement("div",{style:{display:"flex",fontSize:"0.75rem",marginLeft:"1rem",width:"auto"}},this.state.pager.map(this.generateListPager.bind(this)))),I.createElement("div",{className:"row",style:{width:"28rem",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",fontSize:"0.75rem",marginBottom:"-4px"}},I.createElement("div",{style:{width:"7.5rem",textAlign:"left"}}," ",I.createElement("span",null,this.props.userName||"匿名")),I.createElement("div",{className:"row topicIcon"},I.createElement("div",{id:"disliked",style:{display:"flex",width:"4.5rem"}},I.createElement("i",{className:"fa fa-eye fa-lg"}),I.createElement("span",{className:"timeProp tagSize"},o)),I.createElement("div",{id:"commentsAmount",style:{display:"flex",width:"3.5rem"}},I.createElement("i",{className:"fa fa-commenting-o fa-lg"}),I.createElement("span",{className:"timeProp tagSize"},this.props.replyCount))),I.createElement("div",{className:"lastReply"},I.createElement("span",null,this.props.lastPostUser,"/",Cn(this.props.lastPostTime).format("YY-MM-DD HH:mm")))))))},e}(I.Component),Hn=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.ipOver=n.ipOver.bind(n),n.ipOut=n.ipOut.bind(n),n}return x.c(e,a),e.prototype.ipOver=function(){"*"!==this.props.ip&&(this.props.ip,Ee("#ip_"+this.props.id).removeClass("displaynone"))},e.prototype.ipOut=function(){Ee("#ip_"+this.props.id).addClass("displaynone")},e.prototype.render=function(){var e;return e=this.props.targetUserName?I.createElement("a",{href:"/user/name/"+this.props.targetUserName,target:"_blank"},this.props.targetUserName):this.props.targetUserName||182==this.props.boardId?"匿名用户":"不适用",I.createElement("div",{className:"boardRecord",id:"changeColor"},I.createElement("div",{className:"boardRecord-1"},e),I.createElement("div",{className:"boardRecord-2"},I.createElement("a",{href:"/topic/"+this.props.topicId,target:"_blank"},this.props.content)),I.createElement("div",{className:"boardRecord-3"},Cn(this.props.time).format("YY-MM-DD HH:mm")),I.createElement("div",{className:"boardRecord-4",onMouseOver:this.ipOver,onMouseOut:this.ipOut},I.createElement("a",{href:"/user/name/"+this.props.operatorUserName,target:"_blank"},this.props.operatorUserName)),I.createElement("div",{className:"boardRecord-ip displaynone",id:"ip_"+this.props.id},this.props.ip))},e}(I.Component);function Wn(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){return t=zt.db.transaction("userInfo","readwrite"),n=t.objectStore("userInfo"),a=n.put({userInfo:r,addTime:Date.now()}),[2,new Promise(function(t,n){a.onsuccess=function(e){return t()},a.onerror=function(e){return n()}})]})})}function $n(e,t){var n=t;n="object"==typeof n?"obj-"+(n=JSON.stringify(n)):"str-"+n,sessionStorage.setItem(e,n)}function Yn(e){var t=sessionStorage.getItem(e);if(t)return 0===t.indexOf("obj-")?(t=t.slice(4),JSON.parse(t)):0===t.indexOf("str-")?t.slice(4):void 0}function qn(e){"all"!=e?sessionStorage.removeItem(e):sessionStorage.clear()}function Jn(t,n,a){void 0===a&&(a=0);try{var e=n;if(e="object"==typeof e?"obj-"+(e=JSON.stringify(e)):"str-"+e,localStorage.setItem(t,e),0!==a){var r=(new Date).getTime()+1e3*a;localStorage.setItem(t+"_expirationTime",r.toString().slice(0,r.toString().length-3))}else localStorage.removeItem(t+"_expirationTime")}catch(e){!function(){var e=Gn("refresh_token"),t=localStorage.getItem("refresh_token_expirationTime"),n=Gn("temporaryContent"),a=Gn("noticeSetting"),r=localStorage.getItem("userInfo"),s=localStorage.getItem("version");localStorage.clear(),console.info("localStorage cleared"),localStorage.setItem("version",s),e&&(Jn("refresh_token",e),localStorage.setItem("refresh_token_expirationTime",t),localStorage.setItem("userInfo",r));n&&Jn("temporaryContent",n);a&&Jn("noticeSetting",a)}(),Jn(t,n,a)}}function Gn(e){var t=localStorage.getItem(e),n=localStorage.getItem(e+"_expirationTime");if(n){var a=(new Date).getTime();if(1e3*Number.parseInt(n)<a)return void localStorage.removeItem(e)}if(t){if(0!==t.indexOf("obj-"))return 0===t.indexOf("str-")?t.slice(4):void 0;t=t.slice(4);var r=JSON.parse(t);return"userInfo"!==e||1!==r.lockState&&2!==r.lockState||(localStorage.clear(),window.location.href="https://www.cc98.org/logon"),r}}function Qn(e){"all"!=e?localStorage.removeItem(e):localStorage.clear()}function Kn(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return(t=Gn("refresh_token"))?(n=Gn("accessToken"))?[2,n]:("https://openid.cc98.org/connect/token",a={client_id:"9a1fd200-8687-44b1-4c20-08d50a96e5cd",client_secret:"8b53f727-08e2-4509-8857-e34bf92b27f2",grant_type:"refresh_token",refresh_token:t},(r=new Headers).append("Content-Type","application/x-www-form-urlencoded"),[4,fetch("https://openid.cc98.org/connect/token",{method:"POST",headers:r,body:Object.keys(a).map(function(e){return e+"="+a[e]}).join("&")})]):[2,null];case 1:return[4,e.sent().json()];case 2:return(s=e.sent()).access_token?(Jn("accessToken",n="Bearer "+encodeURIComponent(s.access_token),s.expires_in),[2,n]):(Qn("userInfo"),Qn("accessToken"),Qn("refresh_token"),Cr.dispatch(J()),Ir.push("/logon"),[2])}})})}function Xn(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Kn()];case 1:return t=e.sent(),(n=new Headers).append("Authorization",t),[2,n]}})})}function Zn(r,s){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return t=At.config.apiUrl,n=""+t+r,s?[4,fetch(n,s)]:[3,2];case 1:return a=e.sent(),[3,4];case 2:return[4,fetch(n)];case 3:a=e.sent(),e.label=4;case 4:return[2,a]}})})}(_t=At||(At={})).loadConfig=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,fetch("/static/config.json")];case 1:if(!(t=e.sent()).ok)throw new Error("系统无法读取配置文件，网站无法正常运行");return[4,t.json()];case 2:_t.config=e.sent(),e.label=3;case 3:return e.trys.push([3,6,,7]),[4,fetch("/static/config.production.json")];case 4:return[4,e.sent().json()];case 5:return n=e.sent(),_t.config=x.a({},_t.config,n),[3,7];case 6:return e.sent(),[3,7];case 7:return[2]}})})},(Vt=zt||(zt={})).start=function(){return x.b(this,void 0,void 0,function(){var a;return x.d(this,function(e){return(a=indexedDB.open("cc98",1)).onupgradeneeded=function(e){a.result.objectStoreNames.contains("userInfo")||a.result.createObjectStore("userInfo",{keyPath:"userInfo.id"}).createIndex("name","userInfo.name",{unique:!0})},Vt.db?[2]:[2,new Promise(function(t,n){a.onsuccess=function(e){Vt.db=a.result,t()},a.onerror=function(e){return n(e)}})]})})};var ea=!!window.indexedDB&&-1===navigator.userAgent.indexOf("MSIE");function ta(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,7,,8]),ea?[4,function(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){if(t=zt.db.transaction("userInfo","readonly"),n=t.objectStore("userInfo"),"number"==typeof r)a=n.get(r);else{if("string"!=typeof r)return[2,{id:null}];a=n.index("name").get(r)}return[2,new Promise(function(t,n){a.onsuccess=function(e){a.result&&a.result.addTime+36e5>Date.now()?t(a.result.userInfo):t(void 0)},a.onerror=function(e){return n()}})]})})}(r)]:[3,2];case 1:return(t=e.sent())?[2,t]:[3,3];case 2:if(t=Gn("number"==typeof r?"userId_"+r:"userName_"+r))return[2,t];e.label=3;case 3:return n="number"==typeof r?"/user/"+r:"/user/name/"+encodeURIComponent(r),[4,Xn()];case 4:return a=e.sent(),[4,Zn(n,{headers:a})];case 5:return[4,e.sent().json()];case 6:return t=e.sent(),ea?Wn(t):(Jn("userId_"+t.id,t,3600),Jn("userName_"+t.name,t,3600)),[2,t];case 7:return e.sent(),[3,8];case 8:return[2]}})})}function na(o){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,8,,9]),t=void 0,ea?[4,function(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){return t=zt.db.transaction("userInfo","readonly"),n=t.objectStore("userInfo"),[2,Promise.all(a.map(function(e){var a;if("number"==typeof e)a=n.get(e);else{if("string"!=typeof e)return{id:null};a=n.index("name").get(e)}return new Promise(function(t,n){a.onsuccess=function(e){a.result&&a.result.addTime+36e5>Date.now()?t(a.result.userInfo):t(void 0)},a.onerror=function(e){return n()}})}))]})})}(o)]:[3,2];case 1:return t=e.sent().map(function(e,t){return e||o[t]}),[3,3];case 2:t=o.map(function(e){return Gn("number"==typeof e?"userId_"+e:"userName_"+e)||e}),e.label=3;case 3:return n=t.filter(function(e){return"number"==typeof e||"string"==typeof e}),a=[],0===n.length?[3,7]:(r=o.some(function(e){return"number"==typeof e})?"/user?id="+n.join("&id="):"/user/name?name="+n.map(encodeURIComponent).join("&name="),[4,Xn()]);case 4:return s=e.sent(),[4,Zn(r,{headers:s})];case 5:return[4,e.sent().json()];case 6:a=e.sent(),e.label=7;case 7:return[2,t.map(function(e){if("number"!=typeof e&&"string"!=typeof e)return e;var t=a.shift();return t?(ea?Wn(t):(Jn("userId_"+t.id,t,3600),Jn("userName_"+t.name,t,3600)),t):void 0})];case 8:return e.sent(),[3,9];case 9:return[2]}})})}var aa=[{id:758,name:"似水流年"},{id:182,name:"心灵之约"},{id:184,name:"论坛指南"},{id:68,name:"学习天地"},{id:581,name:"科研学术"},{id:102,name:"留学交流"},{id:304,name:"外语学习"},{id:263,name:"考研一族"},{id:105,name:"编程技术"},{id:329,name:"编程答疑"},{id:749,name:"社科讨论"},{id:100,name:"校园信息"},{id:198,name:"新生宝典"},{id:777,name:"维权空间"},{id:357,name:"时事新闻"},{id:459,name:"实习兼职"},{id:515,name:"住房信息"},{id:235,name:"求职广场"},{id:776,name:"新媒互动"},{id:180,name:"数码世界"},{id:30,name:"动漫讨论"},{id:760,name:"文学交流"},{id:759,name:"曲苑杂坛"},{id:26,name:"读书时光"},{id:164,name:"影视综艺"},{id:25,name:"天籁之音"},{id:312,name:"怪力乱神"},{id:16,name:"自由贴图"},{id:91,name:"游戏广场"},{id:115,name:"休闲娱乐"},{id:744,name:"NexusHD"},{id:80,name:"日用交易"},{id:562,name:"数码交易"},{id:563,name:"服饰美肤"},{id:569,name:"代理专区"},{id:764,name:"理财优惠"},{id:114,name:"郁闷小屋"},{id:81,name:"感性空间"},{id:152,name:"缘分天空"},{id:144,name:"一路走来"},{id:135,name:"开怀一笑"},{id:15,name:"体育运动"},{id:147,name:"行者无疆"},{id:226,name:"电脑医院"},{id:258,name:"宠物情缘"},{id:551,name:"绿色心情"},{id:173,name:"光影留痕"},{id:353,name:"真我风采"},{id:229,name:"美食天地"},{id:101,name:"个性生活"},{id:261,name:"健康贴士"},{id:315,name:"98网事"},{id:624,name:"计算机通识答疑"},{id:412,name:"精品课程C语言答疑中心"},{id:408,name:"陈建海老师答疑"},{id:47,name:"陈越老师答疑"},{id:49,name:"方红光老师答疑"},{id:20,name:"冯晓霞老师答疑"},{id:140,name:"古红英老师答疑"},{id:50,name:"徐镜春老师答疑"},{id:41,name:"楼学庆老师答疑"},{id:52,name:"陆汉权老师答疑"},{id:21,name:"何善蒙老师答疑"},{id:205,name:"张引老师的答疑版"},{id:151,name:"孙建伶老师答疑"},{id:7,name:"王何宇老师答疑"},{id:36,name:"王云武老师答疑"},{id:83,name:"魏宝刚老师答疑"},{id:149,name:"李岩老师答疑"},{id:42,name:"杨起帆老师答疑"},{id:23,name:"肖少拥老师答疑"},{id:183,name:"陆魁军老师答疑"},{id:292,name:"高晴老师答疑"},{id:204,name:"冯雁老师答疑"},{id:207,name:"郑扣根老师答疑"},{id:208,name:"翁恺老师答疑"},{id:224,name:"钱抱清老师答疑"},{id:311,name:"杨义群老师答疑"},{id:323,name:"白洪欢老师答疑"},{id:325,name:"贾厚玉老师答疑"},{id:375,name:"张重辉老师答疑"},{id:383,name:"张彤彧老师答疑"},{id:423,name:"方宁老师答疑版"},{id:427,name:"季江民老师答疑版块"},{id:432,name:"陈平老师答疑"},{id:440,name:"丁展平老师答疑"},{id:442,name:"谈艺论戏"},{id:448,name:"张军老师答疑"},{id:451,name:"胡兰青老师答疑"},{id:454,name:"董亚波老师答疑"},{id:457,name:"史治国老师答疑"},{id:494,name:"方富民老师答疑"},{id:501,name:"朱晔老师答疑"},{id:513,name:"邢卫老师答疑"},{id:514,name:"周波老师答疑"},{id:535,name:"面向对象程序设计答疑中心"},{id:540,name:"陆维敏老师答疑"},{id:546,name:"苏振华老师答疑"},{id:548,name:"姜晓红老师答疑"},{id:559,name:"吴江琴老师答疑"},{id:568,name:"杨万喜老师答疑"},{id:574,name:"胡敏老师答疑"},{id:578,name:"蒋文华老师答疑"},{id:579,name:"陈华钧老师答疑"},{id:588,name:"吕萍老师答疑"},{id:589,name:"黄正谦老师答疑"},{id:590,name:"王强老师答疑"},{id:595,name:"陈志坚老师答疑"},{id:575,name:"顾宗华老师答疑版"},{id:599,name:"彭笑刚老师答疑"},{id:600,name:"楼辉老师答疑"},{id:601,name:"沈钦仙老师答疑"},{id:602,name:"孙凌云老师答疑"},{id:603,name:"孟涛老师答疑"},{id:615,name:"孟炳泉老师答疑"},{id:626,name:"杨颖老师答疑"},{id:629,name:"陈实老师答疑"},{id:631,name:"管理学课程交流"},{id:632,name:"陈纯老师答疑"},{id:633,name:"近现代中国的人物研究答疑版"},{id:634,name:"董平老师答疑"},{id:635,name:"戴俊飞老师答疑版"},{id:640,name:"刘海风老师答疑"},{id:710,name:"沈语冰老师答疑"},{id:714,name:"王跃明老师答疑"},{id:723,name:"李浩然老师答疑"},{id:724,name:"胡吉明老师答疑"},{id:726,name:"董玮老师答疑"},{id:727,name:"王毅老师答疑"},{id:728,name:"陈文智老师答疑"},{id:733,name:"陈奇老师答疑版"},{id:745,name:"刘新国老师答疑"},{id:751,name:"李啸风物理化学答疑"},{id:752,name:"雷勇老师答疑"},{id:761,name:"高在峰老师课程交流"},{id:778,name:"彭笑刚大学化学答疑"},{id:248,name:"计算机学院"},{id:294,name:"竺可桢学院"},{id:307,name:"人文学院"},{id:145,name:"传媒学院"},{id:352,name:"经济学院"},{id:362,name:"教育杏坛"},{id:193,name:"生仪大家庭"},{id:158,name:"E电园"},{id:67,name:"管理学院"},{id:285,name:"碧水青禾"},{id:241,name:"医学院"},{id:246,name:"外语学院"},{id:319,name:"光华法学院"},{id:320,name:"生命科学学院"},{id:321,name:"生工食品学院"},{id:341,name:"药学院"},{id:377,name:"动科天地CAS"},{id:344,name:"环资经纬"},{id:351,name:"天下为公"},{id:469,name:"航空航天学院"},{id:623,name:"海洋学院"},{id:58,name:"信电ISEE"},{id:214,name:"不败光电"},{id:371,name:"控制天下"},{id:754,name:"我是工程师"},{id:255,name:"物理系版"},{id:57,name:"数学之韵"},{id:284,name:"建工学院"},{id:775,name:"地球科学学院"},{id:774,name:"心理系"},{id:773,name:"化学系"},{id:772,name:"能源工程学院"},{id:771,name:"机械工程学院"},{id:770,name:"化工学院"},{id:769,name:"高分子系"},{id:768,name:"材料学院"},{id:767,name:"海宁国际"},{id:766,name:"艺韵古欢"},{id:765,name:"马克思主义学院"},{id:247,name:"动力机能"},{id:217,name:"材化演绎"},{id:374,name:"理学院"},{id:437,name:"社团百花园"},{id:330,name:"学生社团联合会"},{id:254,name:"学生旅游协会 "},{id:60,name:"MSTC"},{id:216,name:"梦想天堂"},{id:206,name:"DFM街舞社"},{id:195,name:"法学研究会"},{id:194,name:"梵音剧社"},{id:187,name:"科技探索者协会"},{id:176,name:"Fantasy动漫社"},{id:165,name:"绿之源协会"},{id:310,name:"心理学会"},{id:334,name:"红十字会学生分会"},{id:347,name:"学生三农协会"},{id:369,name:"学生空手道协会 "},{id:355,name:"辩论队与求是辩论社"},{id:361,name:"学生无极棋社"},{id:393,name:"爱心社"},{id:431,name:"学生校友联络协会"},{id:436,name:"杨式太极拳协会"},{id:519,name:"机器人协会"},{id:520,name:"心系西部协会"},{id:446,name:"桥牌协会"},{id:576,name:"黑白剧社"},{id:587,name:"HPA保健协会"},{id:434,name:"亦心·民韵舞社"},{id:213,name:"墨语茗音"},{id:618,name:"成长互助训练营GCC"},{id:628,name:"E志者协会"},{id:303,name:"国防协会"},{id:713,name:"未企俱乐部"},{id:287,name:"SCDA"},{id:736,name:"研创CIE"},{id:264,name:"浙大广电"},{id:467,name:"三湘四水（湖南）"},{id:468,name:"津门故里（天津）"},{id:471,name:"齐鲁青未了（山东）"},{id:472,name:"蓉汇贯川（四川）"},{id:475,name:"三秦大地（陕西）"},{id:481,name:"江南西道（江西）"},{id:482,name:"一皖情深（安徽）"},{id:480,name:"八闽来风（福建）"},{id:483,name:"燕赵飞歌（河北）"},{id:484,name:"吴韵汉风（江苏）"},{id:485,name:"辽地永宁（辽宁）"},{id:486,name:"新上海滩（上海）"},{id:489,name:"黑土风情（黑龙江）"},{id:491,name:"白山松水（吉林）"},{id:492,name:"巴渝人家（重庆）"},{id:493,name:"天山南北（新疆）"},{id:498,name:"晋善晋美（山西）"},{id:502,name:"塞上风光（内蒙古）"},{id:503,name:"彩云之南（云南）"},{id:504,name:"荆楚纵横（湖北）"},{id:505,name:"邦锦梅朵（西藏）"},{id:506,name:"粤来客栈（广东）"},{id:507,name:"鼎豫中原（河南）"},{id:511,name:"丝路花雨（甘肃）"},{id:779,name:"塞上江南（宁夏）"},{id:780,name:"西域之冲（青海）"},{id:550,name:"皇城根儿（北京）"},{id:596,name:"八桂飘香（广西）"},{id:625,name:"黔山秀水（贵州）"},{id:642,name:"椰风海韵（海南）"},{id:474,name:"八婺风情（金华）"},{id:476,name:"秀山丽水（丽水）"},{id:477,name:"山水明州（宁波）"},{id:478,name:"太湖之州（湖州）"},{id:479,name:"金瓯白鹿城（温州）"},{id:488,name:"四省通衢（衢州）"},{id:490,name:"古越绍兴（绍兴）"},{id:495,name:"千岛海韵（舟山）"},{id:496,name:"山海台州（台州）"},{id:497,name:"烟雨江南（嘉兴）"},{id:487,name:"诗画杭城（杭州）"},{id:17,name:"论坛事务"},{id:326,name:"集思广益"},{id:221,name:"版主会议厅"},{id:40,name:"站务讨论"},{id:620,name:"赞助合作"},{id:611,name:"通知通告"},{id:614,name:"莫失莫忘"},{id:286,name:"坛庆策划"},{id:245,name:"技术组工作室"},{id:753,name:"运营管理团队"},{id:747,name:"Banner申请"}];function ra(c,l,u){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),t=20*(c-1),20*c-1,[4,Xn()];case 1:return n=e.sent(),void 0,a=[],[4,Zn("/Board/"+l+"/topic?from="+t+"&size="+(20*c<=u?20:1===c&&u<19?u:u-20*(c-1)),{headers:n})];case 2:switch((r=e.sent()).status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"]}return[4,r.json()];case 3:for(s=e.sent(),o=0;o<s.length;o++)a[o]=x.a({},s[o],{replyCount:s[o].replyCount||0});return[2,a];case 4:return i=e.sent(),console.error(i),[3,5];case 5:return[2]}})})}function sa(o){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,7,,8]),[4,Xn()];case 1:return t=e.sent(),[4,Zn("/Topic/"+o+"/post?from=0&size=1",{headers:t})];case 2:return[4,e.sent().json()];case 3:return n=e.sent(),a=null,1==n[0].isAnonymous?[3,5]:[4,ta(n[0].userId)];case 4:return s=e.sent(),a=x.a({},n[0],{userInfo:s,postId:n[0].id}),[3,6];case 5:r="匿名"+n[0].userName.toUpperCase(),s={name:r,portraitUrl:"/static/images/心灵头像.gif",id:null,privilege:"匿名用户",popularity:0,signatureCode:"",postCount:0},a=x.a({},n[0],{userInfo:s,postId:n[0].id}),e.label=6;case 6:return[2,a];case 7:return e.sent(),[3,8];case 8:return[2]}})})}function oa(e,t){for(var n in t)if(t[n]&&t[n].id===e)return t[n];return{id:e,name:"ID不存在",portraitUrl:"/static/images/default_avatar_boy.png",birthday:"1993-03-25T00:00:00",fanCount:0,followCount:0,gender:0,lastLogOnTime:"2007-12-26T02:26:00",popularity:0,prestige:0,signatureCode:"此ID已不存在，qmd无法显示"}}function ia(e,t){for(var n in t)if(t[n].name===e)return t[n];return{id:null,name:"ID不存在",portraitUrl:"/static/images/default_avatar_boy.png",birthday:"1993-03-25T00:00:00",fanCount:0,followCount:0,gender:0,lastLogOnTime:"2007-12-26T02:26:00",popularity:0,prestige:0,signatureCode:"此ID已不存在，qmd无法显示"}}function ca(h,f){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,8,,9]),t=10*(f-1),[4,Xn()];case 1:return n=e.sent(),[4,Zn("/Topic/"+h+"/post?from="+t+"&size=10",{headers:n})];case 2:return[4,e.sent().json()];case 3:if(a=e.sent(),r=[],s=a.length,o=[],i=[],0===a.length)return[2,[]];c=0,e.label=4;case 4:if(!(c<s))return[3,7];if(0!=a[c].isAnonymous)return[3,6];for(l in a)o[l]=a[l].userId;return[4,na(o)];case 5:i=e.sent(),e.label=6;case 6:return c++,[3,4];case 7:for(l=0;l<s;l++)1!=a[l].isAnonymous&&1!=a[l].isDeleted?(u=oa(a[l].userId,i),r[l]=x.a({},a[l],{userInfo:u,postId:a[l].id})):a[l].isAnonymous&&!a[l].isDeleted?("/static/images/心灵头像.gif",m="匿名"+a[l].userName.toUpperCase(),p={name:m,portraitUrl:"/static/images/心灵头像.gif",id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0},r[l]=x.a({},a[l],{userInfo:p,postId:a[l].id,isAnonymous:!0})):(p={name:"98Deleter",portraitUrl:"/static/images/deleter2.png",id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0},r[l]=x.a({},a[l],{userInfo:p,postId:a[l].id,isAnonymous:!1,isDeleted:!0,content:"该贴已被my cc98, my home"}));return[2,r];case 8:return d=e.sent(),console.error(d),[3,9];case 9:return[2]}})})}function la(c){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,10,,11]),[4,Xn()];case 1:return t=e.sent(),[4,Zn("/Topic/"+c+"/hot-post",{headers:t})];case 2:return[4,e.sent().json()];case 3:n=e.sent(),a=[],r=n.length,s=0,e.label=4;case 4:return s<r?1==n[s].isAnonymous?[3,7]:[4,Zn("/user/name/"+encodeURIComponent(n[s].userName))]:[3,9];case 5:return[4,e.sent().json()];case 6:return i=e.sent(),a[s]=x.a({},n[s],{userInfo:i,postId:n[s].id}),[3,8];case 7:"/static/images/心灵头像.gif",o="匿名"+n[s].userName.toUpperCase(),null,n[s].lastUpdateAuthor&&"匿名"+n[s].lastUpdateAuthor.toUpperCase(),i={name:o,portraitUrl:"/static/images/心灵头像.gif",id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0},a[s]=x.a({},n[s],{userInfo:i,postId:n[s].id}),e.label=8;case 8:return s++,[3,4];case 9:return[2,a];case 10:return e.sent(),[3,11];case 11:return[2]}})})}function ua(I){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f,g,v,b,y,E;return x.d(this,function(e){switch(e.label){case 0:if(!ha())return Cr.dispatch(fe("LogOut")),[2,null];e.label=1;case 1:return e.trys.push([1,15,,16]),t=20,180<I&&(t=200-I),[4,Xn()];case 2:return n=e.sent(),[4,Zn("/topic/new?from="+I+"&size="+t,{headers:n})];case 3:switch((a=e.sent()).status){case 401:Cr.dispatch(fe("UnauthorizedTopic"));case 403:Cr.dispatch(fe("OperationForbidden"))}return[4,a.json()];case 4:r=e.sent(),s=[],o=[],i=[],c=0,l=r,e.label=5;case 5:return c<l.length?((u=l[c]).time=ya(u.time),u.lastPostTime=ya(u.lastPostTime),1e4<u.hitCount&&(m=1e5<u.hitCount?parseInt(""+u.hitCount/1e4):parseInt(""+u.hitCount/1e3)/10,u.hitCount=m+"万"),u.floorCount=u.replyCount+1,1e4<u.replyCount&&(m=1e5<u.replyCount?parseInt(""+u.replyCount/1e4):parseInt(""+u.replyCount/1e3)/10,u.replyCount=m+"万"),u.tag1?[4,Ga((p=u).tag1)]:[3,8]):[3,13];case 6:return p.tag1=e.sent(),u.tag2?[4,Ga((d=u).tag2)]:[3,8];case 7:d.tag2=e.sent(),e.label=8;case 8:return u.isAnonymous?[3,10]:[4,da((h=u).boardId)];case 9:return h.boardName=e.sent(),s.push(u),o.push(u.userId),[3,12];case 10:return u.portraitUrl="/static/images/_心灵之约.png",u.userName="匿名用户",[4,da((f=u).boardId)];case 11:f.boardName=e.sent(),i.push(u),e.label=12;case 12:return c++,[3,5];case 13:return[4,er(o)];case 14:for(b in g=e.sent(),s)v=oa(s[b].userId,g),s[b].portraitUrl=v.portraitUrl;for(E=y=b=0;b<r.length;b++)y===s.length?(r[b]=i[E],E++):r[b].id===s[y].id?(r[b]=s[y],y++):(r[b]=i[E],E++);return[2,r];case 15:return e.sent(),[3,16];case 16:return[2]}})})}function ma(w,e,C,t){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f,g,v,b,y,E,I;return x.d(this,function(e){switch(e.label){case 0:if(!ha())return Cr.dispatch(fe("LogOut")),[2,null];e.label=1;case 1:return e.trys.push([1,22,,23]),t=20,180<C&&(t=200-C),[4,Xn()];case 2:return n=e.sent(),a=void 0,-1!==w?[3,4]:[4,Zn("/me/followee/topic?from="+C+"&size="+t,{headers:n})];case 3:return a=e.sent(),[3,10];case 4:return 0!==w?[3,6]:[4,Zn("/me/custom-board/topic?from="+C+"&size="+t,{headers:n})];case 5:return a=e.sent(),[3,10];case 6:return-2!==w?[3,8]:[4,Zn("/topic/me/favorite?from="+C+"&size="+t+"&order=1",{headers:n})];case 7:return a=e.sent(),[3,10];case 8:return[4,Zn("/board/"+w+"/topic?from="+C+"&size="+t,{headers:n})];case 9:a=e.sent(),e.label=10;case 10:switch(a.status){case 401:Cr.dispatch(fe("UnauthorizedTopic"));case 403:Cr.dispatch(fe("OperationForbidden"))}return[4,a.json()];case 11:r=e.sent(),s=[],o=[],i=[],c=0,l=r,e.label=12;case 12:return c<l.length?((u=l[c]).time=ya(u.time),u.lastPostTime=ya(u.lastPostTime),1e4<u.hitCount&&(m=1e5<u.hitCount?parseInt(""+u.hitCount/1e4):parseInt(""+u.hitCount/1e3)/10,u.hitCount=m+"万"),u.floorCount=u.replyCount+1,1e4<u.replyCount&&(m=1e5<u.replyCount?parseInt(""+u.replyCount/1e4):parseInt(""+u.replyCount/1e3)/10,u.replyCount=m+"万"),u.tag1?[4,Ga((p=u).tag1)]:[3,15]):[3,20];case 13:return p.tag1=e.sent(),u.tag2?[4,Ga((d=u).tag2)]:[3,15];case 14:d.tag2=e.sent(),e.label=15;case 15:return u.isAnonymous?[3,17]:[4,da((h=u).boardId)];case 16:return h.boardName=e.sent(),s.push(u),o.push(u.userId),[3,19];case 17:return u.portraitUrl="/static/images/_心灵之约.png",u.userName="匿名用户",[4,da((f=u).boardId)];case 18:f.boardName=e.sent(),i.push(u),e.label=19;case 19:return c++,[3,12];case 20:return[4,er(o)];case 21:for(v in g=e.sent(),s)b=oa(s[v].userId,g),s[v].portraitUrl=b.portraitUrl;for(I=E=y=0;y<r.length;y++)E===s.length?(r[y]=i[I],I++):r[y].id===s[E].id?(r[y]=s[E],E++):(r[y]=i[I],I++);return[2,r];case 22:return e.sent(),[3,23];case 23:return[2]}})})}function pa(e){for(var t=0,n=aa;t<n.length;t++){var a=n[t];if(e===a.id)return a.name}return"未知版面"}function da(c){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:for(t=0,n=aa;t<n.length;t++)if(a=n[t],c===a.id)return[2,a.name];return[4,Kn()];case 1:r=e.sent(),(s=new Headers).append("Authorization",r),o="/board/"+c,e.label=2;case 2:return e.trys.push([2,5,,6]),[4,Zn(o,{headers:s})];case 3:return[4,e.sent().json()];case 4:return i=e.sent(),[2,i.name];case 5:return e.sent(),[2,"未知版面"];case 6:return[2]}})})}function ha(){var e=Gn("refresh_token"),t=Gn("userInfo");return!(!e||!t)}function fa(c,l,e){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:if(!ha())return Cr.dispatch(fe("LogOut")),[2,null];e.label=1;case 1:return e.trys.push([1,6,,7]),[4,Xn()];case 2:return t=e.sent(),[4,Zn("/message/recent-contact-users?from="+c+"&size="+l,{headers:t})];case 3:return 401===(n=e.sent()).status&&Cr.dispatch(fe("UnauthorizedTopic")),403===n.status&&Cr.dispatch(fe("OperationForbidden")),404===n.status&&Cr.dispatch(fe("NotFoundTopic")),500===n.status&&Cr.dispatch(fe("ServerError")),[4,n.json()];case 4:for(i in a=e.sent(),r=[],a)r[i]=a[i].userId;return[4,er(r)];case 5:for(i in s=e.sent(),o=[],a)o.push(oa(a[i].userId,s));for(i in a)o[i].message=[],o[i].lastContent=a[i].lastContent,o[i].isRead=a[i].isRead;return[2,o];case 6:return e.sent(),[3,7];case 7:return[2]}})})}function ga(r,s,o,e){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:if(!ha())return Cr.dispatch(fe("LogOut")),[2,null];e.label=1;case 1:return e.trys.push([1,5,,6]),[4,Xn()];case 2:return t=e.sent(),[4,Zn("/message/user/"+r+"?from="+s+"&size="+o,{headers:t})];case 3:return 401===(n=e.sent()).status&&Cr.dispatch(fe("UnauthorizedTopic")),403===n.status&&Cr.dispatch(fe("OperationForbidden")),404===n.status&&Cr.dispatch(fe("NotFoundTopic")),n.status,[4,n.json()];case 4:return a=e.sent(),[2,va(a)];case 5:return e.sent(),[3,6];case 6:return[2]}})})}function va(e){if(e!=[]&&e){for(var t=0;t<e.length;t++)t+1==e.length?e[t].showTime=!0:ba(e[t].time)-ba(e[t+1].time)<6e4?e[t].showTime=!1:e[t].showTime=!0;return e}return e}function ba(e){var t=Cn(e).format("YYYY-MM-DD HH:mm:ss");return new Date(t.replace(/-/g,"/")).getTime()}function ya(e){var t=Cn(e).format("YYYY/MM/DD HH:mm:ss"),n=new Date(t),a=n.getTime(),r=(new Date,(new Date).getTime()),s=(new Date((new Date).setHours(0,0,0,0)).getTime()+864e5-a)/1e3,o=n.getMonth()+1;o<10&&(o="0"+o);var i=n.getDate();i<10&&(i="0"+i);var c=n.getHours();c<10&&(c="0"+c);var l=n.getMinutes();l<10&&(l="0"+l);var u=n.getSeconds();return u<10&&(u="0"+u),259200<s?n.getFullYear()+"-"+o+"-"+i+" "+c+":"+l+":"+u:172800<s?"前天 "+(c+":"+l+":"+u):86400<s?"昨天 "+(c+":"+l+":"+u):36e5<r-a?"今天 "+(c+":"+l+":"+u):0<r-a?(l=parseInt((r-a)/6e4))+"分钟前":n.getFullYear()+"-"+o+"-"+i+" "+c+":"+l+":"+u}function Ea(e,a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,Xn()];case 1:return t=e.sent(),[4,Zn("/post/"+a+"/like",{headers:t})];case 2:switch((n=e.sent()).status){case 401:Cr.dispatch(fe("UnauthorizedTopic"));case 403:Cr.dispatch(fe("OperationForbidden"));case 404:Cr.dispatch(fe("NotFoundTopic"));case 500:Cr.dispatch(fe("ServerError"))}return[4,n.json()];case 3:return[2,e.sent()];case 4:return e.sent(),[3,5];case 5:return[2]}})})}function Ia(e){return(e-e%20)/20+1}function wa(a,r){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,Xn()];case 1:return t=e.sent(),[4,Zn("/post/topic/specific-user?topicid="+a+"&postid="+r+"&from=0&size=1",{headers:t})];case 2:return[4,e.sent().json()];case 3:return[2,(n=e.sent())[0].count%10==0?n[0].count/10:(n[0].count-n[0].count%10)/10+1];case 4:return e.sent(),[3,5];case 5:return[2]}})})}function Ca(i,c,l){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:t=10*(l-1),e.label=1;case 1:return e.trys.push([1,8,,9]),[4,Xn()];case 2:return n=e.sent(),[4,Zn("/post/topic/specific-user?topicid="+i+"&postid="+c+"&from="+t+"&size=10",{headers:n})];case 3:return[4,e.sent().json()];case 4:if(!(a=e.sent())[0]||!a[0].isAnonymous)return[3,5];for(o in"/static/images/心灵头像.gif",a)r="匿名"+a[o].userName.toUpperCase(),s={name:r,portraitUrl:"/static/images/心灵头像.gif",id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0,fanCount:0},a[o].userInfo=s,a[o].postId=c;return[3,7];case 5:return[4,ta(a[0].userId)];case 6:for(o in s=e.sent(),a)a[o].userInfo=s,a[o].postId=c;e.label=7;case 7:return[2,a];case 8:return e.sent(),[3,9];case 9:return[2]}})})}function Na(){return a=n=0,document.body&&(n=document.body.scrollTop),document.documentElement&&(a=document.documentElement.scrollTop),(0<n-a?n:a)+("CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight)+300>(t=e=0,document.body&&(e=document.body.scrollHeight),document.documentElement&&(t=document.documentElement.scrollHeight),0<e-t?e:t);var e,t,n,a}function Ta(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return localStorage.setItem("react-mde-imageurl-status","pending"),[4,function(o){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),t="/file",[4,Xn()];case 1:return n=e.sent(),(a=new FormData).append("files",o,o.name),a.append("contentType","multipart/form-data"),[4,Zn(t,{method:"POST",headers:n,body:a})];case 2:return[4,(r=e.sent()).json()];case 3:if(s=e.sent(),200===r.status&&0!==s.length)return[2,{isSuccess:!0,content:s[0]}];throw{};case 4:return[2,{isSuccess:!1,content:e.sent().message}];case 5:return[2]}})})}(a.target.files[0])];case 1:return(t=e.sent()).isSuccess?(n=t.content,localStorage.setItem("react-mde-imageurl-status","success"),localStorage.setItem("react-mde-imageurl",n),[2,n]):(localStorage.setItem("react-mde-imageurl-status","fail"),[2,""])}})})}function Sa(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),[4,Xn()];case 1:return t=e.sent(),[4,Zn("/me/followee/"+r,{method:"PUT",headers:t})];case 2:return 200!==(n=e.sent()).status?[3,3]:[2,!0];case 3:return a=Error.bind,[4,n.text()];case 4:throw new(a.apply(Error,[void 0,e.sent()]));case 5:return[3,7];case 6:return[2,e.sent().message];case 7:return[2]}})})}function xa(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,Xn()];case 1:return t=e.sent(),[4,Zn("/me/followee/"+a,{method:"DELETE",headers:t})];case 2:if(200===(n=e.sent()).status)return[2,!0];throw new Error(n.statusText);case 3:return e.sent(),[2,!1];case 4:return[2]}})})}function ka(i,c){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return t="/topic/best/board/"+c+"?from="+20*(i-1)+"&size=20",[4,Xn()];case 1:return n=e.sent(),[4,Zn(t,{headers:n})];case 2:return[4,e.sent().json()];case 3:for(a=e.sent(),r=[],s=0;s<a.topics.length;s++)r[s]=x.a({},a.topics[s],{replyCount:a.topics[s].replyCount||0});return o=a.count%20==0?a.count/20:(a.count-a.count%20)/20+1,[2,{boardtopics:r,totalPage:o}]}})})}function Pa(c,l){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:return t="/topic/save/board/"+l+"?from="+20*(c-1)+"&size=20",[4,Kn()];case 1:return n=e.sent(),(a=new Headers).append("Authorization",n),[4,Zn(t,{headers:a})];case 2:return[4,e.sent().json()];case 3:for(r=e.sent(),s=[],o=0;o<r.topics.length;o++)s[o]=x.a({},r.topics[o],{replyCount:r.topics[o].replyCount||0});return i=r.count%20==0?r.count/20:(r.count-r.count%20)/20+1,[2,{boardtopics:s,totalPage:i}]}})})}function Ua(N,T,S,e){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f,g,v,b,y,E,I,w,C;return x.d(this,function(e){switch(e.label){case 0:return ha()?T?[4,Xn()]:[3,23]:(Cr.dispatch(fe("LogOut")),[2,null]);case 1:for(a in t=e.sent(),n=T[0],T)"0"!=a&&(n=n+" "+T[a]);if(r=20,s=void 0,0!==N)return[3,7];e.label=2;case 2:return e.trys.push([2,5,,6]),[4,Zn("/topic/search?keyword="+encodeURIComponent(n)+"&size="+r+"&from="+S,{headers:t})];case 3:switch((o=e.sent()).status){case 401:Cr.dispatch(fe("UnauthorizedTopic"));case 403:Cr.dispatch(fe("TooFrequentSearch"))}return[4,o.json()];case 4:return s=e.sent(),[3,6];case 5:return e.sent(),[2,-1];case 6:return[3,11];case 7:return e.trys.push([7,10,,11]),[4,Zn("/topic/search/board/"+N+"?keyword="+encodeURIComponent(n)+"&size="+r+"&from="+S,{headers:t})];case 8:return 401===(o=e.sent()).status&&Cr.dispatch(fe("LogOut")),403===o.status&&Cr.dispatch(fe("OperationForbidden")),404===o.status&&Cr.dispatch(fe("NotFoundTopic")),500===o.status&&Cr.dispatch(fe("ServerError")),[4,o.json()];case 9:return s=e.sent(),[3,11];case 10:return e.sent(),[2,-1];case 11:if(!s||0==s.length)return[3,22];i=[],c=[],l=[],u=0,m=s,e.label=12;case 12:return u<m.length?((p=m[u]).time=ya(p.time),p.lastPostTime=ya(p.lastPostTime),1e4<p.hitCount&&(d=1e5<p.hitCount?parseInt(""+p.hitCount/1e4):parseInt(""+p.hitCount/1e3)/10,p.hitCount=d+"万"),p.floorCount=p.replyCount+1,1e4<p.replyCount&&(d=1e5<p.replyCount?parseInt(""+p.replyCount/1e4):parseInt(""+p.replyCount/1e3)/10,p.replyCount=d+"万"),p.tag1?[4,Ga((h=p).tag1)]:[3,15]):[3,20];case 13:return h.tag1=e.sent(),p.tag2?[4,Ga((f=p).tag2)]:[3,15];case 14:f.tag2=e.sent(),e.label=15;case 15:return p.userId?[4,da((g=p).boardId)]:[3,17];case 16:return g.boardName=e.sent(),i.push(p),c.push(p.userId),[3,19];case 17:return p.portraitUrl="/static/images/_心灵之约.png",p.userName="匿名用户",[4,da((v=p).boardId)];case 18:v.boardName=e.sent(),l.push(p),e.label=19;case 19:return u++,[3,12];case 20:return[4,er(c)];case 21:for(y in b=e.sent(),i)E=oa(i[y].userId,b),i[y].portraitUrl=E.portraitUrl;for(C=w=I=0;I<s.length;I++)w===i.length?(s[I]=l[C],C++):s[I].id===i[w].id?(s[I]=i[w],w++):(s[I]=l[C],C++);return[2,s];case 22:return[2,0];case 23:return[2]}})})}function Ma(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return localStorage.getItem("boardsInfo")?[3,3]:[4,Zn("/board/all")];case 1:return[4,e.sent().json()];case 2:return Jn("boardsInfo",t=e.sent(),3600),[2,t];case 3:return[2,Gn("boardsInfo")]}})})}function Ra(e){if(!Gn("userInfo"))return!1;var t=Gn("userInfo").customBoards;if(t)for(var n=0,a=t;n<a.length;n++){if(a[n]==e)return!0}return!1}function Oa(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/me/custom-board/"+n,{method:"PUT",headers:t})];case 2:return e.sent(),[4,Da()];case 3:return e.sent(),qn("focusBoardList"),[2]}})})}function Da(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return Gn("refresh_token")?[4,Xn()]:[3,4];case 1:return[4,Zn("/me",{headers:e.sent()})];case 2:return[4,e.sent().json()];case 3:t=e.sent(),Cr.dispatch(te(t)),Jn("userInfo",t,2592e3),e.label=4;case 4:return[2]}})})}function ja(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/me/custom-board/"+n,{method:"DELETE",headers:t})];case 2:return e.sent(),[4,Da()];case 3:return e.sent(),qn("focusBoardList"),[2]}})})}function La(n,a){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),[4,Zn("/board/"+a+"/stop-post-user/"+n,{method:"DELETE",headers:t})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}function Fa(a,e,r,s,o){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n={topState:r,duration:s,reason:o},[4,Zn("/topic/"+a+"/top",{method:"PUT",headers:t,body:JSON.stringify(n)})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}function Ba(a,e,r){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n={reason:r},[4,Zn("/topic/"+a+"/top",{method:"DELETE",headers:t,body:JSON.stringify(n)})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}function Aa(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return[4,Zn("/me/all-message-count",{headers:e.sent()})];case 2:return[4,e.sent().json()];case 3:switch(t=e.sent(),n){case 1:return[2,t.replyCount];case 2:return[2,t.atCount];case 3:return[2,t.systemCount]}return[2]}})})}function _a(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/topic/"+a,{headers:t})];case 2:switch((n=e.sent()).status){case 401:return ha()?Cr.dispatch(fe("UnauthorizedTopic")):Cr.dispatch(fe("LogOut")),[2,null];case 403:return Cr.dispatch(fe("OperationForbidden")),[2,null];case 404:return Cr.dispatch(fe("NotFoundTopic")),[2,null];case 500:return Cr.dispatch(fe("ServerError")),[2,null]}return[4,n.json()];case 3:return[2,e.sent()]}})})}function za(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/board/"+r,{headers:t})];case 2:switch((n=e.sent()).status){case 404:return[2,"not found"];case 500:return[2,"server error"]}return[4,n.json()];case 3:return!1===(a=e.sent()).canEntry?[2,"unauthorized"]:[2,a]}})})}function Va(e){var t=e+1;return t%10==0?t/10:(t-t%10)/10+1}function Ha(e){if(Gn("userInfo")){var t=Gn("userInfo").privilege,n=Gn("userInfo").name;Gn("userInfo").id;if("管理员"===t||"超级版主"===t)return!0;if(!e)return!1;for(var a=0;a<e.length;a++)if(n===e[a])return!0}return!1}function Wa(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/board/"+n+"/tag",{headers:t})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}function $a(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/topic/"+n+"/isfavorite",{headers:t})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}function Ya(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return Gn("tagInfo")?[2,Gn("tagInfo")]:[3,1];case 1:return[4,qa()];case 2:return[2,e.sent()]}})})}function qa(){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return t="/config/global/alltag",[4,Xn()];case 1:return n=e.sent(),[4,Zn(t,{headers:n})];case 2:return[4,e.sent().json()];case 3:return Jn("tagInfo",a=e.sent()),[2,a]}})})}function Ja(c){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:return[4,Ya()];case 1:for(t=e.sent(),n=0,a=t;n<a.length;n++)if((i=a[n]).name===c)return[2,i.id];return[4,qa()];case 2:for(r=e.sent(),s=0,o=r;s<o.length;s++)if((i=o[s]).name===c)return[2,i.id];return[2,!1]}})})}function Ga(s){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Ya()];case 1:for(t=e.sent(),n=0,a=t;n<a.length;n++)if((r=a[n]).id===s)return[2,r.name];return[2,!1]}})})}function Qa(a,r,s,o){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t="/topic/search/board/"+r+"/tag?tag"+s+"="+a+"&from="+20*(o-1)+"&size=20",[4,Xn()];case 1:return n=e.sent(),[4,Zn(t,{headers:n})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}function Ka(a,r,s,o){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t="/topic/search/board/"+s+"/tag?tag1="+a+"&tag2="+r+"&from="+20*(o-1)+"&size=20",[4,Xn()];case 1:return n=e.sent(),[4,Zn(t,{headers:n})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}function Xa(n,a){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return t="userName_"+a,Qn("userId_"+n),Qn(t),[4,function(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){return t=zt.db.transaction("userInfo","readwrite"),n=t.objectStore("userInfo"),a=n.delete(r),[2,new Promise(function(e,t){a.onsuccess=function(){return e()},a.onerror=function(){return t()}})]})})}(n)];case 1:return e.sent(),[4,ta(n)];case 2:return e.sent(),[2]}})})}function Za(e,t){for(var n=0,a=t;n<a.length;n++)for(var r=a[n],s=0,o=r.tags;s<o.length;s++){if(o[s].id==e)return r.layer}return!1}function er(l){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c;return x.d(this,function(e){switch(e.label){case 0:for(t=[],n=[],c=0;c<l.length;c++)(a=Gn("userId_"+l[c]))?n.push(a):t.push(l[c]);return 0!==t.length?[3,1]:[2,n];case 1:for(r="/user/basic",c=0;c<t.length;c++)r=0===c?r+"?id="+t[c]:r+"&id="+t[c];e.label=2;case 2:return e.trys.push([2,5,,6]),[4,Zn(r)];case 3:return[4,e.sent().json()];case 4:for(s=e.sent(),o=0,i=s;o<i.length;o++)c=i[o],n.push(c);return[2,n];case 5:return e.sent(),[2,[]];case 6:return[2]}})})}function tr(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return r&&0!==r.length?[4,Xn()]:[2,[]];case 1:for(t=e.sent(),n="/topic/basic",a=0;a<r.length;a++)n=0===a?n+"?id="+r[a]:n+"&id="+r[a];e.label=2;case 2:return e.trys.push([2,5,,6]),[4,Zn(n,{headers:t})];case 3:return[4,e.sent().json()];case 4:return[2,e.sent()];case 5:return e.sent(),[2,[]];case 6:return[2]}})})}function nr(e,t){for(var n in t)if(t[n].id===e)return t[n];return{id:e,title:"未知主题（该主题已被删除或者无权限获取）",boardId:0}}function ar(t){try{for(var e=/([\s\S]*)\[quotex?\][\s\S]*?\[\/quotex?\]([\s\S]*)/,n=/@[^ \n]{1,10}?[ ]+/g,a=/[^@ ]+/,r=void 0;(r=t.match(e))&&(t=""+t.match(e)[1]+t.match(e)[2]),r;);if(""===t)return!1;if(t.match(n)){var s=t.match(n).length;10<s&&(s=10);for(var o=new Array,i=0;i<s;i++){var c=t.match(n)[i],l=a.exec(c)[0];o[i]=l}return o}return!1}catch(e){return t}}function rr(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return t=location.pathname,n=null,a=Cr.getState().message,[4,Xn()];case 1:if(r=e.sent(),"/message/response"===t){if(0===a.replyCount)return[2,null];n="/notification/read-all-reply"}else if("/message/attme"===t){if(0===a.atCount)return[2,null];n="/notification/read-all-at"}else if("/message/system"===t){if(0===a.systemCount)return[2,null];n="/notification/read-all-system"}else{if("/message"!==t)return[2,null];if(0===a.replyCount)return[2,null];n="/notification/read-all-reply"}return[4,Zn(n,{method:"PUT",headers:r,body:""})];case 2:return e.sent(),Cr.dispatch(yr.changeMessageCount({messageCount:0,systemCount:0,atCount:0,replyCount:0})),[2,null]}})})}function sr(e){Ee("#"+e).removeClass("displaynone"),Ee("#"+e).removeClass("noticeDisplaynone"),setTimeout(function(){Ee("#"+e).addClass("noticeDisplaynone")},1500)}function or(e){Ee("#mainStylesheet").attr("href","/static/content/"+themeNames[e])}function ir(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/manage/reward-daily-record?boardId="+n,{headers:t})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}function cr(n,a,r){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/board/"+n+"/events?from="+a+"&size="+r,{headers:t})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}function lr(y){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f,g,v,b;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return e.sent(),[4,Zn("/topic/hot-"+y)];case 2:switch((t=e.sent()).status){case 401:Cr.dispatch(fe("UnauthorizedTopic"));case 403:Cr.dispatch(fe("OperationForbidden"))}return[4,t.json()];case 3:n=e.sent(),a=[],r=[],s=[],o=0,i=n,e.label=4;case 4:return o<i.length?((c=i[o]).time=ya(c.time),c.lastPostTime=ya(c.lastPostTime),1e4<c.hitCount&&(l=1e5<c.hitCount?parseInt(""+c.hitCount/1e4):parseInt(""+c.hitCount/1e3)/10,c.hitCount=l+"万"),c.floorCount=c.replyCount+1,1e4<c.replyCount&&(l=1e5<c.replyCount?parseInt(""+c.replyCount/1e4):parseInt(""+c.replyCount/1e3)/10,c.replyCount=l+"万"),c.tag1?[4,Ga((u=c).tag1)]:[3,7]):[3,12];case 5:return u.tag1=e.sent(),c.tag2?[4,Ga((m=c).tag2)]:[3,7];case 6:m.tag2=e.sent(),e.label=7;case 7:return c.userId?[4,da((p=c).boardId)]:[3,9];case 8:return p.boardName=e.sent(),a.push(c),r.push(c.userId),[3,11];case 9:return c.portraitUrl="/static/images/_心灵之约.png",c.userName="匿名用户",[4,da((d=c).boardId)];case 10:d.boardName=e.sent(),s.push(c),e.label=11;case 11:return o++,[3,4];case 12:return[4,er(r)];case 13:for(g in h=e.sent(),a)f=oa(a[g].userId,h),a[g].portraitUrl=f.portraitUrl;for(b=v=g=0;g<n.length;g++)v===a.length?(n[g]=s[b],b++):n[g].id===a[v].id?(n[g]=a[v],v++):(n[g]=s[b],b++);return[2,n]}})})}function ur(a,r,s){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t="/board/"+a+"/stop-post-user?from="+r+"&size="+s,[4,Xn()];case 1:return(n=e.sent()).append("Content-Type","application/json"),[4,Zn(t,{headers:n})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}function mr(a,r){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t="/topic/"+a+"/event?from="+r+"&size=7",[4,Xn()];case 1:return n=e.sent(),[4,Zn(t,{headers:n})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}function pr(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return(t=Gn("wealth"))?[3,2]:[4,Da()];case 1:e.sent(),n=Gn("userInfo"),Jn("wealth",t=n.wealth,300),e.label=2;case 2:return[2,t]}})})}var dr=function(){},hr=function(){},fr=function(){this.isLogOn=ha(),this.isLoading=!1,this.currentUserInfo=Gn("userInfo")||new dr,this.currentVisitingUserPage="exact",this.currentVisitingUserId=0,this.currentVisitingUserIsExisted=!0,this.recentTopics=[],this.recentPosts=[],this.hotPosts=[],this.isError=!1,this.errorMessage="",this.currentUserFavoriteBoards=[],this.hasTotal=new gr,this.totalPage=new vr,this.currentUserFansInfo=[],this.currentUserFollowingInfo=[],this.currentUserFavoriteTopics=[],this.currentUserCenterPage="profile",this.transferSuccessUsers=[],this.totalPage.myfollowings=Math.ceil(this.currentUserInfo.followCount/10),this.totalPage.myfans=Math.ceil(this.currentUserInfo.fanCount/10)},gr=function(){this.profile=!1,this.mytopics=!1,this.myposts=!0,this.myfavoriteposts=!1,this.myfollowings=!0,this.myfans=!0},vr=function(){this.profile=1,this.mytopics=1,this.myposts=1,this.myfavoriteposts=1},br=function(){this.systemCount=0,this.atCount=0,this.replyCount=0,this.messageCount=0},yr=x.a({},a,r,s),Er=Object(p.c)({error:function(e,t){switch(void 0===e&&(e=new be),t.type){case B:return x.a({},e,{isError:!0,errorMessage:t.payload.message});case A:return x.a({},e,{isError:!1});default:return e}},router:m.c,userInfo:function(e,t){var n,a,r;switch(void 0===e&&(e=new fr),t.type){case h:return x.a({},e,{isLogOn:!0},new fr);case f:return x.a({},e,{isLogOn:!1});case g:return Jn("userInfo",t.payload.newInfo,2592e3),Wn(t.payload.newInfo),x.a({},e,{currentUserInfo:t.payload.newInfo});case v:return x.a({},e,{currentVisitingUserPage:t.payload.page,currentVisitingUserId:t.payload.id});case k:return x.a({},e,{currentVisitingUserIsExisted:!1});case P:return x.a({},e,{isLoading:!0,isError:!1});case U:return x.a({},e,{isLoading:!1});case M:return x.a({},e,{isError:!0,errorMessage:t.payload.message});case b:return x.a({},e,{currentUserFavoriteBoards:t.payload.boardsInfo});case C:return x.a({},e,{recentTopics:t.payload.posts});case N:var s=JSON.parse(JSON.stringify(e.totalPage));return s.myposts=t.payload.total,x.a({},e,{recentPosts:t.payload.posts,totalPage:s});case T:return x.a({},e,{hotPosts:t.payload.posts});case D:switch(e.currentUserCenterPage){case"profile":case"myposts":return x.a({},e,{hasTotal:x.a({},e.hasTotal,{profile:!0,myposts:!0}),totalPage:x.a({},e.totalPage,{profile:t.payload.totalPage,myposts:t.payload.totalPage})});default:return x.a({},e,{hasTotal:x.a({},e.hasTotal,(n={},n[e.currentUserCenterPage]=!0,n)),totalPage:x.a({},e.totalPage,(a={},a[e.currentUserCenterPage]=t.payload.totalPage,a))})}case O:switch(e.currentUserCenterPage){case"profile":case"myposts":return x.a({},e,{hasTotal:x.a({},e.hasTotal,{profile:!1,myposts:!1})});default:return x.a({},e,{hasTotal:x.a({},e.hasTotal,(r={},r[e.currentUserCenterPage]=!1,r))})}case E:return x.a({},e,{currentUserFansInfo:t.payload.fansInfo});case w:return x.a({},e,{currentUserFollowingInfo:t.payload.followingsInfo});case y:return x.a({},e,{currentUserFavoriteTopics:t.payload.posts});case S:return x.a({},e,{currentUserCenterPage:t.payload.page});case j:var o=e.currentUserFollowingInfo.map(function(e){return e.id===t.payload.userId?x.a({},e,{isFollowing:!0}):e}),i=e.currentUserFansInfo.map(function(e){return e.id===t.payload.userId?x.a({},e,{isFollowing:!0}):e});return x.a({},e,{currentUserFollowingInfo:o,currentUserFansInfo:i});case L:return o=e.currentUserFollowingInfo.map(function(e){return e.id===t.payload.userId?x.a({},e,{isFollowing:!1}):e}),i=e.currentUserFansInfo.map(function(e){return e.id===t.payload.userId?x.a({},e,{isFollowing:!1}):e}),x.a({},e,{currentUserFollowingInfo:o,currentUserFansInfo:i});case R:return x.a({},e,{errorMessage:"",isError:!1});case F:return x.a({},e,{transferSuccessUsers:t.payload.userNames});default:return e}},message:function(e,t){switch(void 0===e&&(e=new br),t.type){case _:return x.a({},e,t.payload.message);default:return e}}}),Ir=u()(),wr=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||p.d,Cr=Object(p.e)(Er,wr(Object(p.a)(d.a,Object(m.b)(Ir)))),Nr=n(16),Tr=(n(934),n(935),n(1231)),Sr=function(n){function e(e,t){return n.call(this,e,t)||this}return x.c(e,n),Object.defineProperty(e.prototype,"match",{get:function(){return this.props.match},enumerable:!0,configurable:!0}),e}(I.Component),xr=n(936),kr=n(937);var Pr=function(n){function e(e){var t=n.call(this,e)||this;return t.valueStack=[""],t.redoStack=[],t.undo=t.undo.bind(t),t.redo=t.redo.bind(t),t.blur=t.blur.bind(t),t.changeValue=t.changeValue.bind(t),t}return x.c(e,n),e.prototype.undo=function(){if(1!==this.valueStack.length){var e=this.valueStack.pop();this.redoStack.push(e),e=this.valueStack[this.valueStack.length-1],this.props.onChange(e)}},e.prototype.redo=function(){var e=this.redoStack.pop();e&&(this.valueStack.push(e),this.props.onChange(e))},e.prototype.blur=function(){this.textarea.blur()},e.prototype.changeValue=function(e){this.props.onChange(e),this.valueStack.push(e),this.textarea.scrollTop=this.scrollTop},e.prototype.componentWillReceiveProps=function(e){e.value!==this.valueStack[this.valueStack.length-1]&&(this.valueStack.push(e.value),this.redoStack=[])},e.prototype.render=function(){var t=this;return I.createElement("textarea",x.a({ref:function(e){return t.textarea=e}},this.props,{onChange:function(e){return t.changeValue(e.target.value)},onScroll:function(e){return t.scrollTop=t.textarea.scrollTop},onFocus:function(e){return t.textarea.scrollTop=t.scrollTop},onInput:function(){return t.redoStack=[]},onKeyDown:function(e){t.props.onKeyDown&&t.props.onKeyDown(e),"z"===e.key&&e.ctrlKey&&t.undo(),"y"===e.key&&e.ctrlKey&&t.redo()}}))},e}(I.PureComponent),Ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){var t,n=this;t=function(e){return n.props.changeValue({type:"color",tagName:"color",mainProperty:e.toHexString()})},$("#color").spectrum({color:"#000",change:function(e){t(e),$("#color").spectrum("set","#000000")},showPalette:!0,palette:[["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"],["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"]],replacerClassName:"ubb-color-picker",hideAfterPaletteSelect:!0})},t.prototype.render=function(){var o=this;return I.createElement("div",{className:"ubb-buttons",onClick:function(e){return e.stopPropagation()}},xr.map(function(e){if(o.props.isPreviewing)return null;var t=e.type,n=e.tagName,a=e.tagIcon,r=e.tagDescription,s=e.title;switch(e.type){case"text":return I.createElement("button",{type:"button",className:"fa "+a+" ubb-button",title:s,key:n+a,onClick:function(){return o.props.changeValue({type:t,tagName:n,mainProperty:e.mainValue})}},r);case"fontSize":return I.createElement("div",{key:n+a,className:"ubb-button ubb-button-fontSize"},I.createElement("div",{className:"fa "+a+" ubb-button-icon"}),I.createElement("select",{value:"0",onChange:function(e){o.props.changeValue({type:t,tagName:n,mainProperty:e.target.value}),e.target.value="0"}},e.fontSize.map(function(e){return I.createElement("option",{key:e,value:e.toString(),disabled:0===e},e)})));case"color":return I.createElement("div",{className:"ubb-button ubb-button-color",key:n+a},I.createElement("div",{className:"fa "+a+" ubb-button-icon"}),I.createElement("input",{id:"color"}));case"extend":return I.createElement("button",{type:"button",title:s,key:n+a,className:"fa "+a+" ubb-button",onClick:function(){return o.props.changeExtendName(n)}},r);case"upload":return I.createElement("label",{key:n+a,htmlFor:"ubbFileUpload",title:s,className:"fa "+a+" ubb-button ubb-button-icon",style:{pointerEvents:"all"}});case"emoji":return I.createElement("button",{type:"button",title:s,key:n+a,className:"fa "+a+" ubb-button",onClick:function(){return o.props.changeExtendName(n)}})}}),I.createElement("div",{style:{flexGrow:1}}),this.props.isPreviewing?null:I.createElement(I.Fragment,null,I.createElement("button",{className:"fa fa-undo ubb-button",type:"button",title:"撤销",onClick:this.props.undo}),I.createElement("button",{className:"fa fa-repeat ubb-button",type:"button",title:"重做",onClick:this.props.redo})),I.createElement("button",{className:"fa fa-window-maximize ubb-button",type:"button",title:"切换预览",onClick:this.props.triggerIsPreviewing}))},t}(I.PureComponent);n(938);var Mr=function(n){function e(t){var e=n.call(this,t)||this;return e.state={extendConfig:xr.filter(function(e){return e.tagName===t.extendTagName})[0]},e}return x.c(e,n),e.prototype.componentWillReceiveProps=function(t){t.extendTagName&&this.setState({extendConfig:xr.filter(function(e){return e.tagName===t.extendTagName})[0]})},e.prototype.changeValue=function(e){var t=e.keys(),n=[];for(var a in t)"content"!==a&&"mainValue"!==a&&n.push({key:a,value:e.get(a)});this.props.changeValue({tagName:this.props.extendTagName,content:e.get("content"),type:"extend",mainProperty:e.get("mainValue"),subProperties:n}),this.form.reset()},e.prototype.render=function(){var t=this;return I.createElement("div",{className:"ubb-extend",onClick:function(e){return e.stopPropagation()},style:{height:this.props.extendIsShown?"2rem":"0rem"}},this.state.extendConfig?I.createElement("form",{ref:function(e){return t.form=e},onSubmit:function(e){e.preventDefault(),t.changeValue(new FormData(e.target))}},I.createElement("input",{className:"ubb-extend-main",type:"text",defaultValue:"",name:"content",placeholder:this.state.extendConfig.contentValueInfo}),this.state.extendConfig.propertiesInfos?this.state.extendConfig.propertiesInfos.map(function(e,t){return I.createElement(I.Fragment,null,I.createElement("span",null,"|"),I.createElement("input",{type:"text",defaultValue:"",name:e.key||"mainValue",placeholder:e.title,key:e.key+t,className:"ubb-extend-sub"}))}):null,this.state.extendConfig.hasCompassOption&&I.createElement(I.Fragment,null,I.createElement("input",{id:"shouldCompassImage",onChange:function(e){return t.props.changeShouldCompassImage(!e.target.checked)},type:"checkbox",checked:!this.props.shouldCompassImage}),I.createElement("label",{htmlFor:"shouldCompassImage",style:{fontSize:14,userSelect:"none"}},"无损上传")),this.state.extendConfig.allowUpload&&I.createElement("label",{style:{pointerEvents:"all"},className:"fa fa-upload ubb-button-icon",htmlFor:"ubbFileUpload"}),I.createElement("button",{style:{marginLeft:"10px"},className:"fa fa-check",type:"submit"}),I.createElement("button",{style:{marginLeft:"10px"},className:"fa fa-remove",type:"reset",onClick:this.props.clearShown})):null)},e}(I.PureComponent),Rr=function(n){function e(e){var t=n.call(this,e)||this;return t.state={isShown:!1,message:e.message},t}return x.c(e,n),e.prototype.componentWillReceiveProps=function(e){var t=this;""!==e.message&&(this.setState({isShown:!0,message:e.message}),setTimeout(function(){t.setState({isShown:!1})},2e3))},e.prototype.render=function(){return I.createElement("div",{className:"ubb-editor-info",style:this.state.isShown?{opacity:1}:{opacity:0}},I.createElement("p",null,this.state.message))},e}(I.Component),Or=function(n){function e(e){var t=n.call(this,e)||this;return t.state={loaded:!1},t}return x.c(e,n),e.prototype.componentDidMount=function(){var e=this,t=new Image;t.onload=function(){e.setState({loaded:!0})},t.src=this.props.src},e.prototype.componentWillReceiveProps=function(e){var t=this;if(e.src!==this.props.src){this.setState({loaded:!1});var n=new Image;n.onload=function(){t.setState({loaded:!0})},n.src=e.src}},e.prototype.render=function(){return this.state.loaded?I.createElement("img",{className:this.props.className,src:this.props.src,onClick:this.props.onClick}):I.createElement("img",{className:this.props.className})},e}(I.Component),Dr=function(n){function e(e){var t=n.call(this,e)||this;return t.insertEmoji=t.insertEmoji.bind(t),t}return x.c(e,n),e.prototype.insertEmoji=function(e,t){this.props.changeValue({tagName:e,mainProperty:t,type:"emoji"})},e.prototype.render=function(){var t=this,e={animal:["001","002","003","004","005","006","007","008","009","010","011","012","013","014","015","016"].map(function(e){return I.createElement(Or,{key:"[a:"+e+"]",src:"/static/images/mahjong/animal2017/"+e+".png",onClick:function(){t.insertEmoji("a:",e)}})}),carton:["003.png","018.gif","019.png","046.png","049.gif","059.png","096.gif","134.png","189.png","217.png"].map(function(e){return I.createElement(Or,{key:"[c:"+e.slice(0,3)+"]",src:"/static/images/mahjong/carton2017/"+e,onClick:function(){t.insertEmoji("c:",e.slice(0,3))}})}),face:new Array(208).fill(0).map(function(e,t){return t<9?"00"+(t+1):t<99?"0"+(t+1):""+(t+1)}).map(function(e,t){return-1!==[4,9,56,61,62,87,115,120,137,168,169,175,206].indexOf(t+1)?e+".gif":e+".png"}).map(function(e){return I.createElement(Or,{key:"[f:"+e.slice(0,3)+"]",src:"/static/images/mahjong/face2017/"+e,onClick:function(){t.insertEmoji("f:",e.slice(0,3))}})})},n={CC98:new Array(14).fill(0).map(function(e,t){return t<9?"0"+(t+1):""+(t+1)}).map(function(e){return e?I.createElement(Or,{key:"[CC98"+e+"]",src:"/static/images/CC98/CC98"+e+".gif",onClick:function(){t.insertEmoji("cc98",e)},className:"ubb-emoji-CC98"}):null}),em:new Array(92).fill(0).map(function(e,t){return t<10?"0"+t:t<44||70<t&&t<92?""+t:void 0}).map(function(e){return e?I.createElement(Or,{key:"[em"+e+"]",src:"/static/images/em/em"+e+".gif",onClick:function(){t.insertEmoji("em",e)}}):null}),ac:new Array(149).fill(0).map(function(e,t){return t<9?"0"+(t+1):t<54?""+(t+1):t<94?""+(t+947):""+(t+1907)}).map(function(e){return I.createElement(Or,{key:"[ac"+e+"]",src:"/static/images/ac/"+e+".png",onClick:function(){t.insertEmoji("ac",e)}})}),mj:e.animal.concat(e.carton,e.face),tb:new Array(33).fill(0).map(function(e,t){return t<9?"0"+(t+1):""+(t+1)}).map(function(e){return I.createElement(Or,{key:"[tb"+e+"]",src:"/static/images/tb/tb"+e+".png",onClick:function(){t.insertEmoji("tb",e)}})}),ms:new Array(54).fill(0).map(function(e,t){return t<9?"0"+(t+1):""+(t+1)}).map(function(e){return I.createElement(Or,{key:"ms"+e,src:"/static/images/ms/ms"+e+".png",onClick:function(){return t.insertEmoji("ms",e)},className:"ubb-emoji-ms"})})},a={CC98:I.createElement("p",{className:"ubb-emoji-info"},"该组表情由 ",I.createElement("a",{target:"_blank",href:"/user/id/567066"},"洛予")," 和 ",I.createElement("a",{target:"_blank",href:"/user/id/641262"},"大鲶鱼保佑")," 制作"),ac:I.createElement("p",{className:"ubb-emoji-info"},"该组表情由 ",I.createElement("a",{target:"_blank",href:"http://www.acfun.cn"},"AcFun弹幕视频网")," 提供"),mj:I.createElement("p",{className:"ubb-emoji-info"},"该组表情由 ",I.createElement("a",{target:"_blank",href:"//bbs.saraba1st.com/2b/forum.php"},"stage1st论坛")," 提供"),tb:I.createElement("p",{className:"ubb-emoji-info"},"该组表情由 ",I.createElement("a",{target:"_blank",href:"//tieba.baidu.com "},"百度贴吧")," 提供"),ms:I.createElement("p",{className:"ubb-emoji-info"},"该组表情由 ",I.createElement("a",{target:"_blank",href:"https://www.maj-soul.com/"},"雀魂Majsoul")," 提供"),em:null},r=this.props,s=r.emojiType,o=r.emojiIsShown;return I.createElement("div",{className:"ubb-emoji",style:o?{height:(this.props.height||18)+"rem",borderWidth:"1px"}:{height:"0rem"},onClick:function(e){return e.stopPropagation()}},I.createElement("div",{className:"ubb-emoji-buttons"},I.createElement("button",{type:"button",className:"CC98"===s?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(e){e.stopPropagation(),t.props.changeEmojiType("CC98")}},"CC98"),I.createElement("button",{type:"button",className:"ac"===s?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(e){e.stopPropagation(),t.props.changeEmojiType("ac")}},"AC娘"),I.createElement("button",{type:"button",className:"mj"===s?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(e){e.stopPropagation(),t.props.changeEmojiType("mj")}},"麻将脸"),I.createElement("button",{type:"button",className:"tb"===s?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(e){e.stopPropagation(),t.props.changeEmojiType("tb")}},"贴吧"),I.createElement("button",{type:"button",className:"ms"===s?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(e){e.stopPropagation(),t.props.changeEmojiType("ms")}},"雀魂"),I.createElement("button",{type:"button",className:"em"===s?"ubb-emoji-button-active":"ubb-emoji-button",onClick:function(e){e.stopPropagation(),t.props.changeEmojiType("em")}},"经典")),I.createElement("div",{className:"ubb-emoji-content ubb-emoji-content-"+s,style:{height:(this.props.height||16)+"rem"}},a[s],n[s]))},e}(I.Component),jr=function(n){function e(e){var t=n.call(this,e)||this;return t.onChange=function(e){t.setState({value:e}),t.props.update(e)},t.state={value:"",selectionStart:0,selectionEnd:0,extendTagName:"",message:"",emojiType:"hide",isPreviewing:!1,shouldCompassImage:!0},t.onChange=t.onChange.bind(t),t.changeValue=t.changeValue.bind(t),t.changeExtend=t.changeExtend.bind(t),t.message=t.message.bind(t),t.handleUpload=t.handleUpload.bind(t),t.changeEmojiType=t.changeEmojiType.bind(t),t.clearExtendAndEmoji=t.clearExtendAndEmoji.bind(t),t.triggerIsPreviewing=t.triggerIsPreviewing.bind(t),t.changeShouldCompassImage=t.changeShouldCompassImage.bind(t),t}return x.c(e,n),e.prototype.changeExtend=function(t){if("emoji"===t&&"hide"===this.state.emojiType){var e="CC98";Gn("defaultEmojiType")&&(e=Gn("defaultEmojiType")),this.setState({emojiType:e})}this.setState(function(e){return t===e.extendTagName?{extendTagName:""}:{extendTagName:t}})},e.prototype.changeValue=function(e){var t,n,a,r,s,o,i,c,l,u,m,p,d=(t=this.state,n=e,a=t.value,r=t.selectionStart,s=t.selectionEnd,o=n.tagName,i=n.mainProperty,n.subProperties,c=n.content,l=a.slice(0,r),u=a.slice(s,a.length),m=a.slice(r,s),p="["+o,"emoji"===n.type?p+=i+"]":(i&&(p+="="+i),p+=c?"]"+c+"[/"+o+"]":"]"+m+"[/"+o+"]"),s=-1!==kr.shouldNotSelect.indexOf(o)?r+=(p+="\n").length:"emoji"===n.type?r+=p.length:r+p.length,l+=p,{value:l+=u,selectionStart:r,selectionEnd:s});this.setState(d,this.selectTextArea),this.props.update(d.value),this.clearExtendAndEmoji()},e.prototype.triggerIsPreviewing=function(){this.setState(function(e){return{isPreviewing:!e.isPreviewing}})},e.prototype.selectTextArea=function(){this.customTextArea.textarea.focus(),this.customTextArea.textarea.setSelectionRange(this.state.selectionStart,this.state.selectionEnd)},e.prototype.handleUpload=function(r,s){return x.b(this,void 0,void 0,function(){var n,t,a=this;return x.d(this,function(e){switch(e.label){case 0:n=Array.from(r),e.label=1;case 1:if(e.trys.push([1,3,,4]),"img"!==this.state.extendTagName&&n.some(function(e){return-1===e.type.indexOf("image")&&10485760<e.size}))throw new Error("文件过大");return[4,function(o,i){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:if(!o.length)throw new Error("未找到文件，请尝试点击按钮上传");return t=i?"/file":"/file?compressImage=false",[4,Xn()];case 1:return n=e.sent(),(a=new FormData).append("contentType","multipart/form-data"),o.map(function(e){return a.append("files",e,e.name)}),[4,Zn(t,{method:"POST",headers:n,body:a})];case 2:return[4,(r=e.sent()).json()];case 3:if(s=e.sent(),r.ok)return[2,s];throw new Error("上传失败")}})})}(n,s)];case 2:return e.sent().map(function(e,t){return a.changeValue({type:"extend",tagName:function(e){try{switch(!0){case-1!==e.type.indexOf("image"):return"img";case-1!==e.type.indexOf("video"):return"video";case-1!==e.type.indexOf("audio"):return"audio"}var t=e.name.match(/\.(\w+)$/)[1];switch(!0){case-1!==kr.fileExtendedNames.audio.indexOf(t):return"audio";case-1!==kr.fileExtendedNames.video.indexOf(t):return"video";case-1!==kr.fileExtendedNames.image.indexOf(t):return"img";default:throw new Error}}catch(e){return"upload"}}(n[t]),content:e})}),[3,4];case 3:return t=e.sent(),this.message(t.message),[3,4];case 4:return[2]}})})},e.prototype.changeEmojiType=function(e){this.setState({emojiType:e}),Jn("defaultEmojiType",e,2592e3)},e.prototype.changeShouldCompassImage=function(e){this.setState({shouldCompassImage:e})},e.prototype.message=function(e){this.setState({message:e},function(){var e=this;setTimeout(function(){e.setState({message:""})},2e3)})},e.prototype.clearExtendAndEmoji=function(){this.setState({extendTagName:""})},e.prototype.componentDidMount=function(){this.forceUpdate(),window.addEventListener("click",this.clearExtendAndEmoji)},e.prototype.componentWillUnmount=function(){window.removeEventListener("click",this.clearExtendAndEmoji)},e.prototype.componentWillReceiveProps=function(e){this.state.value!==e.value&&this.setState({value:e.value,selectionStart:e.value.length,selectionEnd:e.value.length})},e.prototype.render=function(){var r=this;return I.createElement("div",{className:"ubb-editor",style:{height:(this.props.option.height||20)+"rem"}},I.createElement(Ur,{changeValue:this.changeValue,changeExtendName:this.changeExtend,undo:this.customTextArea&&this.customTextArea.undo,redo:this.customTextArea&&this.customTextArea.redo,triggerIsPreviewing:this.triggerIsPreviewing,isPreviewing:this.state.isPreviewing}),I.createElement(Mr,{extendTagName:this.state.extendTagName,changeValue:this.changeValue,clearShown:this.clearExtendAndEmoji,extendIsShown:this.state.extendTagName&&"emoji"!==this.state.extendTagName,shouldCompassImage:this.state.shouldCompassImage,changeShouldCompassImage:this.changeShouldCompassImage}),this.state.isPreviewing?I.createElement("div",{className:"ubb-preview"},I.createElement(Ht,{code:this.state.value})):I.createElement(Pr,{value:this.state.value,onChange:this.onChange,ref:function(e){return r.customTextArea=e},onBlur:function(e){var t=e.target,n=t.selectionStart,a=t.selectionEnd;r.setState({selectionStart:n,selectionEnd:a})},onDrop:function(e){var t=e.dataTransfer.files;t&&r.handleUpload(t)},onPaste:function(e){if(e.clipboardData&&e.clipboardData.items){var t=Array.from(e.clipboardData.items).map(function(e){return e.kind}),n=e.clipboardData.files;t.some(function(e){return"file"===e})&&(e.preventDefault(),r.customTextArea.blur(),r.handleUpload(n,r.state.shouldCompassImage))}},onKeyDown:function(e){e.ctrlKey&&"Enter"===e.key&&r.props.option&&r.props.option.submit&&r.props.option.submit()}}),I.createElement(Rr,{message:this.state.message}),I.createElement("input",{style:{display:"none"},type:"file",id:"ubbFileUpload",multiple:!0,onChange:function(a){return x.b(r,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t=a.target,n=a.target.files,[4,this.handleUpload(n,this.state.shouldCompassImage)];case 1:return e.sent(),t.value="",[2]}})})}}),I.createElement(Dr,{changeValue:this.changeValue,emojiType:this.state.emojiType,changeEmojiType:this.changeEmojiType,emojiIsShown:"emoji"===this.state.extendTagName,height:this.props.option&&this.props.option.height&&this.props.option.height-2}))},e}(I.PureComponent),Lr=n(42),Fr=n(48),Br=n(45),Ar=n(41),_r=n(56),zr=n(494),Vr=Lr.a.Item,Hr=Ar.a.Option,Wr=Fr.a.Item,$r=_r.a.Group,Yr=["加粗","斜体"],qr=Lr.a.create()(function(t){function e(e){var s=t.call(this,e)||this;return s.onCreate=function(){s.props.form.validateFields(function(l,u){return x.b(s,void 0,void 0,function(){var t,n,a,r,s,o,i,c;return x.d(this,function(e){switch(e.label){case 0:if(l)return[2];switch(t=u.reason,n=parseInt(this.state.days),a="ok",this.state.current){case"1":return[3,1];case"2":return[3,6];case"3":return[3,11];case"4":return[3,13];case"5":return[3,15];case"6":return[3,17];case"7":return[3,22];case"8":return[3,27];case"9":return[3,32]}return[3,34];case 1:return 1!==this.props.topicInfo.state?[3,3]:[4,function(s,e,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="/topic/"+s+"/lock",a={reason:o},r=JSON.stringify(a),[4,Zn(n,{method:"DELETE",headers:t,body:r})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.topicInfo.id,this.props.boardId,t)];case 2:return a=e.sent(),[3,5];case 3:return[4,function(s,e,o,i){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="/topic/"+s+"/lock",a={reason:o,value:i},r=JSON.stringify(a),[4,Zn(n,{method:"PUT",headers:t,body:r})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.topicInfo.id,this.props.boardId,t,n)];case 4:a=e.sent(),e.label=5;case 5:return[3,34];case 6:return this.props.topicInfo.disableHot?[4,function(s,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="/topic/"+s+"/not-hot",a={reason:o},r=JSON.stringify(a),[4,Zn(n,{method:"DELETE",headers:t,body:r})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.topicInfo.id,t)]:[3,8];case 7:return a=e.sent(),[3,10];case 8:return[4,function(s,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="/topic/"+s+"/not-hot",a={reason:o},r=JSON.stringify(a),[4,Zn(n,{method:"PUT",headers:t,body:r})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.topicInfo.id,t)];case 9:a=e.sent(),e.label=10;case 10:return[3,34];case 11:return[4,function(s,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="/topic/"+s,a={reason:o},r=JSON.stringify(a),[4,Zn(n,{method:"DELETE",headers:t,body:r})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.topicInfo.id,t)];case 12:return a=e.sent(),[3,34];case 13:return[4,function(a,r,s){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t="/topic/"+a+"/moveto/"+r,[4,Xn()];case 1:return(n=e.sent()).append("Content-Type","application/json"),[4,Zn(t,{method:"PUT",headers:n,body:JSON.stringify({reason:s})})];case 2:return 200===e.sent().status?[2,"ok"]:[2,"error"]}})})}(this.props.topicInfo.id,this.state.childBoard,t)];case 14:return a=e.sent(),[3,34];case 15:return[4,function(s,e,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="/topic/"+s+"/up",a={reason:o},r=JSON.stringify(a),[4,Zn(n,{method:"PUT",headers:t,body:r})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.topicInfo.id,this.props.boardId,t)];case 16:return a=e.sent(),[3,34];case 17:return 2!==this.props.topicInfo.topState?[3,19]:[4,Ba(this.props.topicInfo.id,this.props.boardId,t)];case 18:return a=e.sent(),[3,21];case 19:return[4,Fa(this.props.topicInfo.id,this.props.boardId,2,n,t)];case 20:a=e.sent(),e.label=21;case 21:return[3,34];case 22:return 4!==this.props.topicInfo.topState?[3,24]:[4,Ba(this.props.topicInfo.id,this.props.boardId,t)];case 23:return a=e.sent(),[3,26];case 24:return[4,Fa(this.props.topicInfo.id,this.props.boardId,4,n,t)];case 25:a=e.sent(),e.label=26;case 26:return[3,34];case 27:return 1!==this.props.topicInfo.bestState?[3,29]:[4,function(s,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="/topic/"+s+"/best",a={reason:o},r=JSON.stringify(a),[4,Zn(n,{method:"DELETE",headers:t,body:r})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.topicInfo.id,t)];case 28:return a=e.sent(),[3,31];case 29:return[4,function(s,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="/topic/"+s+"/best",a={reason:o},r=JSON.stringify(a),[4,Zn(n,{method:"PUT",headers:t,body:r})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.topicInfo.id,t)];case 30:a=e.sent(),e.label=31;case 31:return[3,34];case 32:for(s=r=!1,o=0,i=this.state.checkedList;o<i.length;o++)"加粗"===(c=i[o])&&(r=!0),"斜体"===c&&(s=!0);return[4,function(s,o,i,c,l,u){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="/topic/"+s+"/highlight",a={isBold:o,isItalic:i,color:c,duration:l,reason:u},r=JSON.stringify(a),[4,Zn(n,{method:"PUT",headers:t,body:r})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.topicInfo.id,r,s,this.state.background,n,t)];case 33:return e.sent(),[3,34];case 34:return"ok"===a?(this.props.update(),this.props.onCancel()):alert("操作失败"),[2]}})})})},s.handleChangeComplete=function(e){s.setState({background:e.hex})},s.handleBoardChange=function(e){for(var t=e,n=0,a=s.state.boardsData;n<a.length;n++){var r=a[n];if(r.id==t){s.setState({childBoards:r.boards,childBoard:r.boards[0].name});break}}},s.onDaysChange=function(e){s.setState({days:e})},s.onChildBoardChange=function(e){s.setState({childBoard:e})},s.handleClick=function(e){s.setState({current:e.key})},s.onChange=function(e){s.setState({checkedList:e,indeterminate:!!e.length&&e.length<Yr.length,checkAll:e.length===Yr.length})},s.onCheckAllChange=function(e){s.setState({checkedList:e.target.checked?Yr:[],indeterminate:!1,checkAll:e.target.checked})},s.state={current:"1",option:"",childBoard:"似水流年",childBoards:[{name:"似水流年",id:758},{name:"心灵之约",id:182},{name:"论坛指南",id:184}],background:"#fff",checkedList:[],indeterminate:!0,checkAll:!1,days:0,boardsData:[]},s}return x.c(e,t),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return(t=localStorage.getItem("boardsInfo"))&&0!==t.indexOf("obj-")&&localStorage.removeItem("boardsInfo"),[4,Ma()];case 1:return n=e.sent(),this.setState({boardsData:n}),[2]}})})},e.prototype.render=function(){var e=this.state.boardsData,t=this.state.childBoards,n=e.map(function(e){return I.createElement(Hr,{key:e.id},e.name)}),a=this.state.childBoards.map(function(e){return 182!==e.id?I.createElement(Hr,{key:e.id},e.name):null}),r=null,s=this.props,o=s.visible,i=s.onCancel,c=this.props.form.getFieldDecorator,l=I.createElement(Lr.a,null,I.createElement(Vr,{label:"理由"},c("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Br.a,null)))),u=I.createElement(Lr.a,null,I.createElement(Vr,{label:"天数"},I.createElement(Ar.a,{value:this.state.days,onChange:this.onDaysChange},"1"===this.state.current?I.createElement(Hr,{key:"0"},"0"):null,I.createElement(Hr,{key:"7"},"7"),I.createElement(Hr,{key:"14"},"14"),I.createElement(Hr,{key:"30"},"30"),I.createElement(Hr,{key:"98"},"98"),I.createElement(Hr,{key:"1000"},"1000"))),I.createElement(Vr,{label:"理由"},c("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Br.a,null)))),m=I.createElement(Lr.a,null,I.createElement(Vr,{label:"理由"},c("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Br.a,null))),I.createElement(Vr,null,I.createElement(Ar.a,{defaultValue:0<e.length?e[0].name:"",style:{width:120},onChange:this.handleBoardChange},n),I.createElement(Ar.a,{defaultValue:0<t.length?t[0].name:"",style:{marginLeft:"2rem",width:120},onChange:this.onChildBoardChange,key:0<t.length?t[0].name:""},a))),p=I.createElement(Lr.a,null,I.createElement(Vr,null,I.createElement(_r.a,{indeterminate:this.state.indeterminate,onChange:this.onCheckAllChange,checked:this.state.checkAll},"Check all"),I.createElement($r,{options:Yr,value:this.state.checkedList,onChange:this.onChange})),I.createElement(Vr,{label:"天数"},I.createElement(Ar.a,{value:this.state.days,onChange:this.onDaysChange},"1"===this.state.current?I.createElement(Hr,{key:"0"},"0"):null,I.createElement(Hr,{key:"7"},"7"),I.createElement(Hr,{key:"14"},"14"),I.createElement(Hr,{key:"30"},"30"),I.createElement(Hr,{key:"98"},"98"),I.createElement(Hr,{key:"1000"},"1000"))),I.createElement(Vr,{label:"理由"},c("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Br.a,null))),I.createElement(Vr,{label:"颜色"},I.createElement(zr.SketchPicker,{color:this.state.background,onChangeComplete:this.handleChangeComplete})));switch(this.state.current){case"1":r=1===this.props.topicInfo.state?l:u;break;case"2":case"3":r=l;break;case"4":r=m;break;case"5":r=l;break;case"6":r=2===this.props.topicInfo.topState?l:u;break;case"7":r=4===this.props.topicInfo.topState?l:u;break;case"8":r=l;break;case"9":r=p}return I.createElement(Tn.a,{visible:o,title:"帖子管理",okText:"确认",cancelText:"取消",onOk:this.onCreate,onCancel:i,width:"50rem",maskClosable:!1},I.createElement(Fr.a,{onClick:this.handleClick,selectedKeys:[this.state.current],mode:"horizontal",style:{display:"flex",marginBottom:"1rem",justifyContent:"space-around"}},I.createElement(Wr,{key:"1"},1===this.props.topicInfo.state?"解锁":"锁定"),I.createElement(Wr,{key:"2"},this.props.topicInfo.disableHot?"允许热门":"禁止热门"),I.createElement(Wr,{key:"3"},"删除"),I.createElement(Wr,{key:"4"},"移动"),I.createElement(Wr,{key:"5"},"提升"),I.createElement(Wr,{key:"6"},2===this.props.topicInfo.topState?"取消固顶":"固顶"),I.createElement(Wr,{key:"7"},4===this.props.topicInfo.topState?"取消全站固顶":"全站固顶"),I.createElement(Wr,{key:"8"},1===this.props.topicInfo.bestState?"解除精华":"加精"),I.createElement(Wr,{key:"9"},"高亮")),r)},e}(I.Component)),Jr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={visible:!0,data:null,loading:!1},e.onClick=function(){return e.props.onClose()},e}return x.c(e,t),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return this.setState({loading:!0}),[4,mr(this.props.topicInfo.id,0)];case 1:return t=e.sent(),this.setState({data:t,loading:!1}),[2]}})})},e.prototype.render=function(){var e=this,r=this.props.topicInfo,t=this.state,n=t.visible,a=t.data,s=t.loading;return I.createElement(I.Fragment,null,I.createElement(Tn.a,{visible:n,title:"管理记录",okText:"确认",cancelText:"取消",onOk:this.onClick,onCancel:this.onClick,width:"50rem",maskClosable:!1,bodyStyle:{maxHeight:"20rem",overflowY:"auto"}},a&&I.createElement(Sn.a,{dataSource:a?a.data:[],pagination:{onChange:function(a){return x.b(e,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return this.setState({loading:!0}),t=7*(a-1),[4,mr(r.id,t)];case 1:return n=e.sent(),this.setState({data:n,loading:!1}),[2]}})})},pageSize:7,total:a.count},renderItem:function(e){return I.createElement(Sn.a.Item,{key:e.id},I.createElement(Sn.a.Item.Meta,{title:e.content,description:I.createElement("div",null,I.createElement("span",null,"对象:",e.targetUserName||"匿名"),I.createElement("span",{style:{marginLeft:"2rem",marginRight:"2rem"}},"时间:",Nn()(e.time).format("YYYY-MM-DD HH:mm:ss")))}),I.createElement("div",null," ",I.createElement("div",null,"操作人:",e.operatorUserName),I.createElement("div",null,"IP:",e.ip)))}},s&&I.createElement("div",{className:"demo-loading-container"},I.createElement(kn.a,null)))))},e}(I.Component),Gr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"noticeSuccess displaynone",id:this.props.id,style:{position:"fixed",top:this.props.top,left:this.props.left}},this.props.text)},t}(I.PureComponent),Qr=n(1242),Kr=n(139),Xr=n.n(Kr),Zr=n(178),es="";var ts={buttonContentBuilder:function(e){return I.createElement("div",null,I.createElement("label",{id:"upload-label",style:{cursor:"pointer",paddingBottom:"0.5rem",paddingTop:"0,5rem",paddingLeft:"1rem",paddingRight:"1rem"},htmlFor:"upload-files"},I.createElement("i",{className:"fa fa-image"})),I.createElement("input",{type:"file",id:"upload-files",style:{display:"none "},onChange:function(n){return x.b(void 0,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return t=n.target,[4,function(a,r){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Ta(a)];case 1:return es=e.sent(),t=r.editor,n="\n\n![]("+es+")\n\n",t.setValue(n),[2]}})})}(n,ts)];case 1:return e.sent(),t.value="",[2]}})})}}))},buttonProps:{handleSubmit:function(e){}},editor:null},ns=ts,as=n(1237),rs=as.a.Panel,ss=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={visible:!0},e.onClick=function(){return e.props.changeStatus()},e}return x.c(e,t),e.prototype.render=function(){var e=this.props.IPData,t=this.state.visible;return I.createElement(I.Fragment,null,I.createElement(Tn.a,{visible:t,title:"查看IP",okText:"确认",cancelText:"取消",onOk:this.onClick,onCancel:this.onClick,width:"50rem",maskClosable:!1,bodyStyle:{maxHeight:"20rem",overflowY:"auto"}},I.createElement(as.a,{defaultActiveKey:[]},e.map(function(e,t){return I.createElement(rs,{key:""+t,header:e.ip+" 共"+e.posts.length+"条"},e.posts.map(function(e){return I.createElement(I.Fragment,null,I.createElement("p",null,"用户名:",e.userName," 楼层:",e.floor),I.createElement("p",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},e.content))}))}))))},e}(I.Component),os=n(474),is=function(a){function e(e){var t=a.call(this,e)||this;t.handleValueChange=function(e){t.setState({mdeState:e})},t.showManageUI=function(e){t.setState({manageVisible:e})},t.handleCancel=function(){t.setState({manageVisible:!1})},t.showManageHistory=function(){t.setState({manageHistoryVisible:!0})},t.cachestr="post-cache-"+t.props.topicInfo.id,t.getCache=function(){t.setState({postCache:Gn(t.cachestr)})},t.cleancache=function(){Qn(t.cachestr),t.setState({postCache:""})},t.sendMdTopic=function(h){return x.b(t,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d;return x.d(this,function(e){switch(e.label){case 0:this.setState({buttonDisabled:!0,buttonInfo:"...",anonymouslyPostButtonInfo:"..."}),t="/topic/"+this.props.topicInfo.id+"/post",e.label=1;case 1:return e.trys.push([1,10,,11]),n=this.state.mdeState,a={content:n,contentType:1,title:"",isAnonymous:h},r=JSON.stringify(a),s=Gn("accessToken"),(o=new Headers).append("Authorization",s),o.append("Content-Type","application/json"),[4,Zn(t,{method:"POST",headers:o,body:r})];case 2:return 402!==(i=e.sent()).status?[3,3]:(this.cacheForPost(),sr("postNone"),this.setState({buttonDisabled:!1,buttonInfo:"回复",anonymouslyPostButtonInfo:"匿名回复"}),[3,9]);case 3:return 400!==i.status?[3,4]:(sr("noEnoughMoney"),this.setState({buttonDisabled:!1,buttonInfo:"回复",anonymouslyPostButtonInfo:"匿名回复"}),this.cacheForPost(),[3,9]);case 4:return 403!==i.status?[3,5]:(this.cacheForPost(),sr("postFast"),this.setState({buttonDisabled:!1,buttonInfo:"回复",anonymouslyPostButtonInfo:"匿名回复"}),[3,9]);case 5:return 200!==i.status?[3,9]:(c=ar(n))?[4,i.text()]:[3,8];case 6:return l=e.sent(),u=this.props.topicInfo.id,m=JSON.stringify(c),p="/notification/at?topicid="+u+"&postid="+l,(d=new Headers).append("Content-Type","application/json"),d.append("Authorization",s),[4,Zn(p,{method:"POST",headers:d,body:m})];case 7:e.sent(),e.label=8;case 8:Qn("temporaryContent"),this.props.onChange(),this.setState({buttonDisabled:!1,buttonInfo:"回复",anonymouslyPostButtonInfo:"匿名回复"}),e.label=9;case 9:return[3,11];case 10:return e.sent(),this.cacheForPost(),sr("other"),this.setState({buttonDisabled:!1,buttonInfo:"请刷新",anonymouslyPostButtonInfo:"请刷新"}),[3,11];case 11:return[2]}})})},t.postUbbContent=function(){t.sendUbbTopic(!1)},t.postAnonymousUbbContent=function(){(1===t.props.boardInfo.anonymousState||confirm("你真的要匿名吗？"))&&t.sendUbbTopic(!0)},t.postMdContent=function(){t.sendMdTopic(!1)},t.postAnonymousMdContent=function(){(1===t.props.boardInfo.anonymousState||confirm("你真的要匿名吗？"))&&t.sendMdTopic(!0)},t.showIP=function(){return x.b(t,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,function(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return t="/topic/"+r+"/look-ip",[4,Xn()];case 1:return n=e.sent(),[4,Zn(t,{headers:n})];case 2:return 200!==(a=e.sent()).status?[3,4]:[4,a.json()];case 3:return[2,e.sent()];case 4:return[2,[]]}})})}(this.props.topicInfo.id)];case 1:return t=e.sent(),this.setState({IPData:t}),[2]}})})},t.closeIP=function(){return t.setState({IPData:[]})},t.setValue=function(e){t.setState({mdeState:t.state.mdeState+e},function(){t.setState({mdeState:t.state.mdeState})})},t.sendUbbTopic=t.sendUbbTopic.bind(t),t.changeEditor=t.changeEditor.bind(t),t.showManagement=t.showManagement.bind(t),t.onChange=t.onChange.bind(t),t.close=t.close.bind(t),t.update=t.update.bind(t);var n="";return Gn("temporaryContent-"+t.props.topicInfo.id)&&(n=Gn("temporaryContent-"+t.props.topicInfo.id)),t.converter=new Zr.Converter({tables:!0,strikethrough:!0,simplifiedAutoLink:!0,extensions:[os]}),t.state={content:n,mode:0,masters:[],buttonDisabled:!1,buttonInfo:"回复",manageVisible:!1,mdeState:n,commands:[],IPData:[],postCache:"",anonymouslyPostButtonInfo:"匿名回复",manageHistoryVisible:!1,wealth:""},t}return x.c(e,a),e.prototype.update=function(e){this.setState({content:e})},e.prototype.onChange=function(){this.props.onChange()},e.prototype.showManagement=function(){this.setState({manageVisible:!0})},e.prototype.close=function(){var e="#manage"+this.props.topicInfo.id;Ee(e).css("display","none")},e.prototype.cacheForPost=function(){Jn(this.cachestr,this.state.content)},e.prototype.componentWillUnmount=function(){this.state.content?Jn("temporaryContent-"+this.props.topicInfo.id,this.state.content):this.state.mdeState?Jn("temporaryContent-"+this.props.topicInfo.id,this.state.mdeState):Qn("temporaryContent-"+this.props.topicInfo.id),window.onbeforeunload=null},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l=this;return x.d(this,function(e){switch(e.label){case 0:ns.editor=this,t=function(){return[{commands:[ns]}]},n=Kr.ReactMdeCommands.getDefaultCommands(),(a=n.concat(t()))[1].commands.length=3,this.setState({commands:a}),window.onbeforeunload=function(){return l.state.content?"您还有内容未发布，确认离开吗？":null},r=Cn(this.props.content.replyTime).format("YYYY-MM-DD HH:mm:ss"),s="/topic/"+this.props.topicInfo.id+"#"+this.props.content.floor,o=this.props.boardInfo.masters,this.props.content&&(1===this.state.mode?(i="> **以下是引用"+this.props.content.floor+"楼：用户"+this.props.content.userName+"在"+r+"的发言：**\n\n > "+this.props.content.content+"\n",this.setState({masters:o,content:i,mdeState:i})):(i="\n[quote][b]以下是引用"+this.props.content.floor+"楼：用户"+this.props.content.userName+"在"+r+"的发言：\n[color=blue][url="+s+"]>>查看原帖<<[/url][/color][/b]"+this.props.content.content+"[/quote]\n",this.setState({masters:o,content:i}))),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,pr()];case 2:return c=e.sent(),[3,4];case 3:return e.sent(),c="查询财富值余额失败，请前往个人中心查看",[3,4];case 4:return this.setState({wealth:c}),[2]}})})},e.prototype.componentWillReceiveProps=function(e){var t=Cn(e.content.replyTime).format("YYYY-MM-DD HH:mm:ss");if(e.content.userName)if(1===this.state.mode){var n=">**以下是引用"+e.content.floor+"楼：用户"+e.content.userName+"在"+t+"的发言：**\n"+e.content.content+"\n";this.setState({content:n,mdeState:n})}else{var a=e.content.floor,r=void 0,s=void 0;10<a?(r=parseInt(((a-1)/10).toString())+1,a%=10,s="/topic/"+this.props.topicInfo.id+"/"+r+"#"+(0===a?10:a)):s="/topic/"+this.props.topicInfo.id+"#"+e.content.floor;n="[quote][b]以下是引用"+e.content.floor+"楼：用户"+e.content.userName+"在"+t+"的发言：[color=blue][url="+s+"]>>查看原帖<<[/url][/color][/b]\n"+e.content.content+"[/quote]\n";this.setState({content:n})}else this.setState({content:"",mdeState:""})},e.prototype.sendUbbTopic=function(f){return x.b(this,void 0,void 0,function(){var a,r,s,o,i,c,l,u,m,p,d,h;return x.d(this,function(e){switch(e.label){case 0:this.setState({buttonDisabled:!0,buttonInfo:"...",anonymouslyPostButtonInfo:"..."}),a="/topic/"+this.props.topicInfo.id+"/post",e.label=1;case 1:return e.trys.push([1,11,,12]),t=this.state.content,n=new RegExp("[(quotex?)].*[/(quotex?)]"),r=t.match(n)&&t.match(n)[1]===t.match(n)[2]?{content:this.state.content,contentType:0,title:"",parentId:this.props.content.postId,isAnonymous:f}:{content:this.state.content,contentType:0,title:"",isAnonymous:f},s=JSON.stringify(r),[4,Kn()];case 2:return o=e.sent(),(i=new Headers).append("Authorization",o),i.append("Content-Type","application/json"),[4,Zn(a,{method:"POST",headers:i,body:s})];case 3:return 402!==(c=e.sent()).status?[3,4]:(sr("postNone"),this.setState({buttonDisabled:!1,buttonInfo:"回复",anonymouslyPostButtonInfo:"匿名回复"}),this.cacheForPost(),[3,10]);case 4:return 403!==c.status?[3,5]:(sr("postFast"),this.setState({buttonDisabled:!1,buttonInfo:"回复",anonymouslyPostButtonInfo:"匿名回复"}),this.cacheForPost(),[3,10]);case 5:return 400!==c.status?[3,6]:(sr("noEnoughMoney"),this.setState({buttonDisabled:!1,buttonInfo:"回复",anonymouslyPostButtonInfo:"匿名回复"}),this.cacheForPost(),[3,10]);case 6:return 200!==c.status?[3,10]:(l=ar(this.state.content))?[4,c.text()]:[3,9];case 7:return u=e.sent(),m=this.props.topicInfo.id,p=JSON.stringify(l),d="/notification/at?topicid="+m+"&postid="+u,(h=new Headers).append("Content-Type","application/json"),h.append("Authorization",o),[4,Zn(d,{method:"POST",headers:h,body:p})];case 8:e.sent(),e.label=9;case 9:Qn("temporaryContent-"+this.props.topicInfo.id),this.setState({buttonDisabled:!1,buttonInfo:"回复",anonymouslyPostButtonInfo:"匿名回复"}),this.props.onChange(),e.label=10;case 10:return[3,12];case 11:return e.sent(),this.cacheForPost(),sr("other"),this.setState({buttonDisabled:!1,buttonInfo:"请刷新",anonymouslyPostButtonInfo:"请刷新"}),[3,12];case 12:return[2]}var t,n})})},e.prototype.changeEditor=function(){0===this.state.mode?this.setState({mode:1}):this.setState({mode:0})},e.prototype.getInitialState=function(){return{value:""}},e.prototype.render=function(){var e,t=this,n=new Date,a=new Date(this.props.topicInfo.time),r=((n.getTime()-a.getTime())/1e3/60/60/24).toFixed(0),s=null;365<Number(r)&&(s=I.createElement("div",{className:"row",style:{color:"red"}},"提示：该贴发布于",r,"天前，如无必要请勿回复。"));var o,i,c=this.props.boardInfo.anonymousState;0===c?(o=I.createElement("button",{id:"post-topic-button",onClick:this.postUbbContent,disabled:this.state.buttonDisabled,className:"button blue"},this.state.buttonInfo),i=I.createElement("button",{id:"post-topic-button-md",onClick:this.postMdContent,disabled:this.state.buttonDisabled,className:"button blue"},this.state.buttonInfo)):1===c?(o=I.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},I.createElement("button",{id:"post-topic-button-anonymous",onClick:this.postAnonymousUbbContent,disabled:this.state.buttonDisabled,className:"button grey"},this.state.anonymouslyPostButtonInfo),I.createElement("p",null,"根据设置，你在本楼的回复都是匿名，并且不花费财富值。")),i=I.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},I.createElement("button",{id:"post-topic-button-md-anonymous",onClick:this.postAnonymousMdContent,disabled:this.state.buttonDisabled,className:"button grey"},this.state.anonymouslyPostButtonInfo),I.createElement("p",null,"根据设置，你在本楼的回复都是匿名，并且不花费财富值。"))):2===c&&(this.props.topicInfo.isAnonymous&&this.props.topicInfo.isMe?(o=I.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},I.createElement("button",{id:"post-topic-button-anonymous",onClick:this.postAnonymousUbbContent,disabled:this.state.buttonDisabled,className:"button grey"},this.state.anonymouslyPostButtonInfo),I.createElement("p",null,"根据设置，你在本楼的回复都是匿名，并且不花费财富值。")),i=I.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},I.createElement("button",{id:"post-topic-button-md-anonymous",onClick:this.postAnonymousMdContent,disabled:this.state.buttonDisabled,className:"button grey"},this.state.anonymouslyPostButtonInfo),I.createElement("p",null,"根据设置，你在本楼的回复都是匿名，并且不花费财富值。"))):(o=I.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},I.createElement("div",null,I.createElement("button",{id:"post-topic-button",onClick:this.postUbbContent,disabled:this.state.buttonDisabled,className:"button blue"},this.state.buttonInfo),I.createElement("button",{id:"post-topic-button-anonymous",onClick:this.postAnonymousUbbContent,disabled:this.state.buttonDisabled,className:"button grey"},this.state.anonymouslyPostButtonInfo)),I.createElement("p",null,"在本版面匿名回复每次需消耗2000财富值。你当前的财富值余额为：",this.state.wealth)),i=I.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},I.createElement("div",null,I.createElement("button",{id:"post-topic-button-md",onClick:this.postMdContent,disabled:this.state.buttonDisabled,className:"button blue"},this.state.buttonInfo),I.createElement("button",{id:"post-topic-button-md-anonymous",onClick:this.postAnonymousMdContent,disabled:this.state.buttonDisabled,className:"button grey"},this.state.anonymouslyPostButtonInfo)),I.createElement("p",null,"在本版面匿名回复每次需消耗2000财富值。你当前的财富值余额为：",this.state.wealth)))),0===this.state.mode?("使用UBB模式编辑",e=I.createElement("div",null,s,I.createElement(jr,{update:this.update,value:this.state.content,option:{height:20,submit:this.postUbbContent}}),I.createElement("div",{className:"row",style:{justifyContent:"center",marginBottom:"1.25rem "}},o))):("使用Markdown编辑",e=I.createElement("div",null,I.createElement("div",null,s,I.createElement(Xr.a,{value:this.state.mdeState,onChange:this.handleValueChange,generateMarkdownPreview:function(e){return t.converter.makeHtml(e),Promise.resolve(t.converter.makeHtml(e))},commands:this.state.commands,minEditorHeight:330,maxEditorHeight:500,buttonContentOptions:{iconProvider:function(e){return"heading"===e?I.createElement("i",{className:"fa fa-header"}):I.createElement("i",{className:"fa fa-"+e})}}})),I.createElement("div",{className:"row",style:{justifyContent:"center",marginTop:"5rem "}},i)));var l=null;Ha(this.props.boardInfo.boardMasters)&&(l=I.createElement("div",null,I.createElement(xn.a,{type:"primary",onClick:this.showManagement},"管理"),I.createElement(xn.a,{type:"primary",onClick:this.showIP,style:{marginLeft:"2rem"}},"查看IP"),I.createElement(xn.a,{type:"primary",onClick:this.showManageHistory,style:{marginLeft:"2rem"}},"管理记录")));var u=null;return Gn(this.cachestr)&&(u=I.createElement(I.Fragment,null,I.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},I.createElement("button",{id:"post-topic-cache-button",onClick:this.getCache,className:"button blue",style:{width:"12rem",height:"2rem",lineHeight:"0.8rem",marginBottom:"1rem"}},"获取本帖缓存的内容"),I.createElement("button",{id:"post-topic-cache-button-clean",onClick:this.cleancache,className:"button blue",style:{width:"4rem",height:"2rem",lineHeight:"0.8rem",marginBottom:"1rem"}},"清空")),I.createElement("input",{id:"cache-text",type:"text",style:{marginBottom:"1rem"},onChange:this.getCache,value:this.state.postCache}))),I.createElement("div",{id:"sendTopicInfo",style:{width:"100%",display:"flex",flexDirection:"column"}},I.createElement("div",{className:"row",style:{justifyContent:"flex-end"}},I.createElement("div",{id:"post-topic-changeMode",className:"changeEditor",onClick:this.changeEditor.bind(this),style:{width:"14rem",marginBottom:"0.5rem"}},1===this.state.mode?"切换到Ubb编辑器":"切换到Markdown编辑器")),e,u,l,this.state.manageVisible&&I.createElement(qr,{update:this.onChange,boardId:this.props.boardInfo.id,topicInfo:this.props.topicInfo,onCancel:this.handleCancel,visible:this.state.manageVisible}),this.state.manageHistoryVisible&&I.createElement(Jr,{topicInfo:this.props.topicInfo,onClose:function(){return t.setState({manageHistoryVisible:!1})},visible:this.state.manageHistoryVisible}),0!==this.state.IPData.length&&I.createElement(ss,{IPData:this.state.IPData,changeStatus:this.closeIP}),I.createElement(Gr,{text:"出现了意料之外的错误，请刷新重试，可读取之前的缓存",id:"other",top:"26%",left:"38%"}),I.createElement(Gr,{text:"回复失败, 10s之内仅可进行一次回帖，请耐心等待",id:"postFast",top:"26%",left:"38%"}),I.createElement(Gr,{text:"回复失败, 请输入内容",id:"postNone",top:"26%",left:"44%"}),I.createElement(Gr,{text:"你的财富值余额不足，匿名回复每次需要2000财富值",id:"noEnoughMoney",top:"26%",left:"38%"}),I.createElement(Gr,{text:"操作成功",id:"operationSuccess",top:"26%",left:"44%"}),I.createElement(Qr.a,{message:function(e){return-1!==(t.state.content&&e.pathname.indexOf(t.props.topicInfo.id))||"确定要离开吗？"}}))},e}(I.Component),cs=function(n){function e(e){var t=n.call(this,e)||this;return t.state={boardId:"",topicId:"",boardName:"",title:""},t}return x.c(e,n),e.prototype.componentDidMount=function(){this.setState({boardId:this.props.topicInfo.boardId,topicId:this.props.topicId,boardName:this.props.boardInfo.name,title:this.props.topicInfo.title})},e.prototype.componentWillReceiveProps=function(e){this.setState({boardId:e.topicInfo.boardId,topicId:e.topicId,boardName:e.boardInfo.name,title:e.topicInfo.title})},e.prototype.render=function(){var e="/board/"+this.state.boardId,t="/topic/"+this.state.topicId;return I.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:"/boardlist"},"版面列表"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:e},this.state.boardName),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:t},I.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"15rem",whiteSpace:"nowrap"}},this.state.title)," "))},e}(I.Component),ls=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.follow=n.follow.bind(n),n.unfollow=n.unfollow.bind(n),n.changeTraceMode=n.changeTraceMode.bind(n),n.state={traceMode:n.props.traceMode,buttonInfo:n.props.userInfo.isFollowing?"取关":"关注",buttonIsDisabled:!1,isFollowing:n.props.userInfo.isFollowing,fanCount:n.props.userInfo.fanCount,photoframe:null},n}return x.c(e,a),e.prototype.changeTraceMode=function(){this.setState({traceMode:!0!==this.state.traceMode})},e.prototype.unfollow=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),this.setState({buttonIsDisabled:!0,buttonInfo:"..."}),t=Gn("accessToken"),n=this.props.userInfo.id,a="/me/followee/"+n,(r=new Headers).append("Authorization",t),[4,Zn(a,{method:"DELETE",headers:r})];case 1:return 200!==e.sent().status?[3,3]:[4,Xa(this.props.userInfo.id,this.props.userInfo.name)];case 2:return e.sent(),this.setState({buttonIsDisabled:!1,buttonInfo:"关注",isFollowing:!1,fanCount:this.props.userInfo.fanCount}),[3,4];case 3:throw{};case 4:return[3,6];case 5:return e.sent(),alert("网络错误"),[3,6];case 6:return[2]}})})},e.prototype.follow=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),this.setState({buttonIsDisabled:!0,buttonInfo:"..."}),t=Gn("accessToken"),n=this.props.userInfo.id,a="/me/followee/"+n,(r=new Headers).append("Authorization",t),[4,Zn(a,{method:"PUT",headers:r})];case 1:return 200!==e.sent().status?[3,3]:[4,Xa(this.props.userInfo.id,this.props.userInfo.name)];case 2:return e.sent(),this.setState({buttonIsDisabled:!1,buttonInfo:"取关",isFollowing:!0,fanCount:this.props.userInfo.fanCount+1}),[3,4];case 3:throw{};case 4:return[3,6];case 5:return e.sent(),alert("网络错误"),[3,6];case 6:return[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t=this.props.userInfo.displayTitleId,[4,this.getPhotoFrame(t)];case 1:return n=e.sent(),this.setState({photoframe:n}),[2]}})})},e.prototype.getPhotoFrame=function(i){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return t="/user/id/"+this.props.userInfo.id,n=encodeURI(t),1!=this.props.isAnonymous?[3,1]:[2,I.createElement("div",{style:{width:"100%",justifyContent:"center",display:"flex",position:"relative"}},I.createElement("div",{style:{zIndex:100}},I.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl})))];case 1:return i?[4,fetch("/static/portrait.json")]:[3,4];case 2:return[4,e.sent().json()];case 3:switch(a=e.sent(),r=void 0,s=a.普通.style,i){case 82:s=a.吉祥物.style,r=a.吉祥物.imageUrl;break;case 18:case 22:s=a.版主.style,r=a.版主.imageUrl;break;case 85:case 29:s=a.编辑部.style,r=a.编辑部.imageUrl;break;case 37:case 23:s=a.技术组.style,r=a.技术组.imageUrl;break;case 28:case 16:s=a.贵宾.style,r=a.贵宾.imageUrl;break;case 84:case 34:s=a.策划部.style,r=a.策划部.imageUrl;break;case 96:case 99:s=a.影音部.style,r=a.影音部.imageUrl;break;case 32:case 21:s=a.站务组.style,r=a.站务组.imageUrl;break;case 86:case 35:s=a.体育部.style,r=a.体育部.imageUrl;break;case 94:case 93:s=a.办公室.style,r=a.办公室.imageUrl;break;case 91:s=a.认证用户.style,r=a.认证用户.imageUrl;break;default:r=a.普通.imageUrl}return o={},82!==i&&18!==i&&22!==i&&32!==i&&21!==i&&28!==i&&16!==i&&37!==i&&23!==i&&29!==i&&85!==i&&84!==i&&34!==i&&94!==i&&93!==i&&35!==i&&86!==i&&96!==i&&99!==i&&91!==i||(o={boxShadow:"0 0 0"}),[2,I.createElement("div",{style:{width:"100%",justifyContent:"center",display:"flex",position:"relative"}},I.createElement("div",{style:{zIndex:100}},I.createElement("a",{href:n,style:{display:"block",maxHeight:"5rem"}},I.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl,style:o,onError:this.handleImageErrored.bind(this)}))),I.createElement("div",{className:"photoFrame"},I.createElement("img",{src:r,style:s})))];case 4:return[2,I.createElement("div",{style:{width:"100%",justifyContent:"center",display:"flex",position:"relative"}},I.createElement("div",{style:{zIndex:100}},I.createElement("a",{href:n,style:{display:"block",maxHeight:"7.5rem"}},I.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl,onError:this.handleImageErrored.bind(this)}))))]}})})},e.prototype.handleImageErrored=function(t){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return t.preventDefault(),t.target.src="/static/images/default_avatar_boy.png",[2]})})},e.prototype.render=function(){if(!this.props.isAnonymous){var e="/user/id/"+this.props.userInfo.id,t=encodeURI(e);I.createElement("a",{href:t,style:{display:"block",maxHeight:"7.5rem"}},I.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl}))}1==this.props.isAnonymous&&I.createElement("div",{style:{display:"block",maxHeight:"7.5rem"}},I.createElement("img",{className:"userPortrait",src:this.props.userInfo.portraitUrl}));this.props.userInfo.id;var n=I.createElement("div",{style:{color:"#fff"},className:"userMessage-userName"},this.props.userInfo.name);if(!this.props.isAnonymous){e="/user/id/"+this.props.userInfo.id,t=encodeURI(e);n=I.createElement(It.a,{style:{color:"#fff"},className:"userMessage-userName",to:t},this.props.userInfo.name)}"匿名"!=this.props.userInfo.privilege&&"匿名用户"!==this.props.userInfo.privilege||(n=I.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},I.createElement("div",{style:{color:"white",fontSize:"1rem",fontWeight:"bold",marginLeft:"1rem",marginTop:"-0.8rem"}},this.props.userInfo.name),I.createElement("div",{className:"userMessageAnonymous"},"别问我是谁")));I.createElement("div",{style:{color:"red",marginLeft:"1rem"}},I.createElement("span",null,"最热回复"),I.createElement("span",null,"(第"),I.createElement("span",null,this.props.topicInfo.floor),I.createElement("span",null,"楼)")),I.createElement("div",{style:{marginLeft:"0.625rem"}},I.createElement("span",null,"第"),I.createElement("span",{style:{color:"red"}},this.props.topicInfo.floor),I.createElement("span",null,"楼"));var a,r=null;if(Gn("userInfo")&&Gn("userInfo").name!==this.props.userInfo.name&&!this.props.isAnonymous){var s="/message/message?id="+this.props.userInfo.id;r=I.createElement("div",{className:"row userMessageBtn"},I.createElement("div",{style:{marginLeft:"0.85rem"}},I.createElement("button",{className:"replierBtn",id:this.state.isFollowing?"":"follow",onClick:this.state.isFollowing?this.unfollow:this.follow,disabled:this.state.buttonIsDisabled},this.state.buttonInfo)),I.createElement("div",{style:{marginLeft:"0.5rem"}}," ",I.createElement(It.a,{to:s},I.createElement("button",{className:"replierBtn"},"私信"))))}var o=(new Date).getTime(),i=new Date(this.props.userInfo.lastLogOnTime).getTime(),c=parseInt((Math.abs(i-o)/1e3/60/60/24).toString()),l=parseInt((Math.abs(i-o)/1e3/60/60).toString()),u=this.state.fanCount;a=365<c?"一年前":30<c?"一月前":7<c?"一周前":1<c?c+"天前":1<l?l+"小时前":"1小时内";var m=null;this.props.isAnonymous||(m=I.createElement("div",{className:"column",style:{width:"60%",alignItems:"flex-start",paddingLeft:"1.5rem",marginTop:"1rem"}},I.createElement("div",{className:"userMessageOpt"},"帖数 ",this.props.userInfo.postCount),I.createElement("div",{className:"userMessageOpt"},"粉丝 ",u),I.createElement("div",{className:"userMessageOpt"},"威望 ",this.props.userInfo.prestige),I.createElement("div",{className:"userMessageOpt"},"风评 ",this.props.userInfo.popularity),I.createElement("div",{className:"userMessageOpt"},"最后登录 ",a)));var p=I.createElement("div",{className:"userGender"},0===this.props.userInfo.gender?I.createElement("i",{className:"fa fa-venus",style:{color:"#fff"}}):I.createElement("i",{className:"fa fa-mars",style:{color:"#fff"}}));return 1==this.props.isAnonymous&&(p=null),I.createElement("div",{className:"userMessage"},I.createElement("div",{className:"column userMessage-left"},n,m),I.createElement("div",{className:"column userMessage-right"},p,this.state.photoframe,r))},e}(Sr),us=function(n){function r(e){var t=n.call(this,e)||this;return e.voteInfo.myRecord?t.state={items:e.voteInfo.myRecord.items,message:"",messageOpacity:0,isVoting:!1}:t.state={items:[],message:"",messageOpacity:0,isVoting:!1},t.handleInputChange=t.handleInputChange.bind(t),t.submit=t.submit.bind(t),t.getMessage=t.getMessage.bind(t),t}return x.c(r,n),r.prototype.componentWillReceiveProps=function(e){e.voteInfo.myRecord?this.setState({items:e.voteInfo.myRecord.items}):this.setState({items:[]})},r.prototype.handleInputChange=function(a){this.setState(function(e){var t=e.items.indexOf(a);if(-1===t)return{items:[].concat(e.items,a)};var n=e.items;return n.splice(t,1),{items:n.slice()}})},r.prototype.submit=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r=this;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),this.setState({isVoting:!0}),[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),[4,Zn("/topic/"+this.props.voteInfo.topicId+"/vote",{method:"POST",headers:t,body:JSON.stringify({items:this.state.items})})];case 2:if(n=e.sent(),this.props.getInfo(),n.ok)throw new Error("投票成功");return[3,4];case 3:return a=e.sent(),this.setState({message:a.message,messageOpacity:1,isVoting:!1}),setTimeout(function(){r.setState({messageOpacity:0})},1e3),setTimeout(function(){r.setState({message:""})},1500),[3,4];case 4:return[2]}})})},r.prototype.getMessage=function(){switch(!0){case!ha():return I.createElement("p",null,"你还未登录，请先",I.createElement(It.a,{to:"/logOn"},"登陆"),"。");case this.props.voteInfo.canVote&&this.props.voteInfo.needVote:return I.createElement("p",null,"该投票在过期前，只有完成投票才能查看结果。你还未投过票，请先投票。");case!!this.props.voteInfo.myRecord:return I.createElement("p",null,"你已经投过票了，你的投票选项是：",this.props.voteInfo.myRecord.items.join("，"),"。");default:return null}},r.prototype.render=function(){var n=this,a=this.props.voteInfo.needVote&&!this.props.voteInfo.myRecord&&this.props.voteInfo.isAvailable;return Cr.getState().userInfo.currentUserInfo.id===this.props.topicInfo.userId&&(a=!1),I.createElement("div",{className:"vote-content"},I.createElement("div",{className:"vote-message",style:{opacity:this.state.messageOpacity}},this.state.message),this.props.voteInfo.voteItems.map(function(e,t){return I.createElement("div",{className:"vote-items",key:e.id},I.createElement("p",{className:"vote-description"},I.createElement("input",{disabled:!n.props.voteInfo.canVote||-1===n.state.items.indexOf(e.id)&&n.state.items.length===n.props.voteInfo.maxVoteCount,checked:-1!==n.state.items.indexOf(e.id),type:"checkbox",id:"vote"+e.id,onChange:function(){return n.handleInputChange(e.id)}}),I.createElement("label",{htmlFor:"vote"+e.id},e.description)),I.createElement("p",{className:"vote-bar"},I.createElement("span",{className:"vote-total"},I.createElement("span",{className:"vote-current",style:{backgroundColor:r.colors[t%5],width:20*e.count/(n.props.voteInfo.voteUserCount||1)+"rem"}})),a?null:I.createElement("span",{className:"vote-item-info"},e.count,"人/",(100*e.count/(n.props.voteInfo.voteUserCount||1)).toFixed(2),"%")))}),I.createElement("div",{className:"vote-info"},I.createElement("p",null,"投票过期时间：",Cn(this.props.voteInfo.expiredTime).format("YYYY年MM月DD日 HH:mm:ss")),I.createElement("p",null,"每人最多允许投",this.props.voteInfo.maxVoteCount,"票，已有",this.props.voteInfo.voteUserCount,"人参与投票。"),this.getMessage()),this.props.voteInfo.canVote?I.createElement("div",{className:"vote-buttons"},I.createElement("button",{className:"button blue",type:"button",onClick:this.submit,disabled:!this.state.items.length||this.state.isVoting},"投票"),I.createElement("button",{className:"button blue",type:"button",onClick:function(){return n.setState({items:[]})}},"重置")):null)},r.colors=["#ff0000","#ff8000","#22b14c","#00a2e8","#3f48cc"],r}(I.PureComponent),ms=n(235),ps=(n(362),n(384),n(178)),ds=n(474),hs=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.state={postId:n.props.postId,vote:null},n.getVote=n.getVote.bind(n),n}return x.c(e,a),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){return t="doc-content"+this.props.postId+"-"+this.props.floor,">"===(n=this.props.content.replace(/\n>[\s\S]*?\n\n/g,function(e){return e.replace(/\n[^\n](?!>)/g,function(e){return e.replace(/\n(?!>)/,"\n>")})}))[0]&&(n=-1===(a=n.indexOf("\n\n"))?n.replace(/\n[^\n](?!>)/g,function(e){return e.replace(/\n(?!>)/,"\n>")}):n.substr(0,a).replace(/\n[^\n](?!>)/g,function(e){return e.replace(/\n(?!>)/,"\n>")})+n.substr(a+1,n.length)),n=n.replace(/发言：\*\*\n/g,"发言：**\n\n"),(r=new ps.Converter({extensions:[ds]})).setOption("tables",!0),r.setOption("strikethrough",!0),s=r.makeHtml(n),document.getElementById(t)&&(document.getElementById(t).innerHTML=s),1===this.props.floor&&this.props.topicInfo.isVote&&!this.state.vote&&this.getVote(),[2]})})},e.prototype.getVote=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,Xn()];case 1:return t=e.sent(),[4,Zn("/topic/"+this.props.topicInfo.id+"/vote",{headers:t})];case 2:return[4,e.sent().json()];case 3:return n=e.sent(),this.setState({vote:n}),[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})})},e.prototype.render=function(){var e,t="doc-content"+this.props.postId+"-"+this.props.floor,n=function(t){try{var e=/@[^ \n]{1,10}?[ ]+/g,n=/[^@ ]+/;if(""===t)return t;if(t.match(e)){var a=t.match(e).length;10<a&&(a=10);for(var r=new Array,s=0;s<a;s++){var o=t.match(e)[s],i=n.exec(o)[0];r[s]=i}for(s=0;s<a;s++){var c=new RegExp("@"+r[s]+"[ ]","g");t=t.replace(c,'[url="/user/name/'+encodeURIComponent(r[s])+'"]@'+r[s]+" [/url]")}return t}return t}catch(e){return t}}(this.props.content),a=I.createElement(Ht,{code:n,options:x.a({},new Ce,{allowToolbox:!0})}),r=(function(e){try{var t=/@[^ \n]{1,10}?[ ]+/g,n=/[^@ ]+/;if(""===e)return;if(e.match(t)){var a=e.match(t).length;10<a&&(a=10);for(var r=new Array,s=0;s<a;s++){var o=e.match(t)[s],i=n.exec(o)[0];r[s]=i}for(s=0;s<a;s++){var c=new RegExp("@"+r[s]+" ","g");e=e.replace(c,"[@"+r[s]+" ](/user/name/"+r[s]+")")}return}}catch(e){return}}(this.props.content),I.createElement("div",{className:"markdown-container mde-preview"},I.createElement("div",{id:t,className:"mde-preview-content"})));return e=a,1===this.props.contentType&&(e=r),I.createElement("div",{className:"reply-content"},this.state.vote?I.createElement(us,{topicInfo:this.props.topicInfo,getInfo:this.getVote,voteInfo:this.state.vote}):null,I.createElement("div",{style:{alignSelf:"center",marginTop:"1rem",marginBottom:"-1rem"}},this.props.topicInfo.isAnonymous&&3<this.props.topicInfo.todayCount&&1===this.props.floor&&I.createElement(ms.a,null,"该用户今日在本版发布了",this.props.topicInfo.todayCount,"个主题帖")),I.createElement("div",{className:"substance"},e))},e}(I.Component),fs=n(498),gs=function(n){function e(e,t){return n.call(this,e,t)||this}return x.c(e,n),e.prototype.render=function(){var e=this;return this.props,I.createElement("div",{className:"good tagSize"},I.createElement("div",{className:"userImage"},I.createElement("img",{style:{cursor:"pointer"},onClick:function(){return e.props.history.push("/user/name/"+e.props.userName)},src:this.props.portraitUrl})," "),I.createElement("div",{className:"userName",style:{cursor:"pointer"},onClick:function(){return e.props.history.push("/user/name/"+e.props.userName)}},this.props.userName),I.createElement("div",{className:"grades"},this.props.content),I.createElement("div",{className:"credit"},I.createElement("span",null,this.props.reason)))},e}(I.Component),vs=Object(fs.a)(gs),bs=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.showAll=n.showAll.bind(n),n.hideAll=n.hideAll.bind(n),n.generateAwardInfo=n.generateAwardInfo.bind(n),n.state={info:[],shortInfo:[],count:0,showAll:!1},n}return x.c(e,a),e.prototype.hideAll=function(){this.setState({showAll:!1})},e.prototype.showAll=function(){this.setState({showAll:!0})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:for(o in t=[],(n=this.props.awardInfo)||(n=[]),a=[],r=[],n)a[o]=n[o].operatorName;return 0<n.length?[4,na(a)]:[3,2];case 1:r=e.sent(),e.label=2;case 2:for(o in n)s=ia(n[o].operatorName,r),n[o].portraitUrl=s.portraitUrl;if(10<n.length)for(o=0;o<10;o++)t[o]=this.generateAwardInfo(n[o]);return i=n.map(this.generateAwardInfo.bind(this)),this.setState({info:i,shortInfo:t,count:n.length}),[2]}})})},e.prototype.componentWillReceiveProps=function(c){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:for(s in t=[],(n=c.awardInfo)||(n=[]),a=[],r=[],n)a[s]=n[s].operatorName;return[4,na(a)];case 1:if(r=e.sent(),10<n.length)for(s=0;s<10;s++)o=ia(n[s].operatorName,r),n[s].portraitUrl=o.portraitUrl,n[s],t[s]=this.generateAwardInfo(n[s]);return i=n.map(this.generateAwardInfo.bind(this)),this.setState({info:i,shortInfo:t,count:n.length}),[2]}})})},e.prototype.generateAwardInfo=function(e){return I.createElement(vs,{postId:this.props.postId,topicId:e.id,portraitUrl:e.portraitUrl,content:e.content,reason:e.reason,userName:e.operatorName})},e.prototype.render=function(){var e="#awardInfo"+this.props.postId,t="awardInfo"+this.props.postId;$(e).css("display",""),this.state.info&&0!==this.state.info.length?this.state.info.length<10&&$(e).css("display",""):$(e).css("display","none");var n=I.createElement("button",{style:{border:"#eaeaea solid thin",cursor:"pointer"},onClick:this.state.showAll?this.hideAll:this.showAll},this.state.showAll?"收起":"显示全部");return I.createElement("div",{className:"column awardInfo",id:t},I.createElement("div",{className:"row",style:{width:"25rem",fontSize:"0.8rem",marginBottom:"0.2rem"}},I.createElement("div",{style:{marginLeft:"3.1rem"}},"用户"),I.createElement("div",{style:{marginLeft:"4.7rem"}},"操作"),I.createElement("div",{style:{marginLeft:"8.9rem"}},"理由")),10<this.state.count?this.state.showAll?this.state.info:this.state.shortInfo:this.state.info,10<this.state.count?n:null)},e}(I.Component),ys=n(160),Es=Lr.a.Item,Is=Ar.a.Option,ws=Lr.a.create()(function(t){function e(e){var o=t.call(this,e)||this;return o.handleChange=function(e){o.setState({option:e})},o.handleClick=function(e){o.setState({current:e.key})},o.onCreate=function(){o.state.current;var e=o.props.form,a=0,r="",s=null;e.validateFields(function(t,n){return x.b(o,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:if(t)return[2];switch(this.state.current){case"wealth":return[3,1];case"prestige":return[3,3];case"punishwealth":return[3,5];case"punishprestige":return[3,7];case"delete":return[3,9];case"tp":return[3,11];case"canceltp":return[3,13]}return[3,15];case 1:return a=parseInt(n.wealth),[4,function(o,i,c){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n={operationType:0,reason:o,wealth:i},a=JSON.stringify(n),r="/post/"+c+"/operation",i?[4,Zn(r,{method:"POST",headers:t,body:a})]:[3,8];case 2:switch((s=e.sent()).status){case 400:return[3,3];case 401:return[3,5];case 404:return[3,6];case 500:return[3,7]}return[3,8];case 3:return[4,s.text()];case 4:return"reward_wealth_limited"===e.sent()?[2,"limited"]:[2,"wrong input"];case 5:return[2,"unauthorized"];case 6:return[2,"not found"];case 7:return[2,"server error"];case 8:return[2,"ok"]}})})}(r=n.reason.toString(),a,this.props.item.id)];case 2:return s=e.sent(),[3,15];case 3:return a=parseInt(n.prestige),r=n.reason.toString(),[4,function(s,o,i){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n={operationType:0,prestige:o,reason:i},a="/post/"+s+"/operation",r=JSON.stringify(n),o?[4,Zn(a,{method:"POST",headers:t,body:r})]:[3,3];case 2:switch(e.sent().status){case 400:return[2,"wrong input"];case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}e.label=3;case 3:return[2,"ok"]}})})}(this.props.item.id,a,r)];case 4:return s=e.sent(),[3,15];case 5:return a=parseInt(n.wealth),[4,function(s,o,i){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n={operationType:1,reason:s,wealth:o},a=JSON.stringify(n),r="/post/"+i+"/operation",0==o?[3,3]:[4,Zn(r,{method:"POST",headers:t,body:a})];case 2:switch(e.sent().status){case 400:return[2,"wrong input"];case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}e.label=3;case 3:return[2,"ok"]}})})}(r=n.reason.toString(),a,this.props.item.id)];case 6:return s=e.sent(),[3,15];case 7:return a=parseInt(n.prestige),r=n.reason.toString(),[4,function(s,o,i){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n={operationType:1,prestige:o,reason:i},a="/post/"+s+"/operation",r=JSON.stringify(n),o?[4,Zn(a,{method:"POST",headers:t,body:r})]:[3,3];case 2:switch(e.sent().status){case 400:return[2,"wrong input"];case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}e.label=3;case 3:return[2,"ok"]}})})}(this.props.item.id,a,r)];case 8:return s=e.sent(),[3,15];case 9:return r=n.reason.toString(),[4,function(e,a,r){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n={reason:r},[4,Zn("/post/"+a,{method:"DELETE",headers:t,body:JSON.stringify(n)})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.item.topicId,this.props.item.id,r)];case 10:return s=e.sent(),[3,15];case 11:return r=n.reason.toString(),a=parseInt(n.days),[4,function(a,r,s){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n={operationType:1,reason:r,stopPostDays:s},[4,Zn("/post/"+a+"/operation",{method:"POST",headers:t,body:JSON.stringify(n)})];case 2:switch(e.sent().status){case 401:return[2,"unauthorized"];case 404:return[2,"not found"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.item.id,r,a)];case 12:return s=e.sent(),[3,15];case 13:return[4,La(this.props.item.userId,this.props.boardId)];case 14:return s=e.sent(),[3,15];case 15:return"ok"===s?(this.props.update(),this.props.onCancel()):alert(s),[2]}})})})},o.state={option:"",current:"wealth"},o}return x.c(e,t),e.prototype.render=function(){this.props.item.id;var e=this.props.form.getFieldDecorator,t=this.props,n=t.visible,a=t.onCancel,r=null,s=0;switch(s=this.props.m_wealth?this.props.m_wealth:"不限",this.state.current){case"wealth":r=I.createElement(Lr.a,{layout:"vertical"},I.createElement(ms.a,{color:"blue"},"您今天在",this.props.boardName,"已经发了",this.props.d_wealth,"财富值，最多可发",s," （单次最多1000）"),I.createElement(Es,{label:"财富值"},e("wealth",{rules:[{required:!0,message:"请输入财富值"}]})(I.createElement(ys.a,null))),I.createElement(Es,{label:"理由"},e("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Ar.a,{mode:"tags",style:{width:120},onChange:this.handleChange},I.createElement(Is,{value:"好文章"},"好文章"),I.createElement(Is,{value:"有用资源"},"有用资源"),I.createElement(Is,{value:"热心回复"},"热心回复")))));break;case"prestige":r=I.createElement(Lr.a,{layout:"vertical"},I.createElement(Es,{label:"威望"},e("prestige",{rules:[{required:!0,message:"请输入威望值"}]})(I.createElement(ys.a,null))),I.createElement(Es,{label:"理由"},e("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Ar.a,{mode:"tags",style:{width:120},onChange:this.handleChange},I.createElement(Is,{value:"好文章"},"好文章"),I.createElement(Is,{value:"有用资源"},"有用资源"),I.createElement(Is,{value:"热心回复"},"热心回复")))));break;case"punishwealth":r=I.createElement(Lr.a,{layout:"vertical"},I.createElement(Es,{label:"财富值"},e("wealth",{rules:[{required:!0,message:"请输入财富值"}]})(I.createElement(ys.a,null))),I.createElement(Es,{label:"理由"},e("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Ar.a,{mode:"tags",style:{width:120},onChange:this.handleChange},I.createElement(Is,{value:"人身攻击"},"人身攻击"),I.createElement(Is,{value:"违反版规"},"违反版规"),I.createElement(Is,{value:"恶意灌水"},"恶意灌水")))));break;case"punishprestige":r=I.createElement(Lr.a,{layout:"vertical"},I.createElement(Es,{label:"威望"},e("prestige",{rules:[{required:!0,message:"请输入威望值"}]})(I.createElement(ys.a,null))),I.createElement(Es,{label:"理由"},e("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Ar.a,{mode:"tags",defaultValue:"人身攻击",style:{width:120},onChange:this.handleChange},I.createElement(Is,{value:"人身攻击"},"人身攻击"),I.createElement(Is,{value:"违反版规"},"违反版规"),I.createElement(Is,{value:"恶意灌水"},"恶意灌水")))));break;case"delete":r=I.createElement(Lr.a,{layout:"vertical"},I.createElement(Es,{label:"理由"},e("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Br.a,null))));break;case"canceltp":r=I.createElement("div",null,"解除此用户版面 tp");break;case"tp":r=I.createElement(Lr.a,{layout:"vertical"},I.createElement(Es,{label:"天数"},e("days",{rules:[{required:!0,message:"请输入tp天数"}]})(I.createElement(ys.a,null))),I.createElement(Es,{label:"理由"},e("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Br.a,null))))}return I.createElement(Tn.a,{visible:n,title:"发言管理",okText:"确认",cancelText:"取消",onOk:this.onCreate,onCancel:a,width:"50rem"},I.createElement(Fr.a,{onClick:this.handleClick,selectedKeys:[this.state.current],mode:"horizontal",style:{marginBottom:"2rem"}},I.createElement(Fr.a.Item,{key:"wealth"},"奖励财富值"),I.createElement(Fr.a.Item,{key:"prestige"},"奖励威望"),I.createElement(Fr.a.Item,{key:"punishwealth"},"扣除财富值"),I.createElement(Fr.a.Item,{key:"punishprestige"},"扣除威望"),I.createElement(Fr.a.Item,{key:"delete"},"删除"),I.createElement(Fr.a.Item,{key:"tp"},"TP"),I.createElement(Fr.a.Item,{key:"canceltp"},"解除TP")),r)},e}(I.Component)),Cs=Lr.a.Item,Ns=Ar.a.Option,Ts=Fr.a.Item,Ss=Lr.a.create()(function(t){function e(e){var s=t.call(this,e)||this;return s.handleChange=function(e){s.setState({option:e})},s.onCreate=function(){var a="",r="";s.props.form.validateFields(function(t,n){return x.b(s,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:if(t)return[2];switch(this.setState({loading:!0}),r=n.reason.toString(),this.state.current,this.state.current){case"1":return[3,1];case"2":return[3,3];case"0":return[3,5]}return[3,6];case 1:return[4,function(e,s,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return t="/post/"+s+"/rating",[4,Xn()];case 1:return(n=e.sent()).append("Content-Type","application/json"),a={value:1,reason:o},r=JSON.stringify(a),[4,Zn(t,{method:"PUT",headers:n,body:r})];case 2:switch(e.sent().status){case 400:return[2,"rateself"];case 401:return[2,"not allowed"];case 403:return[2,"already"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.item.topicId,this.props.item.id,r)];case 2:return a=e.sent(),[3,6];case 3:return[4,function(e,s,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return t="/post/"+s+"/rating",[4,Xn()];case 1:return(n=e.sent()).append("Content-Type","application/json"),a={value:-1,reason:o},r=JSON.stringify(a),[4,Zn(t,{method:"PUT",headers:n,body:r})];case 2:switch(e.sent().status){case 400:return[2,"rateself"];case 401:return[2,"not allowed"];case 403:return[2,"already"];case 500:return[2,"server error"]}return[2,"ok"]}})})}(this.props.item.topicId,this.props.item.id,r)];case 4:return a=e.sent(),[3,6];case 5:return alert("请选择加风评还是扣风评。"),[3,6];case 6:return this.setState({loading:!1}),"ok"===a?(this.props.update(),this.props.onCancel()):"already"===a?alert("您今天已经评分过了，或者还未到500贴~"):"not allowed"===a?alert("您还没有资格评分~"):"rateself"===a&&alert("您不能给自己评分哦~"),[2]}})})})},s.handleClick=function(e){s.setState({current:e.key})},s.state={current:"0",option:"",loading:!1},s}return x.c(e,t),e.prototype.render=function(){var e=this.props,t=e.visible,n=e.onCancel,a=this.props.form.getFieldDecorator,r=I.createElement(Lr.a,null,I.createElement(Cs,{label:"理由"},a("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Ar.a,{mode:"tags",style:{width:400},onChange:this.handleChange},I.createElement(Ns,{value:"所言极是"},"所言极是"),I.createElement(Ns,{value:"好人一生平安"},"好人一生平安"),I.createElement(Ns,{value:"非常求是"},"非常求是"))))),s=I.createElement(Lr.a,null,I.createElement(Cs,{label:"理由"},a("reason",{rules:[{required:!0,message:"请输入理由"}]})(I.createElement(Ar.a,{mode:"tags",style:{width:400},onChange:this.handleChange},I.createElement(Ns,{value:"太不求是"},"太不求是"),I.createElement(Ns,{value:"呵呵"},"呵呵"),I.createElement(Ns,{value:"被你暴击"},"被你暴击"))))),o="1"===this.state.current?r:s;return I.createElement(Tn.a,{visible:t,title:"评分",okText:"确认",cancelText:"取消",onOk:this.onCreate,onCancel:n,confirmLoading:this.state.loading},I.createElement(Fr.a,{onClick:this.handleClick,selectedKeys:[this.state.current],mode:"horizontal",style:{display:"flex",marginBottom:"1rem",justifyContent:"space-around"}},I.createElement(Ts,{key:"1"},I.createElement("img",{style:{width:"2rem"},src:"/static/images/j-plus1.png"}),I.createElement("span",{style:{fontWeight:"bold",marginLeft:"10px",fontSize:"16px"}},"+1")),I.createElement(Ts,{disabled:!0},"|"),I.createElement(Ts,{key:"2"},I.createElement("img",{style:{width:"2rem"},src:"/static/images/j-minus1.png"}),I.createElement("span",{style:{fontWeight:"bold",marginLeft:"10px",fontSize:"16px"}},"-1"))),I.createElement(ms.a,{color:"blue"},"500贴以上的用户可以进行评分（每日一次）"),o)},e}(I.Component)),xs=function(n){function e(e){var t=n.call(this,e)||this;return t.follow=t.follow.bind(t),t.unFollow=t.unFollow.bind(t),t.state={tag1Name:"",tag2Name:"",isFollow:t.props.isFav},t}return x.c(e,n),e.prototype.showAllImg=function(){var e=document.getElementsByClassName("hiddenImage");for(var t in e){if(e.hasOwnProperty(t))e[t].click()}},e.prototype.follow=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return[4,function(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/me/favorite/"+n,{method:"PUT",headers:t})];case 2:return e.sent(),[2,"ok"]}})})}(this.props.topicInfo.id)];case 1:return e.sent(),this.setState({isFollow:!0}),[2]}})})},e.prototype.unFollow=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return[4,function(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/me/favorite/"+n,{method:"DELETE",headers:t})];case 2:return e.sent(),[2,"ok"]}})})}(this.props.topicInfo.id)];case 1:return e.sent(),this.setState({isFollow:!1}),[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return n=t="",this.props.tag1?[4,Ga(this.props.tag1)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return this.props.tag2?[4,Ga(this.props.tag2)]:[3,4];case 3:n=e.sent(),e.label=4;case 4:return this.setState({tag1Name:t,tag2Name:n}),[2]}})})},e.prototype.componentWillReceiveProps=function(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return n=t="",a.tag1?[4,Ga(a.tag1)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return a.tag2?[4,Ga(a.tag2)]:[3,4];case 3:n=e.sent(),e.label=4;case 4:return this.setState({tag1Name:t,tag2Name:n}),[2]}})})},e.prototype.onError=function(e){e.preventDefault(),e.target.src="/static/images/_CC98协会.png"},e.prototype.render=function(){var e=this.props.topicInfo.title||"",t=(this.props.boardInfo.name,"/board/"+this.props.boardInfo.id),n=null;return(this.props.tag1||this.props.tag2)&&(n=I.createElement("div",{id:"tags"},I.createElement("div",{className:"tagProp tagSize"},"标签： ",this.state.tag1Name," ",this.state.tag2Name),I.createElement("div",{className:"tagProp"}))),I.createElement("div",{className:"topicInfo-info"},I.createElement("div",{className:"topicInfo-title"},I.createElement("div",{className:"column",id:"topicTitleProp"},I.createElement("div",{id:"essay1",className:"row",title:65<e.length?e:void 0},e.length<=65?e:e.slice(0,65)+" ..."),I.createElement("div",{className:"row",id:"essayProp"},n,I.createElement("div",{id:"time"},I.createElement("div",{className:"viewProp"},I.createElement("i",{className:"fa fa-clock-o fa-lg fa-fw"}))," ",I.createElement("div",{className:"timeProp tagSize"},Cn(this.props.topicInfo.time).format("YYYY-MM-DD HH:mm:ss"))),I.createElement("div",{id:"viewtimes"},I.createElement("div",{className:"viewProp"},I.createElement("i",{className:"fa fa-eye fa-lg fa-fw"}),"  ")," ",I.createElement("div",{className:"timeProp tagSize"},this.props.topicInfo.hitCount)),I.createElement("div",{className:"followTopic",onClick:this.state.isFollow?this.unFollow:this.follow},this.state.isFollow?"已收藏":"收藏"),I.createElement("div",{className:"followTopic",style:{width:"6rem"},onClick:this.showAllImg},"显示所有图片"))),I.createElement("div",{className:"topicInfo-boardMessage"},I.createElement(It.a,{to:t},I.createElement("div",{style:{color:"#6b7178"}},this.props.boardInfo.name)),I.createElement("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem"}},this.props.boardInfo.todayCount," / ",this.props.boardInfo.topicCount))),I.createElement("div",{className:"topicInfo-ads"},I.createElement(bn,null)))},e}(I.Component),ks=I.createContext(function(e){}),Ps=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.handleQuoteContextChange=function(e){n.setState({quote:e})},n.quote=n.quote.bind(n),n.shouldRender=n.shouldRender.bind(n),n.handleChange=n.handleChange.bind(n),n.state={page:1,topicId:n.match.params.topicId,totalPage:1,postId:n.match.params.postId,topicInfo:{replyCount:0},boardInfo:{masters:[],id:7},content:"",shouldRender:!1,isFav:!1,quote:""},n}return x.c(e,a),e.prototype.quote=function(e,t,n,a,r){$("#sendTopicInfo").offset().top,this.state.page;this.state.page;this.props.history.push("#sendTopicInfo"),this.setState({quote:{content:e,userName:t,replyTime:n,floor:a,postId:r}})},e.prototype.handleChange=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return this.match.params.userId,t=this.match.params.postId,[4,_a(this.match.params.topicId)];case 1:return n=e.sent(),a=this.match.params.page?parseInt(this.match.params.page):1,[4,this.getTotalPage(this.state.topicInfo.replyCount,t)];case 2:return r=e.sent(),this.setState({page:a,topicId:this.match.params.topicId,totalPage:r,topicInfo:n}),[2]}})})},e.prototype.componentWillReceiveProps=function(i){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return(t=i.match.params.page?parseInt(i.match.params.page):1)==this.match.params.page?[3,5]:(i.match.params.userId,n=i.match.params.postId,[4,_a(this.match.params.topicId)]);case 1:return a=e.sent(),[4,za(a.boardId)];case 2:return r=e.sent(),[4,$a(i.match.params.topicId)];case 3:return s=e.sent(),[4,this.getTotalPage(this.match.params.topicId,n)];case 4:o=e.sent(),this.setState({page:t,topicId:i.match.params.topicId,totalPage:o,postId:i.match.params.postId,topicInfo:a,boardInfo:r,isFav:s}),e.label=5;case 5:return[2]}})})},e.prototype.shouldRender=function(e){e?this.setState({shouldRender:!0}):this.setState({shouldRender:!1})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return t=this.match.params.postId,n=this.match.params.page?parseInt(this.match.params.page):1,[4,_a(this.match.params.topicId)];case 1:return a=e.sent(),[4,za(a.boardId)];case 2:return r=e.sent(),[4,this.getTotalPage.bind(this)(this.match.params.topicId,t)];case 3:return s=e.sent(),this.setState({page:n,topicId:this.match.params.topicId,totalPage:s,topicInfo:a,boardInfo:r}),[2]}})})},e.prototype.getTotalPage=function(n,a){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,_a(n)];case 1:return t=e.sent(),t.isAnonymous?[4,wa(n,a)]:[3,3];case 2:return[2,e.sent()];case 3:return[4,wa(n,a)];case 4:return[2,e.sent()]}})})},e.prototype.render=function(){var e="/topic/"+this.match.params.topicId+"/postId/"+this.match.params.postId+"/";this.state.topicId;return I.createElement("div",{className:"center",style:{width:"1140px"}},I.createElement("div",{className:"row",style:{width:"100%",justifyContent:"space-between",alignItems:"center"}},I.createElement(cs,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,topicId:this.match.params.topicId}),I.createElement(Jt,{page:this.state.page,url:e,totalPage:this.state.totalPage})),I.createElement(xs,{topicInfo:this.state.topicInfo,tag1:this.state.topicInfo.tag1,tag2:this.state.topicInfo.tag2,boardInfo:this.state.boardInfo,isFav:this.state.isFav}),I.createElement(ks.Provider,{value:this.handleQuoteContextChange},I.createElement(Ms,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,page:this.state.page,postId:this.state.postId,quote:this.quote,isTrace:!0,isHot:!1,topicId:this.match.params.topicId})),I.createElement("div",{className:"row",style:{width:"100%",justifyContent:"space-between",alignItems:"center",marginTop:"1rem"}},I.createElement(cs,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,topicId:this.match.params.topicId}),I.createElement(Jt,{page:this.state.page,url:e,totalPage:this.state.totalPage})),I.createElement(is,{onChange:this.handleChange,boardInfo:this.state.boardInfo,content:this.state.quote,topicInfo:this.state.topicInfo}))},e}(Sr),Us=Object(Tr.a)(function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.showManageUI=function(){n.props.changePmVisible(!0,n.props.postInfo)},n.showJudgeUI=function(){n.props.changeJudgeVisible(!0,n.props.postInfo)},n.handlePosition=function(){n.props.page;n.props.page;n.props.history.push("#sendTopicInfo")},n.showManageUI=n.showManageUI.bind(n),n.showJudgeUI=n.showJudgeUI.bind(n),n.quote=n.quote.bind(n),n.edit=n.edit.bind(n),n.state={likeNumber:n.props.likeInfo.likeCount,dislikeNumber:n.props.likeInfo.dislikeCount,likeState:n.props.likeInfo.likeState},n}return x.c(e,a),e.prototype.quote=function(){this.props.quote(this.props.postInfo.content,this.props.userInfo.name,this.props.postInfo.time,this.props.postInfo.floor,this.props.postInfo.id)},e.prototype.edit=function(){},e.prototype.isAllowedtoEdit=function(e){return!!Gn("userInfo")&&("管理员"===Gn("userInfo").privilege||"管理员"!==e&&(!!Ha(this.props.boardInfo.boardMasters)||void 0))},e.prototype.like=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return"#like"+this.props.postInfo.id,"#dislike"+this.props.postInfo.id,[4,function(e,n,t){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),[4,Zn("/post/"+n+"/like",{method:"PUT",headers:t,body:"1"})];case 2:return[2,e.sent().status];case 3:return e.sent(),[3,4];case 4:return[2]}})})}(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 1:switch(t=e.sent(),t){case 200:return[3,2];case 401:return[3,4];case 403:return[3,5]}return[3,6];case 2:return[4,Ea(this.props.topicInfo.id,this.props.postInfo.id)];case 3:return n=e.sent(),this.setState({likeNumber:n.likeCount,dislikeNumber:n.dislikeCount,likeState:n.likeState}),[3,6];case 4:return sr("notLogOn"),[3,6];case 5:return sr("tooFast"),[3,6];case 6:return[2]}})})},e.prototype.dislike=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return"#like"+this.props.postInfo.id,"#dislike"+this.props.postInfo.id,[4,function(e,n,t){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),[4,Zn("/post/"+n+"/like",{method:"PUT",headers:t,body:"2"})];case 2:return[2,e.sent().status];case 3:return e.sent(),[3,4];case 4:return[2]}})})}(this.props.topicInfo.id,this.props.postInfo.id,this.context.router)];case 1:switch(t=e.sent(),t){case 200:return[3,2];case 401:return[3,4];case 403:return[3,5]}return[3,6];case 2:return[4,Ea(this.props.topicInfo.id,this.props.postInfo.id)];case 3:return n=e.sent(),this.setState({likeNumber:n.likeCount,dislikeNumber:n.dislikeCount,likeState:n.likeState}),[3,6];case 4:return sr("notLogOn"),[3,6];case 5:return sr("tooFast"),[3,6];case 6:return[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){return t="#icon"+this.props.postInfo.id,(Ha(this.props.boardInfo.boardMasters)||144==this.props.boardInfo.id&&this.props.postInfo.isLZ)&&$(t).css("display",""),[2]})})},e.prototype.render=function(){var t=this,e="icon"+this.props.postInfo.id,n="like"+this.props.postInfo.id,a="dislike"+this.props.postInfo.id,r=I.createElement("div",{className:"signature"},I.createElement(Ht,{isSignature:!0,code:this.props.userInfo.signatureCode,options:x.a({},new Ce,{allowExternalImage:!1,allowMarkDown:!1,maxImageCount:1})}));this.props.userInfo.signatureCode||(r=null);var s=null,o="/editor/edit/"+this.props.postInfo.id;Gn("userInfo")&&(this.isAllowedtoEdit(this.props.userInfo.privilege)||this.props.postInfo.isMe)&&(s=I.createElement(It.a,{to:o},I.createElement("div",{className:"operation1",onClick:this.edit},"   编辑")));var i=null;if(this.props.postInfo.lastUpdateAuthor&&this.props.postInfo.lastUpdateTime){var c=Cn(this.props.postInfo.lastUpdateTime).format("YYYY-MM-DD HH:mm:ss");i="该帖最后由 "+(this.props.userInfo.name===this.props.postInfo.lastUpdateAuthor?"作者":this.props.postInfo.lastUpdateAuthor)+" 在 "+c+" 编辑"}var l="/topic/"+this.props.topicInfo.id,u="/topic/"+this.props.topicInfo.id+"/postid/"+this.props.postInfo.id,m=I.createElement("div",{className:"operation1"},I.createElement(It.a,{to:this.props.traceMode?l:u},this.props.traceMode?"返回":"追踪")),p=null;(1==Ha(this.props.boardInfo.boardMasters)||144===this.props.boardInfo.id&&Gn("userInfo")&&Gn("userInfo").name===this.props.topicInfo.userName)&&(p=I.createElement("div",{className:"operation1",id:e,style:{cursor:"pointer"},onClick:this.showManageUI},"管理"));var d=I.createElement("div",{className:"operation1",onClick:this.showJudgeUI},"   评分");return I.createElement("div",{className:"column",style:{marginTop:"1rem",width:"52rem",marginBottom:"0.5rem"}},I.createElement("div",{className:"comment1"},I.createElement("div",{style:{width:"40rem",marginLeft:"1.2rem",fontSize:"0.8rem"}},I.createElement("span",null,"发表于 ",Cn(this.props.postInfo.time).format("YYYY-MM-DD HH:mm:ss")),I.createElement("span",{style:{marginLeft:"1rem"}},i)),I.createElement("div",{className:"row",style:{alignItems:"center"}},I.createElement("div",{id:n,className:1===this.state.likeState?"upup red-color":"upup",style:{marginRight:"0.7rem"},onClick:this.like.bind(this)},I.createElement("i",{title:"赞",className:1===this.state.likeState?"fa fa-thumbs-up fa-lg":"fa fa-thumbs-o-up fa-lg"}),I.createElement("span",{className:"commentProp"}," ",this.state.likeNumber)),I.createElement("div",{id:a,className:2===this.state.likeState?"downdown red-color":"downdown",onClick:this.dislike.bind(this)},I.createElement("i",{title:"踩",className:2===this.state.likeState?"fa fa-thumbs-down fa-lg":"fa fa-thumbs-o-down fa-lg"}),I.createElement("span",{className:"commentProp"}," ",this.state.dislikeNumber)),I.createElement("div",{id:"commentlike"},d,-1===window.location.pathname.indexOf("postid")?I.createElement(Os.Consumer,null,function(e){return I.createElement("div",{className:"operation1",onClick:function(){e({content:t.props.postInfo.content,userName:t.props.userInfo.name,replyTime:t.props.postInfo.time,floor:t.props.postInfo.floor,postId:t.props.postInfo.id}),t.handlePosition()}},"   引用")}):I.createElement(ks.Consumer,null,function(e){return I.createElement("div",{className:"operation1",onClick:function(){e({content:t.props.postInfo.content,userName:t.props.userInfo.name,replyTime:t.props.postInfo.time,floor:t.props.postInfo.floor,postId:t.props.postInfo.id}),t.handlePosition()}},"   引用")}),m,s,p))),I.createElement("div",{className:"row",style:{width:"100%",justifyContent:"center"}},"  ",r),I.createElement(Gr,{text:"你的操作太快了，慢慢来。",id:"tooFast",top:"33%",left:"40%"}),I.createElement(Gr,{text:"未登录或者登录状态异常，请先登录。",id:"notLogOn",top:"33%",left:"40%"}))},e}(I.Component)),Ms=function(a){function o(e,t){var n=a.call(this,e,t)||this;return n.showPm=function(e,t){n.setState({pmVisible:e,item:t})},n.showJudge=function(e,t){n.setState({judgeVisible:e,item:t})},n.handleCancel=function(){n.setState({pmVisible:!1})},n.handleJudgeCancel=function(){n.setState({judgeVisible:!1})},n.update=n.update.bind(n),n.quote=n.quote.bind(n),n.state={inWaiting:!0,contents:[],masters:[],boardName:"",m_wealth:2e4,d_wealth:0,pmVisible:!1,item:{},judgeVisible:!1},n}return x.c(o,a),o.prototype.quote=function(e,t,n,a,r){this.props.quote(e,t,n,a,r)},o.prototype.update=function(){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return t=this.props.page||1,this.props.isHot?[4,la(this.props.topicId)]:[3,2];case 1:return n=e.sent(),[3,6];case 2:return this.props.isTrace?[4,function(m,p,d){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),[4,sa(m)];case 1:return e.sent(),t=void 0,t=10*(p-1),[4,Kn()];case 2:return n=e.sent(),(a=new Headers).append("Authorization",n),[4,Zn("/Post/topic/user?topicid="+m+"&userId="+d+"&from="+t+"&size=10",{headers:a})];case 3:return[4,e.sent().json()];case 4:return r=e.sent(),s=[],o=r.length,r[0].count,[4,ta(r[0].userId)];case 5:for(i=e.sent(),c=0;c<o;c++)1!=r[c].isAnonymous?s[c]=x.a({},r[c],{userInfo:i,postId:r[c].id}):(l="匿名"+r[c].userName.toUpperCase(),u={name:l,portraitUrl:"/static/images/_心灵之约.png",id:null,privilege:"匿名用户",popularity:0,signatureCode:null,postCount:0},s[c]=x.a({},r[c],{userInfo:u}));return[2,s];case 6:return e.sent(),[3,7];case 7:return[2]}})})}(this.props.topicId,t,this.props.postId)]:[3,4];case 3:return n=e.sent(),[3,6];case 4:return[4,ca(this.props.topicId,t)];case 5:n=e.sent(),e.label=6;case 6:return a={rewardMaxValue:0,rewardTotalValue:0,boardName:this.props.boardInfo.name},Ha(this.props.boardInfo.boardMasters)?[4,ir(this.props.boardInfo.id)]:[3,8];case 7:a=e.sent(),e.label=8;case 8:return this.setState({m_wealth:a.rewardMaxValue,d_wealth:a.rewardTotalValue,boardName:a.boardName,contents:n}),[2]}})})},o.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return t=this.props.page||1,this.props.isHot?[4,la(this.props.topicId)]:[3,2];case 1:return(n=e.sent())||this.setState({inWaiting:!1,contents:[]}),[3,6];case 2:return this.props.isTrace?[3,4]:[4,ca(this.props.topicId,t)];case 3:return(n=e.sent())||this.setState({inWaiting:!1,contents:[]}),[3,6];case 4:return[4,Ca(this.props.topicId,this.props.postId,t)];case 5:n=e.sent(),e.label=6;case 6:return a=this.props.boardInfo.boardMasters,r={rewardMaxValue:2e4,rewardTotalValue:0,boardName:this.props.boardInfo.name},Ha(this.props.boardInfo.boardMasters)?[4,ir(this.props.boardInfo.id)]:[3,8];case 7:r=e.sent(),e.label=8;case 8:return this.setState({m_wealth:r.rewardMaxValue,d_wealth:r.rewardTotalValue,boardName:r.boardName,inWaiting:!1,contents:n,masters:a}),[2]}})})},o.prototype.componentWillReceiveProps=function(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return this.props.page,a.page,a.page===this.props.page&&a.topicInfo.replyCount===this.props.topicInfo.replyCount?[3,7]:(this.setState({inWaiting:!0}),t=a.page||1,n=void 0,a.isHot?[4,la(a.topicId)]:[3,2]);case 1:return(n=e.sent())||this.setState({inWaiting:!1,contents:[]}),[3,6];case 2:return a.isTrace?[4,Ca(this.props.topicId,this.props.postId,t)]:[3,4];case 3:return n=e.sent(),[3,6];case 4:return[4,ca(a.topicId,t)];case 5:(n=e.sent())||this.setState({inWaiting:!1,contents:[]}),e.label=6;case 6:this.setState({inWaiting:!1,contents:n}),e.label=7;case 7:return[2]}})})},o.prototype.generateContents=function(e){var t=e.floor%10,n={likeCount:e.likeCount,dislikeCount:e.dislikeCount,likeState:e.likeState},a=null,r=I.createElement(bs,{key:Date.now(),postId:e.postId,updateTime:Date.now(),awardInfo:e.awards});if(e.awards&&0!==e.awards.length||(r=null),1!==e.floor||this.props.isTrace){var s=t.toString();return this.props.isHot&&(s="hot_"+t),I.createElement("div",{className:"reply",key:s,id:s},I.createElement(ls,{key:e.postId,isAnonymous:e.isAnonymous,topicInfo:this.props.topicInfo,userInfo:e.userInfo,traceMode:!!this.props.isTrace,isHot:!!this.props.isHot}),I.createElement("div",{className:"column",style:{justifyContent:"space-between",width:"55.5rem",position:"relative"}},I.createElement(hs,{floor:e.floor,topicInfo:this.props.topicInfo,key:e.content,postId:e.postId,content:e.content,contentType:e.contentType}),r,I.createElement(Us,{userInfo:e.userInfo,quote:this.quote,boardInfo:this.props.boardInfo,postInfo:e,likeInfo:n,traceMode:!!this.props.isTrace,topicInfo:this.props.topicInfo,changePmVisible:this.showPm,changeJudgeVisible:this.showJudge,page:this.props.page})),I.createElement("div",{style:{display:"flex",flexDirection:"column"}},I.createElement(Rs,{isHot:this.props.isHot,floor:e.floor}),e.isLZ&&I.createElement(Rs,{isHot:!1,floor:-1})))}return a=I.createElement(o,{topicInfo:this.props.topicInfo,page:this.props.page,boardInfo:this.props.boardInfo,quote:this.quote,isTrace:!1,isHot:!0,postId:null,topicId:this.props.topicId}),I.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},I.createElement("div",{className:"reply",key:t.toString(),id:t.toString()},I.createElement(ls,{key:e.postId,isAnonymous:e.isAnonymous,topicInfo:this.props.topicInfo,userInfo:e.userInfo,traceMode:!!this.props.isTrace,isHot:!!this.props.isHot}),I.createElement("div",{className:"column",style:{justifyContent:"space-between",width:"55.5rem",position:"relative"}},I.createElement(hs,{floor:e.floor,topicInfo:this.props.topicInfo,key:e.content,postId:e.postId,content:e.content,contentType:e.contentType}),r,I.createElement(Us,{userInfo:e.userInfo,quote:this.quote,boardInfo:this.props.boardInfo,postInfo:e,likeInfo:n,traceMode:!!this.props.isTrace,topicInfo:this.props.topicInfo,changePmVisible:this.showPm,changeJudgeVisible:this.showJudge})),I.createElement(Rs,{isHot:this.props.isHot,floor:e.floor})),a)},o.prototype.componentDidUpdate=function(){if(window.location.hash&&"#"!==window.location.hash){var e=window.location.hash.split("#")[1];if("10"===e&&(e="0"),document.getElementById(e)){var t=document.getElementById(e).offsetTop,n=document.getElementById(e).clientHeight,a=(window.innerHeight-n)/2;Ee(document).scrollTop(t-a)}}},o.prototype.render=function(){var e=null;return Gn("userInfo")&&(e=Gn("userInfo").privilege),this.props.isHot&&this.state.inWaiting?null:this.state.inWaiting?I.createElement(kn.a,{style:{marginTop:"4rem"},size:"large"}):this.state.contents&&this.state.contents.length?I.createElement("div",{className:"center",style:{width:"71rem",marginRight:"1px"}},this.state.contents.map(this.generateContents.bind(this)),this.state.pmVisible&&I.createElement(ws,{m_wealth:this.state.m_wealth,d_wealth:this.state.d_wealth,boardName:this.state.boardName,update:this.update,privilege:e,boardId:this.props.boardInfo.id,item:this.state.item,visible:this.state.pmVisible,onCancel:this.handleCancel}),I.createElement(Ss,{item:this.state.item,update:this.update,onCancel:this.handleJudgeCancel,visible:this.state.judgeVisible})):I.createElement("div",null)},o}(I.Component),Rs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return this.props.isHot?I.createElement("div",{style:{backgroundColor:"#FF4040"},className:"reply-floor"},I.createElement("img",{style:{width:"20px",height:"30px"},src:"/static/images/hot.png"})):9999<this.props.floor?I.createElement("div",{className:"reply-floor-small"},this.props.floor):this.props.floor<0?I.createElement("div",{className:"reply-floor-lz"},"楼主"):I.createElement("div",{className:"reply-floor"},this.props.floor)},t}(I.Component),Os=I.createContext(function(e){}),Ds=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.handleQuoteContextChange=function(e){n.setState({quote:e})},n.update=n.update.bind(n),n.handleChange=n.handleChange.bind(n),n.quote=n.quote.bind(n),n.state={page:1,shouldRender:!0,topicid:n.match.params.topicid,totalPage:1,userName:null,boardId:7,topicInfo:{replyCount:0},boardInfo:{masters:[],id:7},fetchState:"ok",quote:"",isFav:!1,IPData:[]},n}return x.c(e,a),e.prototype.quote=function(e,t,n,a,r){Ee("#sendTopicInfo").offset().top;var s=this.state.page;this.state.page||(s=1);var o="/topic/"+this.state.topicid+"/"+s+"#sendTopicInfo";this.props.history.push(o),this.setState({quote:{content:e,userName:t,replyTime:n,floor:a,postId:r}})},e.prototype.update=function(){this.setState({})},e.prototype.handleChange=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:return t=this.match.params.page?parseInt(this.match.params.page):1,[4,_a(this.match.params.topicid)];case 1:return n=e.sent(),this.setState({topicInfo:n}),a=(n.replyCount+1)%10==0?(n.replyCount+1)/10:(n.replyCount+1-(n.replyCount+1)%10)/10+1,[4,this.getTotalPage(n.replyCount)];case 2:return e.sent(),this.match.params.userName,r=(n.replyCount+1)%10,s=Gn("noticeSetting"),t!=a?s&&"是"===s.post||a==t+1&&1==r?((t=a)||(t=1),i="/topic/"+n.id+"/"+t+"#"+r,this.setState({quote:{userName:"",content:"",replyTime:"",floor:""}},this.props.history.push(i))):(i="/topic/"+n.id+"/"+t,this.state.quote&&this.state.quote.floor&&(o=this.state.quote.floor%10,t||(t=1),i="/topic/"+n.id+"/"+t+"#"+o,this.setState({quote:{userName:"",content:"",replyTime:"",floor:""}},this.props.history.push(i)))):((t=a)||(t=1),i="/topic/"+n.id+"/"+t+"#"+r,this.setState({quote:{userName:"",content:"",replyTime:"",floor:""}},this.props.history.push(i))),sr("replyMessage"),[2]}})})},e.prototype.componentWillReceiveProps=function(u){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l;return x.d(this,function(e){switch(e.label){case 0:return t=u.match.params.page?parseInt(u.match.params.page):1,n=u.match.params.userName,[4,_a(u.match.params.topicid)];case 1:return a=e.sent(),[4,za(r=a.boardId)];case 2:return s=e.sent(),o=this.getTotalPage(a.replyCount),i=(a.replyCount+1)%10,o<t&&(t=o,c="/topic/"+a.id+"/"+t+"#"+i,this.props.history.push(c)),[4,$a(u.match.params.topicid)];case 3:return l=e.sent(),this.setState({page:t,topicid:u.match.params.topicid,totalPage:o,userName:n,boardId:r,topicInfo:a,boardInfo:s,isFav:l}),[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u;return x.d(this,function(e){switch(e.label){case 0:return[4,Ma()];case 1:return e.sent(),t=this.match.params.page?parseInt(this.match.params.page):1,n=this.match.params.userName,[4,_a(this.match.params.topicid)];case 2:return a=e.sent(),[4,za(r=a.boardId)];case 3:return s=e.sent(),o=this.getTotalPage(a.replyCount),i=(a.replyCount+1)%10,o<t&&(t=o,c="/topic/"+a.id+"/"+t+"#"+i,this.props.history.push(c)),[4,$a(this.match.params.topicid)];case 4:return l=e.sent(),u=[],this.setState({isFav:l,page:t,topicid:this.match.params.topicid,totalPage:o,userName:n,boardId:r,topicInfo:a,boardInfo:s,fetchState:a,IPData:u}),[2]}})})},e.prototype.getTotalPage=function(e){return Va(e)},e.prototype.render=function(){switch(this.state.quote,this.state.fetchState){case"ok":return I.createElement("div",null);case"not found":return I.createElement(nn,null);case"unauthorized":return I.createElement(Zt,null);case"server error":return I.createElement(sn,null)}var e;e=I.createElement(xs,{topicInfo:this.state.topicInfo,tag1:this.state.topicInfo.tag1,tag2:this.state.topicInfo.tag2,boardInfo:this.state.boardInfo,isFav:this.state.isFav}),1!==parseInt(this.match.params.page)&&this.match.params.page||I.createElement(Ms,{topicInfo:this.state.topicInfo,page:this.match.params.page,boardInfo:this.state.boardInfo,quote:this.quote,isTrace:!1,isHot:!0,postId:null,topicId:this.match.params.topicid});var t="/topic/"+this.state.topicid+"/",n=null;n=Gn("userInfo")?I.createElement(is,{onChange:this.handleChange,boardInfo:this.state.boardInfo,content:this.state.quote,topicInfo:this.state.topicInfo}):I.createElement("div",null,"您还未登录，无法发言，请先登录。"),Gn("userInfo")&&!Gn("userInfo").isVerified&&(n=I.createElement("div",null,"您的帐号未认证，无法发言，请先前往 ",I.createElement("a",{href:"https://account.cc98.org"},"https://account.cc98.org")," 认证激活。")),Gn("userInfo")&&0!==Gn("userInfo").lockState&&(n=I.createElement("div",null,"您的帐号被全站禁言。"));var a=null;return this.state.topicInfo&&1===this.state.topicInfo.state&&(a=I.createElement("div",{style:{color:"red",margin:"0.5rem"}},"该帖已被锁定")),I.createElement("div",{className:"center"},I.createElement(Wt,{title:(this.state.topicInfo.title||"帖子")+" - CC98论坛"}),I.createElement("div",{className:"column",style:{width:"100%"}},I.createElement("div",{className:"row",style:{width:"100%",justifyContent:"space-between",alignItems:"center"}},I.createElement(cs,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,topicId:this.match.params.topicid}),I.createElement(Jt,{page:this.state.page,url:t,totalPage:this.state.totalPage})),a),e,I.createElement(Os.Provider,{value:this.handleQuoteContextChange},I.createElement(Ms,{topicInfo:this.state.topicInfo,page:this.state.page,boardInfo:this.state.boardInfo,quote:this.quote,isHot:!1,isTrace:!1,postId:null,topicId:this.match.params.topicid})),I.createElement("div",{className:"column",style:{width:"100%"}},I.createElement("div",{className:"row",style:{width:"100%",justifyContent:"space-between",marginTop:"2rem"}},I.createElement(cs,{topicInfo:this.state.topicInfo,boardInfo:this.state.boardInfo,topicId:this.match.params.topicid}),I.createElement(Jt,{page:this.state.page,url:t,totalPage:this.state.totalPage}))),n,I.createElement(Gr,{text:"回复成功",id:"replyMessage",top:"24%",left:"46%"}))},e}(Sr),js=Object(Tr.a)(Ds),Ls=function(n){function e(e){var t=n.call(this,e)||this;return t.state={data:new Array},t}return x.c(e,n),e.prototype.getData=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return[4,Zn("/Board/all")];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,this.getData()];case 1:return t=e.sent(),this.setState({data:t}),[2]}})})},e.prototype.scroll=function(e){document.getElementById(e).scrollIntoView()},e.prototype.generateRootBoard=function(e){return I.createElement(Fs,{data:e})},e.prototype.generateBoardGuide=function(e){var t=this,n=""+e.name;return I.createElement("div",{onClick:function(){return t.scroll(n)},className:"row boardOption"},e.name)},e.prototype.render=function(){return I.createElement("div",{className:"row",style:{width:"1140px"}},I.createElement(Wt,{title:"版面列表 - CC98论坛"}),I.createElement("div",{className:"boardList"},this.state.data.map(this.generateRootBoard)),I.createElement("div",{className:"boardGuide"},this.state.data.map(this.generateBoardGuide.bind(this))))},e}(I.Component),Fs=function(n){function e(e){var t=n.call(this,e)||this;t.props.data;return t.state={isExpanded:!0},t.toggleIsExpanded=t.toggleIsExpanded.bind(t),t}return x.c(e,n),e.prototype.toggleIsExpanded=function(){this.setState(function(e){return{isExpanded:!e.isExpanded}})},e.prototype.convertMasters=function(e,t,n){var a=n.length,r="/user/name/"+encodeURIComponent(e);return t===a-1?I.createElement(It.a,{to:r},e):I.createElement("div",{style:{marginRight:"1rem"}},I.createElement(It.a,{to:r},e))},e.prototype.render=function(){var e=this.state.isExpanded?"flex":"none",t=this.state.isExpanded?"收起":"展开",n=this.props.data,a=(n.id,n.masters,n.masters.length?"主管：":"");return I.createElement("div",{className:"anArea",id:n.name},I.createElement("div",{className:"column",style:{border:"2px solid #e9e9e9"}},I.createElement("div",{className:"row boardListHead",onClick:this.toggleIsExpanded},I.createElement("div",{className:"row",style:{marginRight:"1rem",alignItems:"center"}},I.createElement("div",{className:"areaName"},n.name),I.createElement("div",{className:"areaName"},a,n.masters.map(this.convertMasters))),I.createElement("div",{className:"expendBoardList"}," ",t)),I.createElement("div",{className:"hiddenContent",style:{display:e}},I.createElement(Bs,{id:n.id,boards:n.boards}))))},e}(I.Component),Bs=function(n){function e(e){var t=n.call(this,e)||this;return t.state={thisBoardState:[]},t}return x.c(e,n),e.prototype.onError=function(e){e.preventDefault(),e.target.src="/static/images/_CC98.png"},e.prototype.convertChildBoard=function(e){var t="/static/images/_"+e.name+".png";return I.createElement("div",{className:"boardContent"},I.createElement(It.a,{to:"/board/"+e.id},I.createElement("div",{className:"greenBackdrop"},I.createElement("img",{style:{width:"6rem",height:"6rem"},src:t,onError:this.onError}))),I.createElement("div",{className:"column boardBlock"},I.createElement(It.a,{to:"/board/"+e.id},I.createElement("div",{className:"boardName2",style:{fontSize:"1.2rem",fontWeight:"bold"}},e.name)),I.createElement("div",{className:"boardInfo"},I.createElement("div",{className:"row"},"今日  ",e.todayCount," "),I.createElement("div",{className:"row"},"总数  ",e.postCount))))},e.prototype.convertNoImgChildBoard=function(e){return I.createElement("div",{className:"noImgBoardContent"},I.createElement(It.a,{to:"/board/"+e.id},I.createElement("div",{className:"boardName2"},e.name)))},e.prototype.render=function(){var e=[],t=0;return this.props.boards&&this.props.id&&(e=this.props.boards,t=this.props.id),2===t||29===t||35===t||37===t||33===t||604===t?I.createElement("div",{className:"areaContent"},e.map(this.convertNoImgChildBoard)):I.createElement("div",{className:"areaContent"},e.map(this.convertChildBoard.bind(this)))},e}(I.Component),As=n(1232),_s=function(n){function e(e){var t=n.call(this,e)||this;return t.state={buttonClassName:""},t.handleScroll=t.handleScroll.bind(t),t}return x.c(e,n),e.prototype.handleScroll=function(e){234<window.pageYOffset&&this.setState({buttonClassName:"btn-show"}),window.pageYOffset<234&&this.setState(function(e){return{buttonClassName:""===e.buttonClassName?"":"btn-disappare"}})},e.prototype.componentDidMount=function(){document.addEventListener("scroll",this.handleScroll)},e.prototype.componentWillUnmount=function(){document.removeEventListener("scroll",this.handleScroll)},e.prototype.scrollToTop=function(){Ee("body,html").animate({scrollTop:0},500)},e.prototype.render=function(){return I.createElement("div",{className:"user-center-navigation",id:"userCenterNavigation"},I.createElement("ul",null,I.createElement("li",null,I.createElement(As.a,{to:"/usercenter",exact:!0,activeClassName:"user-center-navigation-active",className:"fa-home"},I.createElement("div",{className:"center-nav-item"},"个人主页"))),I.createElement("hr",null),I.createElement("li",null,I.createElement(As.a,{to:"/usercenter/config",activeClassName:"user-center-navigation-active",className:"fa-cog"},I.createElement("div",{className:"center-nav-item"},"修改资料"))),I.createElement("hr",null),I.createElement("li",null,I.createElement(As.a,{to:"/usercenter/mytopics",activeClassName:"user-center-navigation-active",className:"fa-pencil-square-o"},I.createElement("div",{className:"center-nav-item"},"我的主题"))),I.createElement("hr",null),I.createElement("li",null,I.createElement(As.a,{to:"/usercenter/myposts",activeClassName:"user-center-navigation-active",className:"fa-mail-reply"},I.createElement("div",{className:"center-nav-item"},"我的回复"))),I.createElement("hr",null),I.createElement("li",null,I.createElement(As.a,{to:"/usercenter/myfavorites",activeClassName:"user-center-navigation-active",className:"fa-star"},I.createElement("div",{className:"center-nav-item"},"我的收藏"))),I.createElement("hr",null),I.createElement("li",null,I.createElement(As.a,{to:"/usercenter/mycustomboards",activeClassName:"user-center-navigation-active",className:"fa-rss"},I.createElement("div",{className:"center-nav-item"},"关注版面"))),I.createElement("hr",null),I.createElement("li",null,I.createElement(As.a,{to:"/usercenter/myfollowings",activeClassName:"user-center-navigation-active",className:"fa-heart"},I.createElement("div",{className:"center-nav-item"},"关注用户"))),I.createElement("hr",null),I.createElement("li",null,I.createElement(As.a,{to:"/usercenter/myfans",activeClassName:"user-center-navigation-active",className:"fa-users"},I.createElement("div",{className:"center-nav-item"},"我的粉丝"))),I.createElement("hr",null),I.createElement("li",null,I.createElement(As.a,{to:"/usercenter/transferwealth",activeClassName:"user-center-navigation-active",className:"fa-credit-card"},I.createElement("div",{className:"center-nav-item"},"转账系统"))),I.createElement("hr",null),I.createElement("li",null,I.createElement(As.a,{to:"/usercenter/theme",activeClassName:"user-center-navigation-active",className:"fa-magic"},I.createElement("div",{className:"center-nav-item"},"切换皮肤")))),I.createElement("button",{type:"button",id:"scrollToTop",className:this.state.buttonClassName,onClick:this.scrollToTop},"回到顶部"))},e}(I.Component),zs=n(1240),Vs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.getPrivilegeColor=function(){switch(this.props.userInfo.privilege){case"注册用户":return"grey";case"超级版主":return"pink";case"全站贵宾":return"blue";case"管理员":return"red"}},t.prototype.render=function(){var e=!1;if(this.props.userInfo.birthday){var t=this.props.userInfo.birthday.match(/\d+-(\d+)-(\d+)/),n=new Date;Number.parseInt(t[1])===n.getMonth()+1&&Number.parseInt(t[2])===n.getDate()&&(e=!0)}return I.createElement("div",{className:"user-profile"},I.createElement("div",{id:"userId"},I.createElement("p",null,this.props.userInfo.name,I.createElement("span",{style:{fontSize:"12px",color:this.getPrivilegeColor(),marginLeft:"2rem"}},this.props.userInfo.privilege)),I.createElement("div",{className:"row",style:{marginRight:"2rem"}},I.createElement(ms.a,{color:"grey",style:{width:"5rem",textAlign:"center",marginRight:0,height:"2rem",borderTopRightRadius:0,borderBottomRightRadius:0,fontSize:16,lineHeight:"2rem"}},"收到的赞"),I.createElement(ms.a,{className:"board-head-information",style:{width:"5rem",height:"2rem",textAlign:"center",marginRight:0,borderLeft:0,borderTopLeftRadius:0,borderBottomLeftRadius:0,fontSize:16,lineHeight:"2rem"}},this.props.userInfo.receivedLikeCount)),I.createElement(It.a,{to:"/message/message"},I.createElement("button",{type:"button"},"私信"))),I.createElement("div",{id:"userIntroducion"},this.props.userInfo.introduction),I.createElement("div",{id:"userGenderAndBirthday"},I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"性别"),1===this.props.userInfo.gender?"男":"女"," "),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"发帖数"),this.props.userInfo.postCount),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"财富值"),this.props.userInfo.wealth),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"粉丝数"),this.props.userInfo.fanCount),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"威望"),this.props.userInfo.prestige),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"风评"),this.props.userInfo.popularity),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"注册时间"),this.props.userInfo.registerTime.replace("T"," ")),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"最后登录"),this.props.userInfo.lastLogOnTime.replace("T"," ")),null===this.props.userInfo.birthday?null:I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"生日"),this.props.userInfo.birthday.slice(0,this.props.userInfo.birthday.indexOf("T")).replace("9999-",""),e?I.createElement("span",{style:{fontFamily:"FontAwesome",marginLeft:"1rem"},className:"fa-birthday-cake",title:"生日快乐~"}):null),this.props.userInfo.displayTitle?I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"用户组"),this.props.userInfo.displayTitle):null,this.props.userInfo.emailAddress?I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"邮箱"),this.props.userInfo.emailAddress):null,this.props.userInfo.qq?I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"QQ"),this.props.userInfo.qq):null,I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"被删帖数"),-this.props.userInfo.deleteCount)),this.props.userInfo.signatureCode?I.createElement("div",{className:"user-description"},I.createElement("p",null,"个性签名"),I.createElement(Ht,{code:this.props.userInfo.signatureCode,options:x.a({},new Ce,{allowExternalImage:!1})})):null)},t}(I.Component),Hs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"user-post"},I.createElement("div",{className:"user-post-info"},I.createElement(It.a,{className:"user-post-board",to:"/board/"+this.props.userRecentTopic.boardId},this.props.userRecentTopic.boardName),I.createElement("a",{className:"user-post-date"},this.props.userRecentTopic.time.slice(0,19).replace("T"," "))),I.createElement("div",{className:"user-post-content"},I.createElement("p",null,I.createElement(It.a,{to:"/topic/"+this.props.userRecentTopic.id},this.props.userRecentTopic.title))))},t}(I.Component),Ws=void 0,$s=function(h){return function(p,d){return x.b(Ws,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m;return x.d(this,function(e){switch(e.label){case 0:for(e.trys.push([0,7,,8]),p(K()),t=d().userInfo.recentTopics,n=d().userInfo.hasTotal.mytopics,a=t.length<10*(h-1)+1&&!n,r=10*(h-1);r<Math.min(t.length,10*h);r++)if(!t[r]){a=!0;break}return a?(s="/me/recent-topic?from="+10*(h-1)+"&size=11",[4,Xn()]):[2,p(X())];case 1:return o=e.sent(),[4,Zn(s,{headers:o})];case 2:if(200!==(i=e.sent()).status)throw new Error(i.statusText);return[4,i.json()];case 3:c=e.sent(),l=11===c.length?10:c.length,11!==c.length&&p(ee(h)),e.label=4;case 4:return l--?(u=c[l],[4,da(c[l].boardId)]):[3,6];case 5:return u.boardName=e.sent(),t[10*(h-1)+l]=c[l],[3,4];case 6:return p(se(t)),[2,p(X())];case 7:return m=e.sent(),[2,p(ae(m.message))];case 8:return[2]}})})}},Ys=function(){return function(r){return x.b(void 0,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,Xn()];case 1:return[4,Zn("/me",{headers:e.sent()})];case 2:if(200!==(t=e.sent()).status)throw new Error(t.statusText);return[4,t.json()];case 3:return n=e.sent(),[2,r(te(n))];case 4:return a=e.sent(),[2,r(ae(a.message))];case 5:return[2]}})})}},qs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._page=1,t.scrollHandler=function(e){return x.b(t,void 0,void 0,function(){return x.d(this,function(e){return document.body.scrollHeight-window.pageYOffset<1500&&!1===this.props.isLoading&&this.props.getInfo(this.page),[2]})})},t}return x.c(t,e),Object.defineProperty(t.prototype,"page",{get:function(){return this._page++},enumerable:!0,configurable:!0}),t.prototype.componentWillMount=function(){for(var e=!this.props.hasTotal,t=0;t<this.props.userRecentTopics.length;t++)if(!this.props.userRecentTopics[t]){this.props.clearPosts(),e=!0;break}e&&(this.props.getInfo(this.page),window.addEventListener("scroll",this.scrollHandler))},t.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this.scrollHandler)},t.prototype.componentWillReceiveProps=function(e){e.hasTotal&&window.removeEventListener("scroll",this.scrollHandler)},t.prototype.render=function(){if(0===this.props.userRecentTopics.length&&this.props.hasTotal)return I.createElement("div",{className:"user-posts",style:{marginLeft:"2rem"}},"没有主题");for(var e=this.props.userRecentTopics.map(function(e){return I.createElement(Hs,{key:e.id,userRecentTopic:e})}),t=1;t<e.length;t+=2)e.splice(t,0,I.createElement("hr",{key:t}));return I.createElement("div",{className:"user-posts"},e,this.props.isLoading?I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"})):null)},t}(I.Component);var Js=Object(Nr.b)(function(e){return{userRecentTopics:e.userInfo.recentTopics,hasTotal:e.userInfo.hasTotal.mytopics,isLoading:e.userInfo.isLoading}},function(t){return{getInfo:function(e){t($s(e))},clearPosts:function(){t(se([])),t(G())}}})(qs),Gs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"user-activities"},I.createElement("p",null,"发表的主题"),I.createElement(Js,null))},t}(I.Component),Qs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={displayTitles:[],url:"",photoFrameStyle:{}},e}return x.c(e,t),e.prototype.componentDidMount=function(){this.getTitle()},e.prototype.getTitle=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,Zn("/config/global/all-user-title")];case 1:return[4,e.sent().json()];case 2:return t=e.sent(),this.setState({displayTitles:t},this.getPortraitPhotoURL),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}})})},e.prototype.getPortraitPhotoURL=function(){return x.b(this,void 0,void 0,function(){var t,n,a=this;return x.d(this,function(e){switch(e.label){case 0:return[4,fetch("/static/portrait.json")];case 1:return[4,e.sent().json()];case 2:return t=e.sent(),this.state.displayTitles.filter(function(e){return a.props.userInfo.displayTitleId===e.id})[0]&&(n=void 0,82===this.props.userInfo.displayTitleId?(n=t.吉祥物.imageUrl,this.setState({url:n,photoFrameStyle:{width:"13.32rem",position:"absolute",top:"-1.45rem"}})):18===this.props.userInfo.displayTitleId?(n=t.版主.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):22===this.props.userInfo.displayTitleId?(n=t.版主.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):32===this.props.userInfo.displayTitleId?(n=t.站务组.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15.2rem",position:"absolute",top:"-2.5rem",left:"-2.75rem"}})):21===this.props.userInfo.displayTitleId?(n=t.站务组.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15.2rem",position:"absolute",top:"-2.5rem",left:"-2.75rem"}})):28===this.props.userInfo.displayTitleId?(n=t.贵宾.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):16===this.props.userInfo.displayTitleId?(n=t.贵宾.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):37===this.props.userInfo.displayTitleId?(n=t.技术组.imageUrl,this.setState({url:n,photoFrameStyle:{width:"13rem",position:"absolute",top:"-1.4rem",left:"-1.2rem"}})):23===this.props.userInfo.displayTitleId?(n=t.技术组.imageUrl,this.setState({url:n,photoFrameStyle:{width:"13rem",position:"absolute",top:"-1.4rem",left:"-1.2rem"}})):85===this.props.userInfo.displayTitleId?(n=t.编辑部.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):29===this.props.userInfo.displayTitleId?(n=t.编辑部.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):84===this.props.userInfo.displayTitleId?(n=t.策划部.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):34===this.props.userInfo.displayTitleId?(n=t.策划部.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):94===this.props.userInfo.displayTitleId?(n=t.办公室.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):93===this.props.userInfo.displayTitleId?(n=t.办公室.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):35===this.props.userInfo.displayTitleId?(n=t.体育部.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):86===this.props.userInfo.displayTitleId?(n=t.体育部.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):96===this.props.userInfo.displayTitleId?(n=t.影音部.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):99===this.props.userInfo.displayTitleId?(n=t.影音部.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}})):91===this.props.userInfo.displayTitleId&&(n=t.认证用户.imageUrl,this.setState({url:n,photoFrameStyle:{width:"15rem",position:"absolute",top:"-2rem",left:"-1.75rem"}}))),[2]}})})},e.prototype.render=function(){var t=this;return I.createElement("div",{style:{position:"relative"},className:"user-avatar"},I.createElement("img",{className:"user-avatar-img",src:this.props.userInfo.portraitUrl}),this.state.url?I.createElement("img",{style:this.state.photoFrameStyle,src:this.state.url}):null,I.createElement("div",{className:"user-badge"},this.state.displayTitles&&this.props.userInfo.userTitleIds?this.state.displayTitles.filter(function(e){return-1!==t.props.userInfo.userTitleIds.indexOf(e.id)}).map(function(e){return-1===[18,81].indexOf(e.id)?I.createElement("p",{style:{color:"red"}},e.name):null}):null,this.props.userInfo.boardMasterTitles.map(function(e){return 10===e.boardMasterLevel?I.createElement("p",{key:e.boardId}," ",I.createElement(It.a,{to:"/boardList#"+e.boardName},e.boardName),I.createElement("span",{style:{color:"red"}},e.title)):I.createElement("p",{key:e.boardId}," ",I.createElement(It.a,{to:"/board/"+e.boardId},e.boardName),I.createElement("span",null,e.title))})))},e}(I.Component),Ks=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){this.props.changePage(),this.props.refreshCurrentUserInfo()},t.prototype.render=function(){return I.createElement("div",{className:"user-center-exact"},I.createElement(Qs,{userInfo:this.props.userInfo}),I.createElement(Vs,{userInfo:this.props.userInfo}),I.createElement(Gs,null))},t}(I.Component);var Xs=Object(Nr.b)(function(e){return{userInfo:e.userInfo.currentUserInfo}},function(e){return{refreshCurrentUserInfo:function(){e(Ys())},changePage:function(){e(me("profile"))}}})(Ks),Zs=function(n){function e(e){var t=n.call(this,e)||this;return t.state={buttonInfo:t.props.userFanInfo.isFollowing?"已关注":"关注",buttonIsDisabled:!1,isFollowing:t.props.userFanInfo.isFollowing},t.unfollow=t.unfollow.bind(t),t.follow=t.follow.bind(t),t}return x.c(e,n),e.prototype.componentWillReceiveProps=function(e){e.userFanInfo.id!==this.props.userFanInfo.id&&this.setState({buttonInfo:e.userFanInfo.isFollowing?"已关注":"关注",buttonIsDisabled:!1,isFollowing:e.userFanInfo.isFollowing})},e.prototype.unfollow=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.setState({buttonIsDisabled:!0,buttonInfo:"取关中"}),xa(this.props.userFanInfo.id)?(this.setState({buttonIsDisabled:!1,buttonInfo:"重新关注",isFollowing:!1}),this.props.unfollow(this.props.userFanInfo.id)):this.setState({buttonIsDisabled:!1,buttonInfo:"取关失败",isFollowing:!0}),[2]})})},e.prototype.follow=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return this.setState({buttonIsDisabled:!0,buttonInfo:"关注中"}),[4,Sa(this.props.userFanInfo.id)];case 1:return!0===(t=e.sent())?(this.setState({buttonIsDisabled:!1,buttonInfo:"已关注",isFollowing:!0}),this.props.follow(this.props.userFanInfo.id)):"follow_count_limited"===t?this.setState({buttonIsDisabled:!1,buttonInfo:"已达上限",isFollowing:!1}):this.setState({buttonIsDisabled:!1,buttonInfo:"关注失败",isFollowing:!1}),[2]}})})},e.prototype.render=function(){var e=this;return I.createElement("div",{className:"user-center-myfollowings-user"},I.createElement("img",{src:this.props.userFanInfo.portraitUrl}),I.createElement("p",null,I.createElement("span",{className:"user-center-myfollowings-user-id"},I.createElement(It.a,{to:"/user/id/"+this.props.userFanInfo.id},this.props.userFanInfo.name)),"帖数",I.createElement("span",{className:"user-center-myfollowings-user-posts"},this.props.userFanInfo.postCount),"粉丝",I.createElement("span",{className:"user-center-myfollowings-user-fans"},this.props.userFanInfo.fanCount)),I.createElement("button",{key:this.props.userFanInfo.id,type:"button",className:this.state.isFollowing?"":"user-follow",onMouseOver:function(){e.state.isFollowing&&!e.state.buttonIsDisabled&&e.setState({buttonInfo:"取消关注"})},onMouseLeave:function(){e.state.isFollowing&&!e.state.buttonIsDisabled&&e.setState({buttonInfo:"已关注"})},onClick:this.state.isFollowing?this.unfollow:this.follow,disabled:this.state.buttonIsDisabled},this.state.buttonInfo),I.createElement(It.a,{to:"/message/message?id="+this.props.userFanInfo.id},I.createElement("button",{className:"user-message",type:"button"},"私信")))},e}(I.Component);var eo=Object(Nr.b)(function(e,t){return{userFanInfo:t.userFanInfo}},function(t){return{follow:function(e){t(pe(e))},unfollow:function(e){t(de(e))}}})(Zs),to=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getTargetUrl=function(e){return""+t.props.href+e+(t.props.keyword?"?keyword="+t.props.keyword:"")},t}return x.c(t,e),t.prototype.render=function(){var e,n=this,t=[],a={backgroundColor:"#ccc",cursor:"default"};if(this.props.totalPage<=7){for(e=this.props.totalPage;e--;)t.unshift(e+1);t=t.map(function(e,t){return I.createElement("li",{key:""},I.createElement(It.a,{to:n.getTargetUrl(e)},I.createElement("button",{type:"button",disabled:e==n.props.currentPage,style:e==n.props.currentPage?a:{}},e)))})}else if(this.props.currentPage-1<=3){for(e=7;e--;)t.unshift(e+1);(t=t.map(function(e,t){return I.createElement("li",{key:""+n.props.href+e},I.createElement(It.a,{to:n.getTargetUrl(e)},I.createElement("button",{type:"button",disabled:e==n.props.currentPage,style:e==n.props.currentPage?a:{}},e)))})).push(I.createElement("li",{key:"after"},I.createElement("button",{disabled:!0},"···"))),t.push(I.createElement("li",{key:""+this.props.href+this.props.totalPage},I.createElement(It.a,{to:this.getTargetUrl(this.props.totalPage)},I.createElement("button",{type:"button"},this.props.totalPage))))}else if(this.props.totalPage-this.props.currentPage<=3){for(e=7;e--;)t.unshift(e-6+this.props.totalPage);(t=t.map(function(e,t){return I.createElement("li",{key:""+n.props.href+e},I.createElement(It.a,{to:n.getTargetUrl(e)},I.createElement("button",{type:"button",disabled:e==n.props.currentPage,style:e==n.props.currentPage?a:{}},e)))})).unshift(I.createElement("li",{key:"before"},I.createElement("button",{disabled:!0},"···"))),t.unshift(I.createElement("li",{key:this.props.href+"1"},I.createElement(It.a,{to:this.getTargetUrl(1)},I.createElement("button",{type:"button"},1))))}else{for(e=7;e--;)t.unshift(e-3+this.props.currentPage);(t=t.map(function(e,t){return I.createElement("li",{key:""+n.props.href+e},I.createElement(It.a,{to:n.getTargetUrl(e)},I.createElement("button",{type:"button",disabled:e==n.props.currentPage,style:e==n.props.currentPage?a:{}},e)))})).push(I.createElement("li",{key:"after"},I.createElement("button",{disabled:!0},"···"))),t.push(I.createElement("li",{key:""+this.props.href+this.props.totalPage},I.createElement(It.a,{to:this.getTargetUrl(this.props.totalPage)},I.createElement("button",{type:"button"},this.props.totalPage)))),t.unshift(I.createElement("li",{key:"before"},I.createElement("button",{disabled:!0},"···"))),t.unshift(I.createElement("li",{key:this.props.href+"1"},I.createElement(It.a,{to:this.getTargetUrl(1)},I.createElement("button",{type:"button"},1))))}return this.props.hasTotal||this.props.currentPage==this.props.totalPage||t.push(I.createElement("li",{key:"after"},I.createElement("button",{disabled:!0},"···"))),I.createElement("div",{id:"userCenterPageCount"},I.createElement("ul",null,t))},t}(I.Component),no=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentWillMount=function(){var e=parseInt(this.props.match.params.page)||1;this.props.getInfo(e),this.props.changePage()},t.prototype.componentWillReceiveProps=function(e){if(this.props.match.params.page!==e.match.params.page){window.scroll(0,0);var t=parseInt(e.match.params.page)||1;this.props.getInfo(t)}},t.prototype.render=function(){if(this.props.isLoading)return I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.userFollowings.length)return I.createElement("div",{className:"user-center-myfans",style:{textAlign:"center"}},"没有关注");for(var e=parseInt(this.props.match.params.page)||1,t=this.props.userFollowings.slice(10*(e-1),10*e).map(function(e){return I.createElement(eo,{key:e.id,userFanInfo:e})}),n=1;n<t.length;n+=2)t.splice(n,0,I.createElement("hr",{key:n}));return I.createElement("div",{className:"user-center-myfans"},I.createElement("div",{className:"user-center-myfans-exact"},t),I.createElement(to,{currentPage:e,totalPage:this.props.totalPage,href:"/usercenter/myfollowings/",hasTotal:!0}))},t}(I.Component);var ao=Object(Nr.b)(function(e){return{userFollowings:e.userInfo.currentUserFollowingInfo,totalPage:e.userInfo.totalPage.myfollowings,isLoading:e.userInfo.isLoading,hasTotal:e.userInfo.hasTotal.myfollowings}},function(t){return{changePage:function(){t(me("myfollowings"))},getInfo:function(e){var d;t((d=e,function(m,p){return x.b(void 0,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u;return x.d(this,function(e){switch(e.label){case 0:if(e.trys.push([0,5,,6]),m(K()),0===(t=p().userInfo).currentUserInfo.followCount)return[2,m(X())];if(!(n=t.currentUserFollowingInfo.length<10*(d-1)+1))for(a=10*(d-1);a<Math.min(10*d,t.currentUserFollowingInfo.length);a++)if(!t.currentUserFollowingInfo[a]){n=!0;break}return n?(r="/me/followee?from="+10*(d-1)+"&size=10",[4,Xn()]):[2,m(X())];case 1:return s=e.sent(),[4,Zn(r,{headers:s})];case 2:if(200!==(o=e.sent()).status)throw new Error(o.statusText);return[4,o.json()];case 3:return 0===(i=e.sent()).length?(m(ue([])),m(ee(0)),[2,m(X())]):[4,na(i)];case 4:return c=e.sent(),l=t.currentUserFollowingInfo,c.forEach(function(e,t){return l[t+10*(d-1)]=e}),m(ue(l)),[2,m(X())];case 5:return u=e.sent(),[2,m(ae(u.message))];case 6:return[2]}})})}))}}})(Object(Tr.a)(no)),ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentWillMount=function(){var e=parseInt(this.props.match.params.page)||1;this.props.changePage(),this.props.getInfo(e)},t.prototype.componentWillReceiveProps=function(e){if(this.props.match.params.page!==e.match.params.page){window.scroll(0,0);var t=parseInt(e.match.params.page)||1;this.props.getInfo(t)}},t.prototype.render=function(){if(this.props.isLoading)return I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.userFans.length)return I.createElement("div",{className:"user-center-myfans",style:{textAlign:"center"}},"没有粉丝");for(var e=parseInt(this.props.match.params.page)||1,t=this.props.userFans.slice(10*(e-1),10*e).map(function(e){return I.createElement(eo,{key:e.id,userFanInfo:e})}),n=1;n<t.length;n+=2)t.splice(n,0,I.createElement("hr",{key:n}));return I.createElement("div",{className:"user-center-myfans"},I.createElement("div",{className:"user-center-myfans-exact"},t),I.createElement(to,{currentPage:e,totalPage:this.props.totalPage,href:"/usercenter/myfans/",hasTotal:!0}))},t}(I.Component);var so=Object(Nr.b)(function(e){return{userFans:e.userInfo.currentUserFansInfo,totalPage:e.userInfo.totalPage.myfans,isLoading:e.userInfo.isLoading,hasTotal:e.userInfo.hasTotal.myfans}},function(t){return{changePage:function(){t(me("myfans"))},getInfo:function(e){var d;t((d=e,function(m,p){return x.b(void 0,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u;return x.d(this,function(e){switch(e.label){case 0:if(e.trys.push([0,5,,6]),m(K()),0===(t=p().userInfo).currentUserInfo.fanCount)return[2,m(X())];if(!(n=t.currentUserFansInfo.length<10*(d-1)+1))for(a=10*(d-1);a<Math.min(10*d,t.currentUserFansInfo.length);a++)if(!t.currentUserFansInfo[a]){n=!0;break}return n?(r="/me/follower?from="+10*(d-1)+"&size=10",[4,Xn()]):[2,m(X())];case 1:return s=e.sent(),[4,Zn(r,{headers:s})];case 2:if(200!==(o=e.sent()).status)throw new Error(o.statusText);return[4,o.json()];case 3:return 0===(i=e.sent()).length?(m(le([])),m(ee(0)),[2,m(X())]):[4,na(i)];case 4:return c=e.sent(),l=t.currentUserFansInfo,c.forEach(function(e,t){return l[t+10*(d-1)]=e}),m(le(l)),[2,m(X())];case 5:return u=e.sent(),[2,m(ae(u.message))];case 6:return[2]}})})}))}}})(Object(Tr.a)(ro)),oo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.match.params.page!==e.match.params.page){var t=parseInt(e.match.params.page)||1;this.props.getInfo(t),window.scroll(0,0)}},t.prototype.componentDidMount=function(){var e=parseInt(this.props.match.params.page)||1;this.props.getInfo(e),this.props.changePage()},t.prototype.render=function(){if(this.props.isLoading)return I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.userRecentTopics.length)return I.createElement("div",{className:"user-posts",style:{textAlign:"center"}},"没有主题");for(var e=parseInt(this.props.match.params.page)||1,t=this.props.hasTotal?this.props.totalPage:e+1,n=this.props.userRecentTopics.slice(10*(e-1),10*e).map(function(e){return I.createElement(Hs,{key:e.id,userRecentTopic:e})}),a=1;a<n.length;a+=2)n.splice(a,0,I.createElement("hr",{key:a}));return I.createElement("div",{className:"user-posts"},n,I.createElement(to,{currentPage:e,totalPage:t,href:"/usercenter/mytopics/",hasTotal:this.props.hasTotal}))},t}(I.Component);var io=Object(Nr.b)(function(e){return{userRecentTopics:e.userInfo.recentTopics,totalPage:e.userInfo.totalPage.mytopics,hasTotal:e.userInfo.hasTotal.mytopics,isLoading:e.userInfo.isLoading}},function(t){return{getInfo:function(e){t($s(e))},changePage:function(){t(me("mytopics"))}}})(Object(Tr.a)(oo)),co=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"user-post"},I.createElement("div",{className:"user-post-info"},I.createElement(It.a,{className:"user-post-board",to:"/board/"+this.props.userRecentPost.boardId},this.props.userRecentPost.boardName),I.createElement("a",{className:"user-post-date"},this.props.userRecentPost.time.slice(0,19).replace("T"," "))),I.createElement("div",{className:"user-post-content"},I.createElement("p",null,I.createElement(It.a,{to:"/topic/"+this.props.userRecentPost.topicId+"/"+(Math.floor((this.props.userRecentPost.floor-1)/10)+1)+"#"+this.props.userRecentPost.floor%10},this.props.userRecentPost.content))))},t}(I.Component),lo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.changeishot=function(e){t.props.history.push("/usercenter/myposts/ishot/"+e+"/1")},t}return x.c(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.match.params.page!==e.match.params.page||this.props.match.params.ishot!==e.match.params.ishot){var t=parseInt(e.match.params.page)||1;this.props.getInfo(t,Number(e.match.params.ishot)),window.scroll(0,0)}},t.prototype.componentDidMount=function(){var e=parseInt(this.props.match.params.page)||1;this.props.getInfo(e,Number(this.props.match.params.ishot)),this.props.changePage()},t.prototype.render=function(){var e=this;if(this.props.isLoading)return I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.userRecentPosts.length)return I.createElement("div",{className:"user-posts",style:{textAlign:"center"}},"没有回复");for(var t=parseInt(this.props.match.params.page)||1,n=this.props.hasTotal?this.props.totalPage:t+1,a=this.props.userRecentPosts.slice(10*(t-1),10*t).map(function(e){return I.createElement(co,{key:e.id,userRecentPost:e})}),r=1;r<a.length;r+=2)a.splice(r,0,I.createElement("hr",{key:r}));var s=Number(this.props.match.params.ishot);return I.createElement("div",{className:"user-posts"},0===s?I.createElement(xn.a,{style:{width:"8rem",marginTop:"-1rem",marginBottom:"2rem"},className:"user-ishot-btn",type:"primary",onClick:function(){return e.changeishot(1)}},"显示热门回复"):I.createElement(xn.a,{style:{width:"8rem",marginTop:"-1rem",marginBottom:"2rem"},type:"primary",onClick:function(){return e.changeishot(0)}},"显示全部回复"),a,I.createElement(to,{currentPage:t,totalPage:n,href:"/usercenter/myposts/ishot/"+Number(this.props.match.params.ishot)+"/",hasTotal:this.props.hasTotal}))},t}(I.Component);var uo=Object(Nr.b)(function(e){return{userRecentPosts:e.userInfo.recentPosts,totalPage:e.userInfo.totalPage.myposts,hasTotal:e.userInfo.hasTotal.myposts,isLoading:e.userInfo.isLoading}},function(n){return{getInfo:function(e,t){var d,h;n((d=e,h=t,function(m,p){return x.b(Ws,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,7,,8]),m(K()),t=p().userInfo.recentPosts,p().userInfo.hasTotal.myposts,n="/me/"+(0===h?"recent":"hot")+"-post?from="+10*(d-1)+"&size=11",[4,Xn()];case 1:return a=e.sent(),[4,Zn(n,{headers:a})];case 2:if(200!==(r=e.sent()).status)throw new Error(r.statusText);return[4,r.json()];case 3:s=e.sent(),o=s.data,i=Math.floor(s.count/10)+1,c=11===o.length?10:o.length,11!==o.length&&m(ee(d)),e.label=4;case 4:return c--?(l=o[c],[4,da(o[c].boardId)]):[3,6];case 5:return l.boardName=e.sent(),t[10*(d-1)+c]=o[c],[3,4];case 6:return m(oe({posts:t,total:i})),[2,m(X())];case 7:return u=e.sent(),[2,m(ae(u.message))];case 8:return[2]}})})}))},changePage:function(){n(me("myposts"))}}})(Object(Tr.a)(lo)),mo=function(n){function e(e){var t=n.call(this,e)||this;Gn("userInfo");return t.state={avatarURL:"",info:"",isShown:!1,divheight:0,divWidth:0,selectorWidth:160,selectorLeft:0,selectorTop:0,avatarNow:e.userInfo.portraitUrl,isLoading:!1,naturalWidth:0,naturalHeight:0,img:null,NUM_MAX:0,scaling:1,choosingDefault:!1,fileType:""},t.handleChange=t.handleChange.bind(t),t.handleIMGLoad=t.handleIMGLoad.bind(t),t.handleSelectorMove=t.handleSelectorMove.bind(t),t.handleResizeMove=t.handleResizeMove.bind(t),t.handleSubmit=t.handleSubmit.bind(t),t.handleCoverMouseMove=t.handleCoverMouseMove.bind(t),t.handleMouseUp=t.handleMouseUp.bind(t),t.setDefaultAvatar=t.setDefaultAvatar.bind(t),t}return x.c(e,n),e.prototype.handleChange=function(e){var t=this,n=e.target.files[0];if(!n.type.match("image.*"))return this.setState({info:"请选择图片文件",isShown:!1,divheight:0}),!1;this.setState({fileType:n.type});var a=new FileReader;a.readAsDataURL(n),a.addEventListener("load",function(e){t.setState({isShown:!0,avatarURL:e.target.result})})},e.prototype.handleIMGLoad=function(e,t,n){if(e<160||t<160)this.setState({info:"图片至少为 160*160",isShown:!1,divheight:0});else{for(var a=this.myCanvas.getContext("2d"),r=this.state.scaling;800<e/r;)r*=1.1;this.myCanvas.width=e/r,this.myCanvas.height=t/r,a.drawImage(n,0,0,e,t,0,0,e/r,t/r),this.setState({divheight:t/r+50,divWidth:e/r+50,isShown:!0,info:"请选择要显示的区域",selectorLeft:e/r/4,selectorTop:t/r/4,selectorWidth:Math.min(t/r,e/r)/2,naturalWidth:e/r,naturalHeight:t/r,img:n,NUM_MAX:Math.min(500,e/r,t/r),scaling:r})}},e.prototype.handleMouseUp=function(){this.dragging=null},e.prototype.componentDidMount=function(){this.selector.addEventListener("mousedown",this.handleSelectorMove),this.selector.addEventListener("mousemove",this.handleSelectorMove),this.selector.addEventListener("mouseup",this.handleSelectorMove),this.resize.addEventListener("mousedown",this.handleResizeMove),this.resize.addEventListener("mousemove",this.handleResizeMove),this.resize.addEventListener("mouseup",this.handleResizeMove),this.cover.addEventListener("mousemove",this.handleCoverMouseMove),this.cover.addEventListener("mouseup",this.handleCoverMouseMove),window.addEventListener("mouseup",this.handleMouseUp)},e.prototype.componentWillUnmount=function(){this.selector.removeEventListener("mousedown",this.handleSelectorMove),this.selector.removeEventListener("mousemove",this.handleSelectorMove),this.selector.removeEventListener("mouseup",this.handleSelectorMove),this.resize.removeEventListener("mousedown",this.handleResizeMove),this.resize.removeEventListener("mousemove",this.handleResizeMove),this.resize.removeEventListener("mouseup",this.handleResizeMove),this.cover.removeEventListener("mousemove",this.handleCoverMouseMove),this.cover.removeEventListener("mouseup",this.handleCoverMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)},e.prototype.handleSelectorMove=function(e){var t=this;if(void 0!==this.dragging&&null!==this.dragging&&"resize"===this.dragging.id)this.handleCoverMouseMove(e);else switch(e.type){case"mousedown":this.diffX=e.clientX-e.target.offsetLeft,this.diffY=e.clientY-e.target.offsetTop,this.dragging=e.target;break;case"mousemove":if(null!==this.dragging){var n=e.clientY-this.diffY,a=e.clientX-this.diffX;this.setState(function(e){return n<0&&(n=0),a<0&&(a=0),n>e.naturalHeight-t.state.selectorWidth&&(n=e.naturalHeight-t.state.selectorWidth),a>e.naturalWidth-t.state.selectorWidth&&(a=e.naturalWidth-t.state.selectorWidth),{selectorTop:n,selectorLeft:a}})}break;case"mouseup":this.dragging=null}},e.prototype.handleResizeMove=function(e){var a=this;switch(e.type){case"mousedown":this.diffX=e.clientX-e.target.offsetLeft,this.dragging=e.target;break;case"mousemove":null!==this.dragging&&(this.diffY=e.clientX-e.target.offsetLeft,this.setState(function(e){var t=e.selectorWidth+a.diffY-a.diffX,n=Math.min(e.NUM_MAX,e.naturalWidth-e.selectorLeft,e.naturalHeight-e.selectorTop);return isNaN(t)||(t<100&&(t=100),n<t&&(t=n)),{selectorWidth:isNaN(t)?e.selectorWidth:t}}));break;case"mouseup":this.dragging=null}},e.prototype.handleCoverMouseMove=function(e){var a=this;switch(e.type){case"mouseup":this.dragging=null;break;case"mousemove":if(void 0!==this.dragging&&null!==this.dragging&&"resize"===this.dragging.id)this.diffY=e.clientX-this.dragging.offsetLeft,this.setState(function(e){var t=e.selectorWidth+a.diffY-a.diffX;if(!isNaN(t)){var n=Math.min(e.NUM_MAX,e.naturalWidth-e.selectorLeft,e.naturalHeight-e.selectorTop);t<100&&(t=100),n<t&&(t=n)}return{selectorWidth:isNaN(t)?e.selectorWidth:t}});else if(void 0!==this.dragging&&null!==this.dragging&&"selector"===this.dragging.id){var t=e.clientY-this.diffY,n=e.clientX-this.diffX;this.setState(function(e){return t<0&&(t=0),n<0&&(n=0),t>e.naturalHeight-a.state.selectorWidth&&(t=e.naturalHeight-a.state.selectorWidth),n>e.naturalWidth-a.state.selectorWidth&&(n=e.naturalWidth-a.state.selectorWidth),{selectorTop:t,selectorLeft:n}})}}},e.prototype.handleSubmit=function(){var e=this,t=this.newAvatar,n=t.getContext("2d"),a=this.state.selectorLeft,r=this.state.selectorTop,s=this.state.selectorWidth;t.width=s,t.height=s,n.drawImage(this.state.img,a*this.state.scaling,r*this.state.scaling,s*this.state.scaling,s*this.state.scaling,0,0,s,s),t.toBlob(function(u){return x.b(e,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l;return x.d(this,function(e){switch(e.label){case 0:(t=new Blob([u],{type:this.state.fileType})).lastModifiedDate=Date.now(),t.name="头像."+this.state.fileType.slice(this.state.fileType.indexOf("/")+1,this.state.fileType.length),e.label=1;case 1:return e.trys.push([1,5,,6]),n="/file/portrait",a=new Headers,s=(r=a).append,o=["Authorization"],[4,Kn()];case 2:return s.apply(r,o.concat([e.sent()])),(i=new FormData).append("files",t,t.name),i.append("contentType","multipart/form-data"),[4,Zn(n,{method:"POST",headers:a,body:i})];case 3:return[4,(c=e.sent()).json()];case 4:return l=e.sent(),200===c.status&&0!==l.length&&this.changeAvatar(l[0]),[3,6];case 5:return e.sent(),this.setState({info:"修改失败",isLoading:!1,isShown:!1,divheight:0,choosingDefault:!1,avatarURL:""}),[3,6];case 6:return[2]}})})},this.state.fileType,.75)},e.prototype.setDefaultAvatar=function(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return t=n.target,[4,this.changeAvatar(t.src)];case 1:return e.sent(),[2]}})})},e.prototype.changeAvatar=function(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),this.setState({isLoading:!0}),[4,Kn()];case 1:return t=e.sent(),"/me/portrait",(n=new Headers).append("Content-Type","application/json"),n.append("Authorization",t),[4,Zn("/me/portrait",{method:"PUT",headers:n,body:JSON.stringify(a)})];case 2:if(200!==e.sent().status)throw new Error;return this.setState({info:"修改成功",avatarNow:a,isLoading:!1,isShown:!1,divheight:0,choosingDefault:!1,avatarURL:""}),this.props.refreshUserInfo(),[3,4];case 3:return e.sent(),this.setState({info:"修改失败",isLoading:!1,isShown:!1,divheight:0,choosingDefault:!1,avatarURL:""}),[3,4];case 4:return[2]}})})},e.prototype.render=function(){var t=this,e={display:"none"};Gn("userInfo");return I.createElement("div",null,I.createElement("h2",null,"修改头像"),I.createElement("div",{className:"user-center-config-avatar"},I.createElement("img",{src:this.state.avatarNow}),I.createElement("div",null,I.createElement("button",{id:"chooseDefaultAvatar",type:"button",onClick:function(){return t.setState({choosingDefault:!0,info:"暂时只有六枚"})}},"选择论坛头像"),I.createElement("div",null,I.createElement("input",{onChange:function(e){t.handleChange(e),e.target.value=""},id:"uploadAvatar",type:"file",accept:"image/*",style:e}),I.createElement("label",{htmlFor:"uploadAvatar",onClick:function(){return t.setState({choosingDefault:!1})}},I.createElement("p",null,"选择本地图片")),I.createElement("p",{style:{color:"red",margin:"0"}},this.state.info),I.createElement("button",{type:"button",className:"config-submit-button",style:this.state.isShown?{}:e,onClick:this.handleSubmit,disabled:this.state.isLoading},"提交"))),I.createElement("div",{className:"user-center-config-avatar-preview",style:this.state.isShown?{opacity:1,marginTop:"2rem"}:{zIndex:-1}},I.createElement("div",{style:{position:"absolute",width:"824px",overflow:"hidden",paddingBottom:"50px"}},I.createElement("canvas",{id:"newAvatar",style:e,ref:function(e){t.newAvatar=e}}),I.createElement("canvas",{ref:function(e){t.myCanvas=e},style:this.state.isShown?{position:"relative"}:{display:"none"}}),I.createElement("div",{id:"cover",ref:function(e){t.cover=e},style:{width:this.state.divWidth+"px",height:this.state.divheight+"px",top:0}}),I.createElement("div",{className:"imgdata",style:this.state.isShown?{width:this.state.selectorWidth+"px",height:this.state.selectorWidth+"px",borderRadius:this.state.selectorWidth/2+"px",top:this.state.selectorTop+"px",left:this.state.selectorLeft+"px"}:e},I.createElement("img",{src:this.state.avatarURL,style:{position:"relative",top:"-"+this.state.selectorTop+"px",left:"-"+this.state.selectorLeft+"px",width:this.state.naturalWidth+"px",height:this.state.naturalHeight+"px"}})),I.createElement("div",{id:"selector",ref:function(e){t.selector=e},style:this.state.isShown?{width:this.state.selectorWidth+"px",height:this.state.selectorWidth+"px",borderRadius:this.state.selectorWidth/2+"px",top:this.state.selectorTop+"px",left:this.state.selectorLeft+"px"}:e}),I.createElement("span",{id:"resize",ref:function(e){t.resize=e},style:{top:this.state.selectorWidth+this.state.selectorTop+"px",left:this.state.selectorWidth+this.state.selectorLeft+"px"}})),I.createElement("img",{onLoad:function(e){t.handleIMGLoad(e.target.naturalWidth,e.target.naturalHeight,e.target)},style:e,src:this.state.avatarURL})),I.createElement("div",{style:{width:"100%",height:this.state.divheight+"px",transitionDuration:".5s"}}),I.createElement("div",{style:this.state.choosingDefault?{display:"flex",flexDirection:"row",width:"100%",justifyContent:"center",flexWrap:"wrap"}:{display:"none"}},["default_avatar_boy.png","default_avatar_girl.png","default_avatar_boy2.jpg","default_avatar_girl2.jpg","default_avatar_boy3.jpg","default_avatar_girl3.jpg"].map(function(e){return I.createElement("img",{key:e,style:{margin:"3rem 5rem",cursor:"pointer",height:"10rem",width:"10rem"},onClick:t.setDefaultAvatar,src:"//www.cc98.org/static/images/"+e})}))))},e}(I.Component);var po=Object(Nr.b)(function(e){return{userInfo:e.userInfo.currentUserInfo}},function(e){return{refreshUserInfo:function(){e(Ys())}}})(mo),ho=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var t=this;return I.createElement("div",null,I.createElement("h2",null,"修改签名档"),I.createElement("div",{className:"user-center-config-signature"},I.createElement("textarea",{id:"signature",onChange:function(e){t.props.onchange("SignatureCode",e.target.value)},value:this.props.signature,spellCheck:!1}),I.createElement("div",null,I.createElement("p",null,"注* 个性签名将在个人主页、发布文章、回复文章中显示，允许使用UBB代码"))))},t}(I.Component),fo=function(n){function e(e){var t=n.call(this,e)||this;return t.state={displayTitles:[]},t}return x.c(e,n),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,Zn("/config/global/all-user-title")];case 1:return[4,e.sent().json()];case 2:return t=e.sent(),this.setState({displayTitles:t}),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}})})},e.prototype.render=function(){var n=this,e=[],t=0;for(t=100;t--;)e.unshift(t+1920);var a=e.map(function(e){return I.createElement("option",{key:e,value:e},e)});for(a.unshift(I.createElement("option",{key:9999,value:9999},"保密")),a.unshift(I.createElement("option",{key:0,value:0},"未选择")),e=[],t=12;t--;)e.unshift(t+1);var r=e.map(function(e){return I.createElement("option",{key:e,value:e},e)});for(r.unshift(I.createElement("option",{key:0,value:0},"未选择")),e=[],t=31;t--;)e.unshift(t+1);var s=e.map(function(e){return I.createElement("option",{key:e,value:e},e)});return s.unshift(I.createElement("option",{key:0,value:0},"未选择")),I.createElement("div",{className:"user-center-config-others"},I.createElement("h2",null,"其他设置"),I.createElement("div",{className:"config-gender"},I.createElement("p",null,"性别："),I.createElement("select",{id:"genderSelect",name:"Gender",value:this.props.userinfo.Gender,onChange:function(e){n.props.handleChange(e.target.name,Number.parseInt(e.target.value))}},I.createElement("option",{value:1},"男"),I.createElement("option",{value:0},"女"))),I.createElement("div",{className:"config-birthday"},I.createElement("p",null,"生日："),I.createElement("select",{id:"birthdayYear",name:"birthdayYear",value:this.props.userinfo.birthdayYear,onChange:function(e){n.props.handleChange(e.target.name,Number.parseInt(e.target.value))}},a),I.createElement("p",null,"年"),I.createElement("select",{id:"birthdayMonth",name:"birthdayMonth",value:this.props.userinfo.birthdayMonth,disabled:0===this.props.userinfo.birthdayYear,onChange:function(e){n.props.handleChange(e.target.name,Number.parseInt(e.target.value))}},r),I.createElement("p",null,"月"),I.createElement("select",{id:"birthdayDay",name:"birthdayDay",value:this.props.userinfo.birthdayDay,disabled:0===this.props.userinfo.birthdayYear,onChange:function(e){n.props.handleChange(e.target.name,Number.parseInt(e.target.value))}},s),I.createElement("p",null,"日")),0<this.state.displayTitles.length?I.createElement("div",{className:"config-gender"},I.createElement("p",null,"头衔："),I.createElement("select",{style:{width:"auto",padding:"0 1rem"},name:"DisplayTitleId",value:this.props.userinfo.DisplayTitleId,onChange:function(e){n.props.handleChange(e.target.name,Number.parseInt(e.target.value))}},I.createElement("option",{value:0},"不显示"),this.props.userinfo.userTitleIds.map(function(t){var e=n.state.displayTitles.filter(function(e){return e.id===t});if(0<e.length)return I.createElement("option",{key:t,value:t},e[0].name)}))):null,I.createElement("div",{className:"config-text"},I.createElement("p",null,"QQ："),I.createElement("input",{type:"text",name:"QQ",value:this.props.userinfo.QQ,maxLength:20,onChange:function(e){n.props.handleChange(e.target.name,e.target.value)}})),I.createElement("div",{className:"config-text"},I.createElement("p",null,"邮箱："),I.createElement("input",{type:"email",name:"EmailAddress",value:this.props.userinfo.EmailAddress,maxLength:150,onChange:function(e){n.props.handleChange(e.target.name,e.target.value)}})),I.createElement("div",{className:"config-introduction"},I.createElement("p",null,"个人简介："),I.createElement("div",null,I.createElement("textarea",{name:"Introduction",value:this.props.userinfo.Introduction,maxLength:100,onChange:function(e){n.props.handleChange(e.target.name,e.target.value)}}),I.createElement("p",null,"*不超过100字"))))},e}(I.Component),go=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}x.c(t,e)}(hr),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}x.c(t,e)}(hr),function(a){function e(e){var t=a.call(this,e)||this;e.changePage();var n={EmailAddress:e.userInfo.emailAddress,Gender:e.userInfo.gender,Introduction:e.userInfo.introduction,QQ:e.userInfo.qq,SignatureCode:e.userInfo.signatureCode,Birthday:e.userInfo.birthday,birthdayYear:e.userInfo.birthday?Number.parseInt(e.userInfo.birthday.slice(0,4)):0,birthdayMonth:e.userInfo.birthday?Number.parseInt(e.userInfo.birthday.slice(5,7)):0,birthdayDay:e.userInfo.birthday?Number.parseInt(e.userInfo.birthday.slice(8,10)):0,DisplayTitleId:e.userInfo.displayTitleId||0,userTitleIds:e.userInfo.userTitleIds||[]};return t.state={userInfo:n,info:"",isLoading:!1},t.handleChange=t.handleChange.bind(t),t.handleSubmit=t.handleSubmit.bind(t),t.handleReset=t.handleReset.bind(t),t}return x.c(e,a),e.prototype.handleReset=function(){var e=this.props.userInfo,t={EmailAddress:e.emailAddress,Gender:e.gender,Introduction:e.introduction,QQ:e.qq,SignatureCode:e.signatureCode,Birthday:e.birthday,birthdayYear:e.birthday?Number.parseInt(e.birthday.slice(0,4)):0,birthdayMonth:e.birthday?Number.parseInt(e.birthday.slice(5,7)):0,birthdayDay:e.birthday?Number.parseInt(e.birthday.slice(8,10)):0,DisplayTitleId:e.displayTitleId,userTitleIds:e.userTitleIds||[]};this.setState({userInfo:t})},e.prototype.handleChange=function(n,a){this.setState(function(e){var t;return{userInfo:x.a({},e.userInfo,(t={},t[n]=a,t))}})},e.prototype.handleSubmit=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i=this;return x.d(this,function(e){switch(e.label){case 0:this.setState({isLoading:!0,info:"修改中"}),e.label=1;case 1:if(e.trys.push([1,4,,5]),(t=this.state.userInfo).Birthday=0!==this.state.userInfo.birthdayYear?this.state.userInfo.birthdayYear+"-"+this.state.userInfo.birthdayMonth+"-"+this.state.userInfo.birthdayDay:"",t.EmailAddress&&!t.EmailAddress.match(/[\S]+@[\S]+\.[\S]+/))throw new Error("请检查邮箱地址");if(t.QQ&&(Number.parseInt(t.QQ)<=0||Number.parseInt(t.QQ).toString()!==t.QQ))throw new Error("请检查QQ是否正确");if(n=new Date(this.state.userInfo.birthdayYear+10,this.state.userInfo.birthdayMonth-1,this.state.userInfo.birthdayDay),0!==this.state.userInfo.birthdayYear&&9999!==this.state.userInfo.birthdayYear&&n.getTime()>Date.now())throw new Error("请检查生日是否正确");return[4,Kn()];case 2:return a=e.sent(),"/me",(r=new Headers).append("Authorization",a),r.append("Content-Type","application/json"),[4,Zn("/me",{method:"PUT",headers:r,body:JSON.stringify(t)})];case 3:if(200!==(s=e.sent()).status)throw new Error(s.status.toString());return this.props.refreshUserInfo(),this.setState({info:"修改成功",isLoading:!1}),setTimeout(function(){i.setState({info:""})},1e3),[3,5];case 4:return o=e.sent(),this.setState({info:o.message,isLoading:!1}),[3,5];case 5:return[2]}})})},e.prototype.render=function(){return I.createElement("div",{className:"user-center-config"},I.createElement(po,null),I.createElement("hr",null),I.createElement(ho,{signature:this.state.userInfo.SignatureCode,onchange:this.handleChange}),I.createElement("hr",null),I.createElement(fo,{userinfo:this.state.userInfo,handleChange:this.handleChange}),I.createElement("hr",null),I.createElement("div",{className:"config-submit"},I.createElement("h2",null,"提交修改"),I.createElement("div",{className:"config-buttons"},I.createElement("button",{className:"config-submit-button",type:"button",disabled:this.state.isLoading,onClick:this.handleSubmit},"提交"),I.createElement("button",{type:"button",onClick:this.handleReset},"重置")),I.createElement("p",{style:{height:""===this.state.info?"0":"1rem",color:"red"}},this.state.info)))},e}(I.Component));var vo=Object(Nr.b)(function(e){return{userInfo:e.userInfo.currentUserInfo}},function(e){return{refreshUserInfo:function(){e(Ys())},changePage:function(){e(me("config"))}}})(go),bo=function(n){function e(e){var t=n.call(this,e)||this;return t.state={buttonInfo:"取消关注",buttonIsDisabled:!1,isFollowing:!0},t.unfollow=t.unfollow.bind(t),t.follow=t.follow.bind(t),t}return x.c(e,n),e.prototype.unfollow=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:this.setState({buttonIsDisabled:!0,buttonInfo:"取关中"}),e.label=1;case 1:return e.trys.push([1,4,,5]),[4,Kn()];case 2:return t=e.sent(),n=this.props.UserFavoritesBoard.id,a="/me/custom-board/"+n,(r=new Headers).append("Authorization",t),[4,Zn(a,{method:"DELETE",headers:r})];case 3:if(200!==e.sent().status)throw{};return this.setState({buttonIsDisabled:!1,buttonInfo:"重新关注",isFollowing:!1}),[3,5];case 4:return e.sent(),this.setState({buttonIsDisabled:!1,buttonInfo:"取关失败",isFollowing:!0}),[3,5];case 5:return[2]}})})},e.prototype.follow=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:this.setState({buttonIsDisabled:!0,buttonInfo:"关注中"}),e.label=1;case 1:return e.trys.push([1,4,,5]),[4,Kn()];case 2:return t=e.sent(),n=this.props.UserFavoritesBoard.id,a="/me/custom-board/"+n,(r=new Headers).append("Authorization",t),[4,Zn(a,{method:"PUT",headers:r})];case 3:if(200!==e.sent().status)throw{};return this.setState({buttonIsDisabled:!1,buttonInfo:"取消关注",isFollowing:!0}),[3,5];case 4:return e.sent(),this.setState({buttonIsDisabled:!1,buttonInfo:"关注失败",isFollowing:!1}),[3,5];case 5:return[2]}})})},e.prototype.render=function(){return I.createElement("div",{className:"user-center-myfavorite-board"},I.createElement(It.a,{to:"/board/"+this.props.UserFavoritesBoard.id,title:this.props.UserFavoritesBoard.name},I.createElement("img",{src:"/static/images/_"+this.props.UserFavoritesBoard.name+".png"})),I.createElement("div",{className:"user-center-myfavorite-board-info"},I.createElement(It.a,{to:"/board/"+this.props.UserFavoritesBoard.id,title:this.props.UserFavoritesBoard.name},I.createElement("h2",null,this.props.UserFavoritesBoard.name)),I.createElement("p",null,"版主：",this.props.UserFavoritesBoard.boardMasters.join(" ")," 今日主题 ",this.props.UserFavoritesBoard.todayCount," / 总主题 ",this.props.UserFavoritesBoard.topicCount)),I.createElement("button",{type:"button",className:this.state.isFollowing?"":"user-follow-board",onClick:this.state.isFollowing?this.unfollow:this.follow,disabled:this.state.buttonIsDisabled},this.state.buttonInfo))},e}(I.Component),yo=function(n){function e(e){var t=n.call(this,e)||this;return e.getInfo(),e.changePage(),t}return x.c(e,n),e.prototype.render=function(){if(this.props.isLoading)return I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));if(0===this.props.boards.length)return I.createElement("div",{style:{marginTop:"2rem",textAlign:"center"}},"没有关注");for(var e=this.props.boards.map(function(e){return I.createElement(bo,{key:e.id,UserFavoritesBoard:e})}),t=1;t<e.length;t+=2)e.splice(t,0,I.createElement("hr",{key:t}));return I.createElement("div",null,e)},e}(I.Component);var Eo,Io,wo=Object(Nr.b)(function(e){return{boards:e.userInfo.currentUserFavoriteBoards,isLoading:e.userInfo.isLoading}},function(e){return{getInfo:function(){e(function(l,u){return x.b(void 0,void 0,void 0,function(){var n,t,a,r,s,o,i,c;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),l(K()),n=u().userInfo.currentUserInfo.customBoards,t=u().userInfo.currentUserFavoriteBoards.map(function(e){return e.id}),n.length!==t.length||t.some(function(e,t){return e!==n[t]})?(a=u().userInfo.currentUserInfo.customBoards.join("&id="),r="/board/?id="+a,[4,Xn()]):[2,l(X())];case 1:return s=e.sent(),[4,Zn(r,{headers:s})];case 2:if(200!==(o=e.sent()).status)throw new Error(o.statusText);return[4,o.json()];case 3:return i=e.sent(),l(re(i)),[2,l(X())];case 4:return c=e.sent(),[2,l(ae(c.message))];case 5:return[2]}})})})},changePage:function(){e(me("myfavoriteboards"))}}})(yo),Co=Br.a.Search,No=Ar.a.Option;(Io=Eo||(Eo={}))[Io.PostTime=0]="PostTime",Io[Io.LastReply=1]="LastReply",Io[Io.FavorTime=2]="FavorTime";var To=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.keyword="",n.changeOrderAndKeyword=function(e,t){void 0===t&&(t=""),t?(n.props.getInfo(1,0,!0,t),n.props.history.push("/usercenter/myfavorites/order/0/1?keyword="+t)):(n.props.getInfo(1,e,!0),n.keyword="",n.props.history.push("/usercenter/myfavorites/order/"+e+"/1"))},n.getkeyword=function(){var e=n.props.location.search;return e&&function(e){for(var t={},n=0,a=e.replace("?","").split("&");n<a.length;n++){var r=a[n].split("="),s=r[0],o=r[1];t[s]=decodeURI(o)}return t}(e).keyword||""},n}return x.c(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.match.params.page!==e.match.params.page||this.props.match.params.order!==e.match.params.order){var t=parseInt(e.match.params.page)||1;this.props.getInfo(t,Number(e.match.params.order),!0,this.keyword),window.scroll(0,0)}},t.prototype.componentDidMount=function(){var e=Number(this.props.match.params.page||"1"),t=Number(this.props.match.params.order),n=this.getkeyword();t!==Eo.LastReply&&""!==n&&this.props.history.replace("/usercenter/myfavorites/order/0/1?keyword="+n),this.keyword=n,this.props.getInfo(e,t,!0,this.keyword),this.props.changePage()},t.prototype.render=function(){var t=this;if(this.props.isLoading)return I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}));for(var e=I.createElement("div",{className:"user-posts",style:{textAlign:"center"}},"没有主题"),n=parseInt(this.props.match.params.page)||1,a=this.props.hasTotal?this.props.totalPage:n+1,r=this.props.currentUserFavoriteTopics.map(function(e){return I.createElement(Hs,{key:e.id,userRecentTopic:e})}),s=1;s<r.length;s+=2)r.splice(s,0,I.createElement("hr",{key:s}));var o=Number(this.props.match.params.order);return I.createElement("div",{className:"user-posts"},I.createElement("div",{className:"user-post-operator"},I.createElement(Ar.a,{value:o,style:{width:180,marginRight:40},onChange:function(e){t.changeOrderAndKeyword(e)}},I.createElement(No,{value:Eo.PostTime},"按发帖时间排序"),I.createElement(No,{value:Eo.LastReply},"按最后回复排序"),I.createElement(No,{value:Eo.FavorTime},"按收藏顺序排序")),I.createElement(Co,{defaultValue:this.keyword,placeholder:"输入关键词",onSearch:function(e){t.keyword=e,t.changeOrderAndKeyword(o,e)},style:{width:280},enterButton:I.createElement(xn.a,{type:"primary",style:{width:60}},"搜索")}),I.createElement("div",{className:"user-post-operator-tips"},"收藏搜索目前只能按照最后回复排序")),I.createElement("hr",null),0===this.props.currentUserFavoriteTopics.length?e:I.createElement(I.Fragment,null,r,I.createElement(to,{currentPage:n,totalPage:a,href:"/usercenter/myfavorites/order/"+o+"/",hasTotal:this.props.hasTotal,keyword:this.keyword})))},t}(I.Component);var So=Object(Nr.b)(function(e){return{currentUserFavoriteTopics:e.userInfo.currentUserFavoriteTopics,totalPage:e.userInfo.totalPage.myfavoriteposts,hasTotal:e.userInfo.hasTotal.myfavoriteposts,isLoading:e.userInfo.isLoading}},function(r){return{changePage:function(){r(me("myfavoriteposts"))},getInfo:function(e,t,n,a){var d,h,f,g;void 0===a&&(a=""),r((d=e,void 0===(h=t)&&(h=0),void 0===(f=n)&&(f=!1),void 0===(g=a)&&(g=""),function(m,p){return x.b(void 0,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u;return x.d(this,function(e){switch(e.label){case 0:if(e.trys.push([0,4,,5]),t=10*(d-1),n="",n=g?"/topic/me/search-favorite?from="+t+"&size=11&keyword="+g:"/topic/me/favorite?from="+t+"&size=11&order="+h,m(K()),p().userInfo,a=p().userInfo.currentUserFavoriteTopics,r=p().userInfo.hasTotal.myfavoriteposts,!f){for(s=a.length<10*(d-1)+1&&!r,o=10*(d-1);o<Math.min(a.length,10*d);o++)if(!a[o]){s=!0;break}if(!s)return[2,m(X())]}return[4,Xn()];case 1:return i=e.sent(),[4,Zn(n,{headers:i})];case 2:if(200!==(c=e.sent()).status)throw new Error(c.statusText);return[4,c.json()];case 3:return 11===(l=e.sent()).length||l.length,11!==l.length&&m(ee(d)),a.splice(0,a.length),l.forEach(function(e){a.push(e)}),[2,m(X())];case 4:return u=e.sent(),[2,m(ae(u.message))];case 5:return[2]}})})}))}}})(Object(Tr.a)(To)),xo=function(n){function e(e){var t=n.call(this,e)||this;return t.state={userNames:"",wealth:"",reason:"",info:""},t.handleSubmit=t.handleSubmit.bind(t),t.handleWealthChange=t.handleWealthChange.bind(t),t}return x.c(e,n),e.prototype.handleSubmit=function(e){if(e.preventDefault(),!this.props.isLoading)try{this.props.solveError();var t=Number.parseFloat(this.state.wealth);if(!this.state.userNames)throw new Error("请输入收款人信息");if(this.state.wealth.match(/[^\d\.]/)||t<10)throw new Error("请输入合法的金额");if(!this.state.reason)throw new Error("请输入理由");var n=this.state.userNames.split(/\s+/);if(""===n[n.length-1]&&n.pop(),n=Array.from(new Set(n)),this.props.userInfo.wealth<t*n.length)throw new Error("财富值不足");this.setState({info:"转账中"}),this.props.sendWealthTo(n,t,this.state.reason)}catch(e){this.setState({info:e.message})}},e.prototype.componentWillReceiveProps=function(e){!e.isLoading&&this.props.isLoading&&this.setState({info:"成功给"+e.successNames.join(" ")+"转账了总计"+Number.parseFloat(this.state.wealth)*e.successNames.length+"个财富值"}),e.isError&&!this.props.isError&&this.setState({info:e.errorMessage})},e.prototype.handleWealthChange=function(e,t){var n=Number.parseFloat(e);if(""!==t&&""!==e)if(e.match(/[^\d\.]/))this.setState({wealth:e,info:"请输入数值",userNames:t});else if(n<10)this.setState({wealth:e,info:"请输入大于10的金额",userNames:t});else{var a=t.split(/\s+/);""===a[a.length-1]&&a.pop(),a=Array.from(new Set(a));var r="你总共有"+this.props.userInfo.wealth+"个财富值，";r+="共将扣除"+n*a.length+"个财富值，",1<a.length?r+=a.join("与")+"将各收到":r+=a+"将收到",r+=n-Math.max(Math.floor(.1*n),10)+"个财富值",this.setState({wealth:e,info:r,userNames:t})}else this.setState({userNames:t,wealth:e,info:""})},e.prototype.render=function(){var t=this;return I.createElement("div",{className:"user-center-transfer-wealth"},I.createElement("h2",null,"转账"),I.createElement("form",{onSubmit:this.handleSubmit},I.createElement("div",{className:"transfer-wealth-input"},I.createElement("p",null,"收款人"),I.createElement("input",{style:{width:"30rem"},type:"text",name:"user-names",value:this.state.userNames,onChange:function(e){return t.handleWealthChange(t.state.wealth,e.target.value)}})),I.createElement("div",{className:"transfer-wealth-input"},I.createElement("p",null,"金额"),I.createElement("input",{type:"text",name:"wealth",value:this.state.wealth,onChange:function(e){return t.handleWealthChange(e.target.value,t.state.userNames)}})),I.createElement("div",{className:"transfer-wealth-input"},I.createElement("p",null,"理由"),I.createElement("input",{style:{width:"30rem"},type:"text",name:"reason",value:this.state.reason,onChange:function(e){return t.setState({reason:e.target.value})}})),I.createElement("div",{className:"transfer-wealth-input"},I.createElement("p",null,"说明"),I.createElement("ul",{style:{marginLeft:"2.5rem"}},I.createElement("li",null,"转账需要收取一定的手续费，手续费金额为",I.createElement("strong",null,"10% 或者 10 中的较大值"),"。"),I.createElement("li",null,"转账手续费从转账金额中收取，因此对方实际收到的金额会少于您输入的金额。"),I.createElement("li",null,"转账的最小金额不能小于 ",I.createElement("strong",null,"10")),I.createElement("li",null,"可以对多人转账，请在收款人一栏用空格隔开每个用户。多人转账时每个用户都会收到您指定的金额并单独扣除手续费。您最多可以同时向 ",I.createElement("strong",null,"10")," 个用户进行转账。"))),I.createElement("button",{type:"submit",disabled:this.props.isLoading},"转账")),I.createElement("p",{className:"transfer-wealth-info"},this.state.info))},e}(I.Component);var ko=Object(Nr.b)(function(e){return{userInfo:e.userInfo.currentUserInfo,isLoading:e.userInfo.isLoading,isError:e.userInfo.isError,errorMessage:e.userInfo.errorMessage,successNames:e.userInfo.transferSuccessUsers}},function(n){return{sendWealthTo:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n(function(l,u,m){return function(i,c){return x.b(void 0,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),i(K()),i(he([])),[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n={userNames:l,wealth:u,reason:m},[4,Zn("/me/transfer-wealth",{method:"PUT",headers:t,body:JSON.stringify(n)})];case 2:if(!(a=e.sent()).ok)throw new Error(a.statusText);return[4,a.json()];case 3:return r=e.sent(),(s=c().userInfo.currentUserInfo).wealth-=r.length*u,i(te(s)),i(he(r)),[2,i(X())];case 4:return o=e.sent(),i(X()),[2,i(ae(o.message))];case 5:return[2]}})})}}.apply(void 0,e))},solveError:function(){n(Z())}}})(xo),Po=["系统默认","冬季","春季（浅色）","春季（深色）","夏季","秋季（橙色）","秋季（红色）","双十一","中秋（暗）","中秋（亮）","小雪（暗）","小雪（亮）","春节（暗）","春节（亮）","清明","端午"],Uo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handleSubmit=function(a){return x.b(e,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,Xn()];case 1:return t=e.sent(),[4,Zn("/me/theme?id="+a,{headers:t,method:"PUT"})];case 2:if(!(n=e.sent()).ok)throw new Error(n.statusText);return this.props.changeUserInfo(x.a({},this.props.userInfo,{theme:a})),or(a),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}})})},e}return x.c(e,t),e.prototype.render=function(){var e=this;return I.createElement("div",{className:"user-theme"},I.createElement("div",{className:"user-theme-info"},I.createElement("h2",null,"切换皮肤"),I.createElement("p",null,"当前皮肤：",Po[this.props.userInfo.theme])),I.createElement("div",{className:"user-theme-config"},I.createElement("button",{style:{backgroundColor:"#ffffff",border:"solid 1px"},key:0,onClick:function(){return e.handleSubmit(0)},disabled:0===this.props.userInfo.theme},"系统默认"),I.createElement("button",{style:{backgroundColor:"#79b8ca"},key:1,onClick:function(){return e.handleSubmit(1)},disabled:1===this.props.userInfo.theme},"冬季"),I.createElement("button",{style:{backgroundColor:"#b1d396"},key:2,onClick:function(){return e.handleSubmit(2)},disabled:2===this.props.userInfo.theme},"春季（浅色）"),I.createElement("button",{style:{backgroundColor:"#95b675"},key:3,onClick:function(){return e.handleSubmit(3)},disabled:3===this.props.userInfo.theme},"春季（深色）"),I.createElement("button",{style:{backgroundColor:"#5198d8"},key:4,onClick:function(){return e.handleSubmit(4)},disabled:4===this.props.userInfo.theme},"夏季")),I.createElement("div",{className:"user-theme-config"},I.createElement("button",{style:{backgroundColor:"#F4A460"},key:5,onClick:function(){return e.handleSubmit(5)},disabled:5===this.props.userInfo.theme},"秋季（橙色）"),I.createElement("button",{style:{backgroundColor:"#B22222"},key:6,onClick:function(){return e.handleSubmit(6)},disabled:6===this.props.userInfo.theme},"秋季（红色）"),I.createElement("button",{style:{backgroundColor:"rgb(240,125,145)"},key:7,onClick:function(){return e.handleSubmit(7)},disabled:7===this.props.userInfo.theme},"双十一交友"),I.createElement("button",{style:{backgroundColor:"rgb(38,118,129)"},key:8,onClick:function(){return e.handleSubmit(8)},disabled:8===this.props.userInfo.theme},"中秋（暗）"),I.createElement("button",{style:{backgroundColor:"rgb(52,150,159)"},key:9,onClick:function(){return e.handleSubmit(9)},disabled:9===this.props.userInfo.theme},"中秋（亮）")),I.createElement("div",{className:"user-theme-config"},I.createElement("button",{style:{backgroundColor:"rgb(3, 57, 117)"},key:10,onClick:function(){return e.handleSubmit(10)},disabled:10===this.props.userInfo.theme},"小雪（暗）"),I.createElement("button",{style:{backgroundColor:"rgb(122, 146, 194)"},key:11,onClick:function(){return e.handleSubmit(11)},disabled:11===this.props.userInfo.theme},"小雪（亮）"),I.createElement("button",{style:{backgroundColor:"rgb(205,0,0)"},key:12,onClick:function(){return e.handleSubmit(12)},disabled:12===this.props.userInfo.theme},"春节（暗）"),I.createElement("button",{style:{backgroundColor:"rgb(214,14,36)"},key:13,onClick:function(){return e.handleSubmit(13)},disabled:13===this.props.userInfo.theme},"春节（亮）"),I.createElement("button",{style:{backgroundColor:"rgb(70, 141, 57)"},key:14,onClick:function(){return e.handleSubmit(14)},disabled:14===this.props.userInfo.theme},"清明")),I.createElement("div",{className:"user-theme-config"},I.createElement("button",{style:{backgroundColor:"rgb(53, 120, 188)"},key:15,onClick:function(){return e.handleSubmit(15)},disabled:15===this.props.userInfo.theme},"端午")))},e}(I.Component);var Mo=Object(Nr.b)(function(e){return{userInfo:e.userInfo.currentUserInfo}},function(t){return{changeUserInfo:function(e){t(te(e))}}})(Uo),Ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"user-center-router"},I.createElement(Yt.a,{exact:!0,path:"/usercenter/",component:Xs}),I.createElement(Yt.a,{path:"/usercenter/myfollowings/:page?",component:ao}),I.createElement(Yt.a,{path:"/usercenter/myfans/:page?",component:so}),I.createElement(Yt.a,{path:"/usercenter/mytopics/:page?",component:io}),I.createElement($t.a,null,I.createElement(Yt.a,{path:"/usercenter/myposts/ishot/:ishot/:page?",component:uo}),I.createElement(Yt.a,{path:"/usercenter/myposts"},I.createElement(zs.a,{to:"/usercenter/myposts/ishot/0"}))),I.createElement($t.a,null,I.createElement(Yt.a,{path:"/usercenter/myfavorites/order/:order/:page?",exact:!0,component:So}),I.createElement(Yt.a,{path:"/usercenter/myfavorites"},I.createElement(zs.a,{to:"/usercenter/myfavorites/order/0"}))),I.createElement(Yt.a,{path:"/usercenter/config",component:vo}),I.createElement(Yt.a,{path:"/usercenter/mycustomboards",component:wo}),I.createElement(Yt.a,{path:"/usercenter/transferwealth",component:ko}),I.createElement(Yt.a,{path:"/usercenter/theme",component:Mo}))},t}(I.Component),Oo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return this.props.isLogOn?I.createElement("div",{className:"user-center"},I.createElement(Wt,{title:"个人中心 - CC98论坛"}),I.createElement("div",{className:"user-center-content"},I.createElement("div",{className:"user-center-head"},I.createElement("p",null,"个人中心")),I.createElement("div",{className:"user-center-body"},I.createElement(_s,null),I.createElement(Ro,null)))):I.createElement(Gt,null)},t}(I.Component);var Do=Object(Nr.b)(function(e){return{isLogOn:e.userInfo.isLogOn}},null)(Oo),jo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=this.props.data;return e.lastContent||(e.lastContent=""),I.createElement("div",{className:"message-message-person"},I.createElement("img",{className:"message-message-pPortraitUrl",src:e.portraitUrl}),I.createElement("div",{className:"message-message-pInfo"},I.createElement("div",{className:"message-message-pName"},e.name),I.createElement("div",{className:"message-message-pMessage"},I.createElement(Ht,{code:e.lastContent}))),I.createElement(Lo,{isRead:e.isRead}))},t}(I.Component),Lo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return this.props.isRead?I.createElement("div",{className:"message-counterPerson displaynone"}):I.createElement("div",{className:"message-counterPerson"})},t}(I.Component),Fo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e,t="/user/id/"+this.props.senderId;return e=this.props.showTime?"message-message-wcTime":"displaynone",I.createElement("div",{className:"message-message-wc"},I.createElement("div",{className:e},Cn(this.props.time).format("YYYY-MM-DD HH:mm:ss")),I.createElement("div",{className:"message-message-wcSender"},I.createElement("a",{href:t,target:"_blank"},I.createElement("img",{className:"message-message-wcPortraitUrl",src:this.props.senderPortraitUrl})),I.createElement("div",{className:"message-message-wcContent"},I.createElement("div",{id:String(this.props.id),className:"message-message-wcText"},I.createElement(Ht,{code:this.props.content})))))},t}(I.Component),Bo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e,t="/user/id/"+this.props.senderId;return e=this.props.showTime?"message-message-wcTime":"displaynone",I.createElement("div",{className:"message-message-wc"},I.createElement("div",{className:e},Cn(this.props.time).format("YYYY-MM-DD HH:mm:ss")),I.createElement("div",{className:"message-message-wcReceiver"},I.createElement("a",{href:t,target:"_blank"},I.createElement("img",{className:"message-message-wcPortraitUrl",src:this.props.senderPortraitUrl})),I.createElement("div",{className:"message-message-wcContent"},I.createElement("div",{className:"message-message-wcText",id:String(this.props.id)},I.createElement(Ht,{code:this.props.content})))))},t}(I.Component),Ao=function(e){return function(a,e){return x.b(void 0,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,Xn()];case 1:return[4,Zn("/me/unread-count",{headers:e.sent()})];case 2:return[4,e.sent().json()];case 3:return Jn("messageCount",t=e.sent()),[2,a(ve(t))];case 4:return n=e.sent(),console.error(n.message),[3,5];case 5:return[2]}})})}},_o=function(t){function e(e){var a=t.call(this,e)||this;return a.coverMessageProps=function(e){var t=Gn("userInfo"),n=a.props.data;return e.receiverId==t.id?I.createElement(Bo,{id:e.id,senderName:n.name,senderId:n.id,receiverName:t.name,receiverId:t.id,senderPortraitUrl:n.portraitUrl,receiverPortraitUrl:t.portraitUrl,content:e.content,isRead:e.isRead,time:e.time,showTime:e.showTime}):e.senderId==t.id?I.createElement(Fo,{id:e.id,senderName:t.name,senderId:t.id,receiverName:n.name,receiverId:n.id,senderPortraitUrl:t.portraitUrl,receiverPortraitUrl:n.portraitUrl,content:e.content,isRead:e.isRead,time:e.time,showTime:e.showTime}):void 0},a.report=function(){alert("举报他人恶意私信请到【论坛事务】按照格式发帖投诉，记得截图保留证据，管理员会及时进行处理！感谢您对CC98的支持！")},a.state={data:[]},a.getNewMessage=a.getNewMessage.bind(a),a.postMessage=a.postMessage.bind(a),a.getMoreMessage=a.getMoreMessage.bind(a),a}return x.c(e,t),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getData(this.props),[2]})})},e.prototype.getData=function(i){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return i.data?[4,ga(i.data.id,0,10,this.context.router)]:[3,2];case 1:if(t=e.sent(),0!=(n=Cr.getState().message)&&0!=n.messageCount&&Cr.dispatch(Ao()),t&&0<t.length){if((a=i.data.message)&&0<a.length)for(s in t)if(t[s].id==a[0].id){t=va(t=t.slice(0,s).concat(a));break}if(r=Yn("recentContact")){for(s in r)if(r[s].id==i.data.id){r[s].message=t;break}$n("recentContact",r)}this.setState({data:t.reverse()}),10===t.length?($("#wcGetMore").removeClass("displaynone"),$("#wcLoadingImg").addClass("displaynone"),$("#wcLoadingText").addClass("displaynone")):($("#wcGetMore").addClass("displaynone"),$("#wcLoadingImg").addClass("displaynone"),$("#wcLoadingText").removeClass("displaynone"))}e.label=2;case 2:return(o=document.getElementById("messageContent")).scrollTop=o.scrollHeight,[2]}})})},e.prototype.componentWillReceiveProps=function(t){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getData(t),[2]})})},e.prototype.getMoreMessage=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l;return x.d(this,function(e){switch(e.label){case 0:return $("#wcGetMore").addClass("displaynone"),$("#wcLoadingImg").removeClass("displaynone"),t=this.state.data.reverse(),n=document.getElementById("messageContent"),a=n.scrollHeight,[4,ga(this.props.data.id,t.length,10,this.context.router)];case 1:if(r=e.sent(),0!=(s=Cr.getState().message)&&0!=s.messageCount&&Cr.dispatch(Ao()),r&&0<r.length){if(o=va(o=t.concat(r)),this.setState({data:o.reverse()}),i=Yn("recentContact")){for(c in i)if(i[c].id==this.props.data.id){i[c].message=o;break}$n("recentContact",i)}10===r.length?($("#wcGetMore").removeClass("displaynone"),$("#wcLoadingImg").addClass("displaynone")):($("#wcLoadingImg").addClass("displaynone"),$("#wcLoadingText").removeClass("displaynone"))}else $("#wcLoadingImg").addClass("displaynone"),$("#wcLoadingText").removeClass("displaynone");return l=n.scrollHeight,n.scrollTop=l-a-25,[2]}})})},e.prototype.getNewMessage=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c;return x.d(this,function(e){switch(e.label){case 0:return[4,ga(this.props.data.id,0,10,this.context.router)];case 1:if(t=e.sent(),n=[],a=Yn("recentContact")){for(r=0;r<a.length;r++)if(a[r].id==this.props.data.id){if((n=a[r].message)!=[])for(s=0;s<t.length;s++)if(t[s].id==n[0].id){t=va(t=t.slice(0,s).concat(n));break}a[r].message=t,a[r].lastContent=t[0].content;break}r==a.length?((o=[this.props.data])[0].message=t,o[0].lastContent=t[0].content,$n("recentContact",a=o.concat(a))):0==r?($n("recentContact",a),this.setState({data:t.reverse()})):(i=a[r],a.splice(r,1),a.unshift(i),$n("recentContact",a)),this.props.onChange()}return(c=document.getElementById("messageContent")).scrollTop=c.scrollHeight,[2]}})})},e.prototype.handleFocus=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return $("#wPostNotice").addClass("displaynone"),$("#wPostError").addClass("displaynone"),$("#postContent")[0].focus(),[2]})})},e.prototype.handleBlur=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return""==$("#postContent").val()&&("none"==$("#wPostNotice").css("display")?$("#wPostNotice").removeClass("displaynone"):$("#wPostNotice").addClass("displaynone")),[2]})})},e.prototype.postMessage=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return""===(t=$("#postContent").val())?[2]:(n={receiverId:this.props.data.id,content:t},[4,function(a,e){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("content-type","application/json"),[4,Zn("/message",{method:"POST",headers:t,body:a})];case 2:return 401===(n=e.sent()).status&&Cr.dispatch(fe("LogOut")),500===n.status&&Cr.dispatch(fe("ServerError")),[2,n]}})})}(JSON.stringify(n),this.context.router)]);case 1:return 403==e.sent().status?($("#postContent").val(""),$("#wPostError").removeClass("displaynone")):(setTimeout(this.getNewMessage,200),$("#postContent").val("")),[2]}})})},e.prototype.render=function(){var e=this.props.data;return e?I.createElement("div",{className:"message-message-window"},I.createElement(Wt,{title:"与 "+e.name+" 的私信-CC98论坛"}),I.createElement("div",{className:"message-message-wHeader"},I.createElement("div",{className:"message-message-wReport"}),I.createElement("div",{className:"message-message-wTitle"},"与 ",e.name," 的私信"),I.createElement("div",{className:"message-message-wReport displaynone"},I.createElement("button",{onClick:this.report},"举报"))),I.createElement("div",{className:"message-message-wContent",id:"messageContent"},I.createElement("div",{className:"message-message-wcLoading"},I.createElement("div",{id:"wcGetMore",className:"message-message-wcLoadingMore",onClick:this.getMoreMessage},"点击加载更多..."),I.createElement("img",{src:"http://file.cc98.org/uploadfile/2017/11/19/2348481046.gif",id:"wcLoadingImg",className:"displaynone"}),I.createElement("div",{id:"wcLoadingText",className:"message-message-wcLoadingText displaynone"},"没有更多消息了~")),this.state.data.map(this.coverMessageProps)),I.createElement("div",{className:"message-message-wPost"},I.createElement("textarea",{className:"message-message-wPostArea",id:"postContent",onFocus:this.handleFocus,onBlur:this.handleBlur}),I.createElement("div",{id:"wPostNotice",className:"message-message-wPostNotice",onClick:this.handleFocus},"请在这里填入您要发送的私信内容"),I.createElement("div",{id:"wPostError",className:"message-message-wPostError displaynone",onClick:this.handleFocus},"您的发送过快，请稍作歇息~"),I.createElement("button",{className:"message-message-wPostBtn",onClick:this.postMessage},"发送"))):I.createElement("div",{className:"message-message-window"},I.createElement("div",{className:"message-message-wHeader"},I.createElement("div",{className:"message-message-wReport"}),I.createElement("div",{className:"message-message-wTitle"},"无当前聊天对象"),I.createElement("div",{className:"message-message-wReport displaynone"},I.createElement("button",{onClick:this.report},"举报"))),I.createElement("div",{className:"message-message-wContent",id:"messageContent"},I.createElement("div",{className:"message-message-wcLoading"},I.createElement("img",{src:"http://file.cc98.org/uploadfile/2017/11/19/2348481046.gif",id:"wcLoadingImg",className:"displaynone"}),I.createElement("div",{id:"wcLoadingText",className:"message-message-wcLoadingText displaynone"},"没有更多消息了~"))),I.createElement("div",{className:"message-message-wPost"},I.createElement("textarea",{className:"message-message-wPostArea",id:"postContent",onFocus:this.handleFocus,onBlur:this.handleBlur}),I.createElement("div",{id:"wPostNotice",className:"message-message-wPostNotice",onClick:this.handleFocus},"请在这里填入您要发送的私信内容"),I.createElement("div",{id:"wPostError",className:"message-message-wPostError displaynone",onClick:this.handleFocus},"您的发送过快，请稍作歇息~"),I.createElement("button",{className:"message-message-wPostBtn",onClick:this.postMessage},"发送")))},e}(I.Component),zo=function(n){function e(e){var t=n.call(this,e)||this;return t.coverMessagePerson=function(n){var a=t,r=Yn("recentContact");return I.createElement("div",{onClick:function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){for(t in a.setState({chatObj:n}),$(".message-message-pList > div").removeClass("message-message-pFocus"),$("#contact_"+n.id).addClass("message-message-pFocus"),r)r[t].id===n.id&&!1===r[t].isRead&&(r[t].isRead=!0,$n("recentContact",r),a.setState({data:r}));return[2]})})},id:"contact_"+n.id},I.createElement(jo,{data:n}))},t.state={data:null,chatObj:null},t.getMoreContact=t.getMoreContact.bind(t),t.onChange=t.onChange.bind(t),t}return x.c(e,n),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return Gn("accessToken"),Gn("userInfo"),"message-counterNav"===$("#unreadCount-messageCount1").attr("class")&&qn("recentContact"),(t=Yn("recentContact"))&&0!==t.length?[3,2]:[4,fa(0,7,this.context.router)];case 1:$n("recentContact",t=e.sent()),e.label=2;case 2:return[4,function(g,e){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f;return x.d(this,function(e){switch(e.label){case 0:if(!(t=location.href.match(/id=(\d+)/)))return[3,18];if(n=parseInt(t[1]),g&&0!==g.length)return[3,8];h=r=void 0,d=1,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,Zn("/user/basic/"+n)];case 2:return 404===(r=e.sent()).status&&Cr.dispatch(fe("NotFoundUser")),500===r.status&&Cr.dispatch(fe("ServerError")),[4,r.json()];case 3:return h=e.sent(),[3,5];case 4:return e.sent(),Cr.dispatch(fe("Disconnected")),d=0,[3,5];case 5:return 1!==d?[3,7]:[4,ga((a=h).id,0,10)];case 6:a.message=e.sent(),h.message&&(h.lastContent=h.message[0]),h.isRead=!0,g=[h],e.label=7;case 7:return[3,17];case 8:for(l=0;l<g.length&&g[l].id!=n;l++);return 0!=l?[3,9]:(g[0].isRead=!0,[3,17]);case 9:return l<g.length?((u=g[l]).isRead=!0,g.splice(l,1),g.unshift(u),[3,17]):[3,10];case 10:h=r=void 0,d=1,e.label=11;case 11:return e.trys.push([11,14,,15]),[4,Zn("/user/basic/"+n)];case 12:return 401===(r=e.sent()).status&&Cr.dispatch(fe("UnauthorizedTopic")),403===r.status&&Cr.dispatch(fe("OperationForbidden")),404===r.status&&Cr.dispatch(fe("NotFoundTopic")),500===r.status&&Cr.dispatch(fe("ServerError")),[4,r.json()];case 13:return h=e.sent(),[3,15];case 14:return e.sent(),Cr.dispatch(fe("Disconnected")),d=0,[3,15];case 15:return 1!==d?[3,17]:[4,ga((s=h).id,0,10)];case 16:s.message=e.sent(),h.message&&(h.lastContent=h.message[0]),h.isRead=!0,g=[h].concat(g),e.label=17;case 17:return[3,35];case 18:if(!(o=location.href.match(/name=(\S+)/)))return[3,35];if(o[1],i=o[1],g&&0!==g.length)return[3,26];p=m=void 0,d=1,e.label=19;case 19:return e.trys.push([19,22,,23]),[4,Zn("/user/name/"+encodeURIComponent(i))];case 20:switch((m=e.sent()).status){case 401:Cr.dispatch(fe("LogOut"));case 403:Cr.dispatch(fe("OperationForbidden"));case 404:Cr.dispatch(fe("NotFoundTopic"));case 500:Cr.dispatch(fe("ServerError"))}return[4,m.json()];case 21:return p=e.sent(),[3,23];case 22:return e.sent(),Cr.dispatch(fe("Disconnected")),d=0,[3,23];case 23:return 1!=d?[3,25]:(h={id:p.id,name:p.name,portraitUrl:p.portraitUrl,message:[],lastContent:"",isRead:!0},[4,ga((c=h).id,0,10)]);case 24:c.message=e.sent(),h.message&&(h.lastContent=h.message[0]),g=[h],e.label=25;case 25:return[3,35];case 26:for(l=0;l<g.length&&g[l].name!=i;l++);return 0!=l?[3,27]:[3,35];case 27:return l<g.length?(u=g[l],g.splice(l,1),g.unshift(u),[3,35]):[3,28];case 28:p=m=void 0,d=1,e.label=29;case 29:return e.trys.push([29,32,,33]),[4,Zn("/user/name/"+encodeURIComponent(i))];case 30:switch((m=e.sent()).status){case 401:Cr.dispatch(fe("UnauthorizedTopic"));case 403:Cr.dispatch(fe("OperationForbidden"));case 404:Cr.dispatch(fe("NotFoundTopic"));case 500:Cr.dispatch(fe("ServerError"))}return[4,m.json()];case 31:return p=e.sent(),[3,33];case 32:return e.sent(),Cr.dispatch(fe("Disconnected")),d=0,[3,33];case 33:return 1!=d?[3,35]:(h={id:p.id,name:p.name,portraitUrl:p.portraitUrl,message:[],lastContent:"",isRead:!0},[4,ga((f=h).id,0,10)]);case 34:f.message=e.sent(),h.message&&(h.lastContent=h.message[0]),g=[h].concat(g),e.label=35;case 35:return[2,g]}})})}(t,this.context.router)];case 3:return(t=e.sent())&&this.setState({data:t,chatObj:t[0]}),(n=this.state.chatObj)&&$("#"+n.name).addClass("message-message-pFocus"),[2]}})})},e.prototype.getMoreContact=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return"none"!=$("#moreDone").css("display")?[3,2]:($("#moreImg").removeClass("displaynone"),$("#moreDot").addClass("displaynone"),$("#moreShow").addClass("displaynone"),[4,fa((t=Yn("recentContact")).length,7,this.context.router)]);case 1:n=e.sent(),t=t.concat(n),this.setState({data:t}),$n("recentContact",t),n.length<7?($("#moreImg").addClass("displaynone"),$("#moreDone").removeClass("displaynone")):($("#moreImg").addClass("displaynone"),$("#moreDot").removeClass("displaynone"),$("#moreShow").removeClass("displaynone")),e.label=2;case 2:return[2]}})})},e.prototype.onChange=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){return t=Yn("recentContact"),this.setState({data:t,chatObj:t[0]}),$(".message-message-pList > div").removeClass("message-message-pFocus"),$("#"+this.state.chatObj.name).addClass("message-message-pFocus"),[2]})})},e.prototype.render=function(){$(".message-nav > div").removeClass("message-nav-focus"),$("#message").addClass("message-nav-focus");var e=this.state.data,t=this.state.chatObj;return e?6<e.length?I.createElement("div",{className:"message-message"},I.createElement(Wt,{title:"我的私信-CC98论坛"}),I.createElement("div",{className:"message-message-people"},I.createElement("div",{className:"message-message-pTitle"},"近期私信"),I.createElement("div",{className:"message-message-pList"},e.map(this.coverMessagePerson),I.createElement("div",{className:"message-message-plMore",onClick:this.getMoreContact},I.createElement("img",{id:"moreImg",src:"http://file.cc98.org/uploadfile/2017/11/19/2348481046.gif",className:"displaynone"}),I.createElement("div",{id:"moreDot"},"..."),I.createElement("div",{id:"moreShow"},"显示更多小伙伴~"),I.createElement("div",{id:"moreDone",className:"displaynone"},"小伙伴们都出来了~")))),I.createElement(_o,{data:t,onChange:this.onChange})):I.createElement("div",{className:"message-message"},I.createElement("div",{className:"message-message-people"},I.createElement("div",{className:"message-message-pTitle"},"近期私信"),I.createElement("div",{className:"message-message-pList"},e.map(this.coverMessagePerson))),I.createElement(_o,{data:t,onChange:this.onChange})):I.createElement("div",{className:"message-message"},I.createElement("div",{className:"message-message-people"},I.createElement("div",{className:"message-message-pTitle"},"近期私信"),I.createElement("div",{className:"message-message-pList"})),I.createElement(_o,{data:null,onChange:this.onChange}))},e}(I.Component),Vo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e="[url=/board/"+this.props.boardId+"][color=dodgerblue]"+this.props.boardName+"[/color][/url]";0===this.props.boardId&&(e="[color=dodgerblue]"+this.props.boardName+"[/color]");var t,n=this.props.floor/10+1,a=parseInt(n),r=this.props.floor+10-10*a,s=a+"#"+r;if(0===r&&(s=a-1+"#10"),this.props.isRead){t=" "+(0<this.props.userId?"[url=/user/id/"+this.props.userId+"][color=gray]"+this.props.userName+"[/color][/url]":"[color=gray]"+this.props.userName+"[/color]")+" [color=gray]在《"+(this.props.boardId?"[url=/topic/"+this.props.topicId+"/"+s+"][color=#0b5394]"+this.props.topicTitle.replace("\n","")+"[/color][/url]":"[color=#0b5394]"+this.props.topicTitle.replace("\n","")+"}[/color]")+"》中回复了你。[/color]"}else{t=" "+(0<this.props.userId?"[url=/user/id/"+this.props.userId+"][color=gray][b]"+this.props.userName+"[/b][/color][/url]":"[color=gray][b]"+this.props.userName+"[/b][/color]")+" [color=gray][b]在《"+(this.props.boardId?"[url=/topic/"+this.props.topicId+"/"+s+"][color=#0b5394]"+this.props.topicTitle+"[/color][/url]":"[color=#0b5394]"+this.props.topicTitle+"[/color]")+"》中回复了你。[/b][/color]"}return I.createElement("div",{className:"message-response-box"},I.createElement("div",{className:"message-response-box-middle"},I.createElement("div",{className:"message-response-box-middle1"},I.createElement("div",{className:"message-response-box-middle-title"},I.createElement(Ht,{code:e})),I.createElement("div",{className:"message-response-box-middle-date"},Cn(this.props.time).format("YYYY-MM-DD HH:mm:ss"))),I.createElement("div",{className:"message-response-box-middle-content"},I.createElement(Ht,{code:t,options:{allowAutoPlay:!1,autoDetectUrl:!0,allowExternalUrl:!0,allowImage:!1,allowMediaContent:!1,compatibility:V.Recommended,allowEmotion:!1,allowExternalImage:!1,allowToolbox:!1}}))))},t}(I.Component),Ho=function(a){function e(e,t){var n=a.call(this,e,t)||this;return n.coverMessageResponse=function(e){return I.createElement(Vo,{id:e.id,type:e.type,time:e.time,topicId:e.topicId,topicTitle:e.topicTitle,floor:e.floor,userId:e.userId,userName:e.userName,boardId:e.boardId,boardName:e.boardName,isRead:e.isRead})},n.state={data:[],from:0,loading:!0,totalPage:1},n}return x.c(e,a),e.prototype.getData=function(o){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return t=10,$(".message-nav > div").removeClass("message-nav-focus"),$("#response").addClass("message-nav-focus"),[4,Aa(1)];case 1:return n=e.sent(),a=parseInt((n-.5)/t)+1,(!(r=o.match.params.page-1)||r<0)&&(r=0),[4,function(g,v,e){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,10,,11]),t=[],[4,Xn()];case 1:return n=e.sent(),[4,Zn("/notification/reply?from="+g+"&size="+v,{headers:n})];case 2:switch((a=e.sent()).status){case 401:return ha()?Cr.dispatch(fe("UnauthorizedTopic")):Cr.dispatch(fe("LogOut")),[2,[]];case 403:return Cr.dispatch(fe("OperationForbidden")),[2,[]];case 404:return Cr.dispatch(fe("NotFoundTopic")),[2,[]];case 500:return Cr.dispatch(fe("ServerError")),[2,[]]}return[4,a.json()];case 3:for(r=e.sent(),s=[],o=0,i=r;o<i.length;o++)(c=i[o]).topicId&&s.push(c.topicId);return[4,tr(s)];case 4:if(l=e.sent(),!r)return[3,9];for(m in u=[],r)u.push(m);p=0,e.label=5;case 5:return p<u.length?(d=u[p],r[d].topicId?(h=nr(r[d].topicId,l),r[d].topicTitle=h.title,r[d].boardId=h.boardId,f=r[d],[4,da(r[d].boardId)]):[3,7]):[3,9];case 6:f.boardName=e.sent(),e.label=7;case 7:r[d].postId?(r[d].floor=r[d].postBasicInfo.floor,r[d].userId=r[d].postBasicInfo.userId,r[d].userName=r[d].postBasicInfo.userName):(r[d].floor=1,r[d].userId=-1,r[d].userName="有人"),t.push(r[d]),e.label=8;case 8:return p++,[3,5];case 9:return[2,t];case 10:return e.sent(),[3,11];case 11:return[2]}})})}(r*t,t,this.context.router)];case 2:return(s=e.sent())&&this.setState({data:s,from:r+1,totalPage:a}),0==r&&$n("responseState",{data:s,from:r+1,totalPage:a}),[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){return t=Cr.getState().message,n=Yn("responseState"),0===t.replyCount&&n?this.setState(n):this.getData(this.props),[2]})})},e.prototype.componentWillReceiveProps=function(t){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getData(t),[2]})})},e.prototype.render=function(){return I.createElement("div",{className:"message-right"},I.createElement(Wt,{title:"回复我的-CC98论坛"}),I.createElement("div",{className:"message-response"},this.state.data.map(this.coverMessageResponse)),I.createElement("div",{className:"message-pager"},I.createElement(Jt,{url:"/message/response/",page:this.state.from,totalPage:this.state.totalPage})))},e}(I.Component),Wo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e="[url=/board/"+this.props.boardId+"][color=dodgerblue]"+this.props.boardName+"[/color][/url]";0===this.props.boardId&&(e="[color=dodgerblue]"+this.props.boardName+"[/color]");var t,n=this.props.floor/10+1,a=parseInt(n),r=this.props.floor+10-10*a,s=a+"#"+r;if(0===r&&(s=a-1+"#10"),this.props.isRead){t=" "+(0<this.props.userId?"[url=/user/id/"+this.props.userId+"][color=gray]"+this.props.userName+"[/color][/url]":"[color=gray]"+this.props.userName+"[/color]")+" [color=gray]在《"+(this.props.boardId?"[url=/topic/"+this.props.topicId+"/"+s+"][color=#0b5394]"+this.props.topicTitle.replace("\n","")+"[/color][/url]":"[color=#0b5394]"+this.props.topicTitle.replace("\n","")+"[/color]")+"》中@了你。[/color]"}else{t=" "+(0<this.props.userId?"[url=/user/id/"+this.props.userId+"][color=gray][b]"+this.props.userName+"[/b][/color][/url]":"[color=gray][b]"+this.props.userName+"[/b][/color]")+" [color=gray][b]在《"+(this.props.boardId?"[url=/topic/"+this.props.topicId+"/"+s+"][color=#0b5394]"+this.props.topicTitle+"[/color][/url]":"[color=#0b5394]"+this.props.topicTitle+"[/color]")+"》中@了你。[/b][/color]"}return I.createElement("div",{className:"message-response-box"},I.createElement("div",{className:"message-response-box-middle"},I.createElement("div",{className:"message-response-box-middle1"},I.createElement("div",{className:"message-response-box-middle-title"},I.createElement(Ht,{code:e})),I.createElement("div",{className:"message-response-box-middle-date"},Cn(this.props.time).format("YYYY-MM-DD HH:mm:ss"))),I.createElement("div",{className:"message-response-box-middle-content"},I.createElement(Ht,{code:t,options:{allowExternalImage:!1,allowAutoPlay:!1,autoDetectUrl:!0,allowExternalUrl:!0,allowImage:!1,allowMediaContent:!1,compatibility:V.Recommended,allowEmotion:!1,allowToolbox:!1}}))))},t}(I.Component),$o=function(n){function e(e){var t=n.call(this,e)||this;return t.coverMessageAttme=function(e){return I.createElement(Wo,{id:e.id,type:e.type,time:e.time,topicId:e.topicId,topicTitle:e.topicTitle,floor:e.floor,userId:e.userId,userName:e.userName,boardId:e.boardId,boardName:e.boardName,isRead:e.isRead})},t.state={data:[],from:0,loading:!0,totalPage:1},t}return x.c(e,n),e.prototype.getData=function(o){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return t=10,$(".message-nav > div").removeClass("message-nav-focus"),$("#attme").addClass("message-nav-focus"),[4,Aa(2)];case 1:return n=e.sent(),a=parseInt((n-.5)/t)+1,(!(r=o.match.params.page-1)||r<0)&&(r=0),[4,function(v,b,e){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f,g;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,10,,11]),t=[],[4,Kn()];case 1:return n=e.sent(),(a=new Headers).append("Authorization",n),[4,Zn("/notification/at?from="+v+"&size="+b,{headers:a})];case 2:switch((r=e.sent()).status){case 401:return ha()?Cr.dispatch(fe("UnauthorizedTopic")):Cr.dispatch(fe("LogOut")),[2,[]];case 403:return Cr.dispatch(fe("OperationForbidden")),[2,[]];case 404:return Cr.dispatch(fe("NotFoundTopic")),[2,[]];case 500:return Cr.dispatch(fe("ServerError")),[2,[]]}return[4,r.json()];case 3:for(s=e.sent(),o=[],i=0,c=s;i<c.length;i++)(l=c[i]).topicId&&o.push(l.topicId);return[4,tr(o)];case 4:if(u=e.sent(),!s)return[3,9];for(p in m=[],s)m.push(p);d=0,e.label=5;case 5:return d<m.length?(h=m[d],s[h].topicId?(f=nr(s[h].topicId,u),s[h].topicTitle=f.title,s[h].boardId=f.boardId,g=s[h],[4,da(s[h].boardId)]):[3,7]):[3,9];case 6:g.boardName=e.sent(),e.label=7;case 7:s[h].postId?(s[h].floor=s[h].postBasicInfo.floor,s[h].userId=s[h].postBasicInfo.userId,s[h].userName=s[h].postBasicInfo.userName):(s[h].floor=1,s[h].userId=-1,s[h].userName="有人"),t.push(s[h]),e.label=8;case 8:return d++,[3,5];case 9:return[2,t];case 10:return e.sent(),[3,11];case 11:return[2]}})})}(r*t,t,this.context.router)];case 2:return(s=e.sent())&&this.setState({data:s,from:r+1,totalPage:a}),0==r&&$n("atState",{data:s,from:r+1,totalPage:a}),[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){return t=Cr.getState().message,n=Yn("atState"),0===t.atCount&&n?this.setState(n):this.getData(this.props),[2]})})},e.prototype.componentWillReceiveProps=function(t){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getData(t),[2]})})},e.prototype.render=function(){return I.createElement("div",{className:"message-right"},I.createElement(Wt,{title:"@我的-CC98论坛"}),I.createElement("div",{className:"message-response"},this.state.data.map(this.coverMessageAttme)),I.createElement("div",{className:"message-pager"},I.createElement(Jt,{url:"/message/attme/",page:this.state.from,totalPage:this.state.totalPage})))},e}(I.Component),Yo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e;if(this.props.topicId)if(this.props.floor){var t=this.props.floor/10+1,n=parseInt(t),a=this.props.floor+10-10*n,r=n+"#"+a;0===a&&(r=n-1+"#10"),e=this.props.isRead?"[url=/topic/"+this.props.topicId+"/"+r+"][color=gray]"+this.props.content+"[/color][/url]":"[url=/topic/"+this.props.topicId+"/"+r+"][b][color=black]"+this.props.content+"[/color][/b][/url]"}else e=this.props.isRead?"[url=/topic/"+this.props.topicId+"][color=gray]"+this.props.content+"[/color][/url]":"[url=/topic/"+this.props.topicId+"][b][color=black]"+this.props.content+"[/color][/b][/url]";else e=this.props.isRead?"[color=gray]"+this.props.content+"[/color]":"[color=black][b]"+this.props.content+"[/b][/color]";return I.createElement("div",{className:"message-system-box"},I.createElement("div",{className:"message-system-box-bar"},I.createElement("div",{className:"message-system-box-title"},this.props.title),I.createElement("div",{className:"message-system-box-date"},Cn(this.props.time).format("YYYY-MM-DD HH:mm:ss"))),I.createElement("div",{className:"message-system-box-content"},I.createElement(Ht,{code:e,options:{allowExternalImage:!1,allowAutoPlay:!1,autoDetectUrl:!0,allowExternalUrl:!0,allowImage:!0,allowMediaContent:!1,compatibility:V.Recommended,allowEmotion:!1,allowToolbox:!1}})))},t}(I.Component),qo=function(n){function e(e){var t=n.call(this,e)||this;return t.coverMessageSystem=function(e){return I.createElement(Yo,{id:e.id,type:e.type,title:e.title,content:e.content,time:e.time,topicId:e.topicId,floor:e.floor,isRead:e.isRead})},t.state={data:[],from:0,loading:!0,totalPage:1},t}return x.c(e,n),e.prototype.getData=function(o){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return t=10,$(".message-nav > div").removeClass("message-nav-focus"),$("#system").addClass("message-nav-focus"),[4,Aa(3)];case 1:return n=e.sent(),a=parseInt((n-.5)/t)+1,(!(r=o.match.params.page-1)||r<0)&&(r=0),[4,function(s,o,e){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:t=e.sent(),e.label=2;case 2:return e.trys.push([2,5,,6]),[4,Zn("/notification/system?from="+s+"&size="+o,{headers:t})];case 3:switch((n=e.sent()).status){case 401:return ha()?Cr.dispatch(fe("UnauthorizedTopic")):Cr.dispatch(fe("LogOut")),[2,null];case 403:return Cr.dispatch(fe("OperationForbidden")),[2,null];case 404:return Cr.dispatch(fe("NotFoundTopic")),[2,null];case 500:return Cr.dispatch(fe("ServerError")),[2,null]}return[4,n.json()];case 4:return a=e.sent(),[3,6];case 5:return e.sent(),[2,[]];case 6:for(r in a)a[r].postId?a[r].floor=a[r].postBasicInfo.floor:a[r].floor=0;return[2,a]}})})}(r*t,t,this.context.router)];case 2:return(s=e.sent())&&this.setState({data:s,from:r+1,totalPage:a}),0==r&&$n("systemState",{data:s,from:r+1,totalPage:a}),[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){return t=Cr.getState().message,n=Yn("systemState"),0===t.systemCount&&n?this.setState(n):this.getData(this.props),[2]})})},e.prototype.componentWillReceiveProps=function(t){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getData(t),[2]})})},e.prototype.render=function(){return I.createElement("div",{className:"message-right"},I.createElement(Wt,{title:"系统通知-CC98论坛"}),I.createElement("div",{className:"message-system"},this.state.data.map(this.coverMessageSystem)),I.createElement("div",{className:"message-pager"},I.createElement(Jt,{url:"/message/system/",page:this.state.from,totalPage:this.state.totalPage})))},e}(I.Component),Jo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){return(t=Gn("noticeSetting"))?("否"===t.response?($("#responseSetting1").removeAttr("checked"),$("#responseSetting2").attr("checked","checked")):($("#responseSetting1").attr("checked","checked"),$("#responseSetting2").removeAttr("checked")),"否"===t.attme?($("#attmeSetting1").removeAttr("checked"),$("#attmeSetting2").attr("checked","checked")):($("#attmeSetting1").attr("checked","checked"),$("#attmeSetting2").removeAttr("checked")),"否"===t.system?($("#systemSetting1").removeAttr("checked"),$("#systemSetting2").attr("checked","checked")):($("#systemSetting1").attr("checked","checked"),$("#systemSetting2").removeAttr("checked")),"否"===t.message?($("#messageSetting1").removeAttr("checked"),$("#messageSetting2").attr("checked","checked")):($("#messageSetting1").attr("checked","checked"),$("#messageSetting2").removeAttr("checked")),"否"===t.post?($("#postSetting1").removeAttr("checked"),$("#postSetting2").attr("checked","checked")):($("#postSetting1").attr("checked","checked"),$("#postSetting2").removeAttr("checked"))):Jn("noticeSetting",{response:"是",attme:"是",system:"是",message:"是",post:"否"}),[2]})})},t.prototype.setMessageSetting=function(){Jn("noticeSetting",{response:$('input:radio[name="responseSetting"]:checked').val(),attme:$('input:radio[name="attmeSetting"]:checked').val(),system:$('input:radio[name="systemSetting"]:checked').val(),message:$('input:radio[name="messageSetting"]:checked').val(),post:$('input:radio[name="postSetting"]:checked').val()}),sr("saveSuccess")},t.prototype.render=function(){return I.createElement("div",{className:"message-right"},I.createElement(Wt,{title:"消息设置-CC98论坛"}),I.createElement("div",{className:"message-setting"},I.createElement("div",{className:"message-settingbox"},I.createElement("div",{className:"radioTitle"},"是否显示回复通知"),I.createElement("input",{type:"radio",name:"responseSetting",id:"responseSetting1",value:"是",checked:!0}),I.createElement("div",null,"是"),I.createElement("input",{type:"radio",name:"responseSetting",id:"responseSetting2",value:"否"}),I.createElement("div",null,"否")),I.createElement("div",{className:"message-settingbox"},I.createElement("div",{className:"radioTitle"},"是否显示@通知"),I.createElement("input",{type:"radio",name:"attmeSetting",id:"attmeSetting1",value:"是",checked:!0}),I.createElement("div",null,"是"),I.createElement("input",{type:"radio",name:"attmeSetting",id:"attmeSetting2",value:"否"}),I.createElement("div",null,"否")),I.createElement("div",{className:"message-settingbox"},I.createElement("div",{className:"radioTitle"},"是否显示系统通知"),I.createElement("input",{type:"radio",name:"systemSetting",id:"systemSetting1",value:"是",checked:!0}),I.createElement("div",null,"是"),I.createElement("input",{type:"radio",name:"systemSetting",id:"systemSetting2",value:"否"}),I.createElement("div",null,"否")),I.createElement("div",{className:"message-settingbox"},I.createElement("div",{className:"radioTitle"},"是否显示私信通知"),I.createElement("input",{type:"radio",name:"messageSetting",id:"messageSetting1",value:"是",checked:!0}),I.createElement("div",null,"是"),I.createElement("input",{type:"radio",name:"messageSetting",id:"messageSetting2",value:"否"}),I.createElement("div",null,"否")),I.createElement("div",{className:"message-settingbox"},I.createElement("div",{className:"radioTitle"},"回帖是否跳至最新回复"),I.createElement("input",{type:"radio",name:"postSetting",id:"postSetting1",value:"是"}),I.createElement("div",null,"是"),I.createElement("input",{type:"radio",name:"postSetting",id:"postSetting2",value:"否",checked:!0}),I.createElement("div",null,"否")),I.createElement("button",{className:"message-setting-btn",onClick:this.setMessageSetting},"保存消息设置"),I.createElement(Gr,{text:"保存成功",id:"saveSuccess",top:"31%",left:"43%"})))},t}(I.Component),Go=n(1243),Qo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=Cr.getState().message;return I.createElement("div",{className:"message-root"},I.createElement(Wt,{title:"CC98论坛-我的消息"}),I.createElement("div",{className:"message"},I.createElement("div",{className:"readAllMessage"},I.createElement("button",{className:"message-message-wPostBtn",onClick:rr},"全部标为已读")),I.createElement("div",{className:"message-title"},"我的消息"),I.createElement(Go.a,null,I.createElement("div",{className:"message-content"},I.createElement("div",{className:"message-nav"},I.createElement(As.a,{to:"/message/response"},I.createElement("div",{id:"response",className:"nav-div"},"回复我的",I.createElement("div",{className:"message-counterNav displaynone",id:"unreadCount-replyCount1"},e.replyCount))),I.createElement("hr",null),I.createElement(As.a,{to:"/message/attme"},I.createElement("div",{id:"attme",className:"nav-div"},"@ 我的",I.createElement("div",{className:"message-counterNav displaynone",id:"unreadCount-atCount1"},e.atCount))),I.createElement("hr",null),I.createElement(As.a,{to:"/message/system"},I.createElement("div",{id:"system",className:"nav-div"},"系统通知",I.createElement("div",{className:"message-counterNav displaynone",id:"unreadCount-systemCount1"},e.systemCount))),I.createElement("hr",null),I.createElement(As.a,{to:"/message/message"},I.createElement("div",{id:"message",className:"nav-div"},"我的私信",I.createElement("div",{className:"message-counterNav displaynone",id:"unreadCount-messageCount1"},e.messageCount))),I.createElement("hr",null),I.createElement(As.a,{to:"/message/setting"},I.createElement("div",{id:"setting",className:"nav-div"},"消息设置"))),I.createElement(Yt.a,{exact:!0,path:"/message",component:Ho}),I.createElement(Yt.a,{path:"/message/response/:page?",exact:!0,component:Ho}),I.createElement(Yt.a,{path:"/message/attme/:page?",component:$o}),I.createElement(Yt.a,{path:"/message/system/:page?",component:qo}),I.createElement(Yt.a,{path:"/message/message/:page?",component:zo}),I.createElement(Yt.a,{path:"/message/setting",component:Jo})))))},t}(I.Component),Ko=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){this.props.userId||($("#user_"+this.props.id).removeAttr("href"),$("#user_"+this.props.id).removeAttr("target"),$("#lastpost_"+this.props.id).removeAttr("href"),$("#lastpost_"+this.props.id).removeAttr("target"))},t.prototype.render=function(){var e="/topic/"+this.props.id+"/1",t="/user/id/"+this.props.userId,n="/board/"+this.props.boardId,a=this.props.floorCount/10+1,r=parseInt(a),s=this.props.floorCount+10-10*r,o=r+"#"+s;0===s&&(o=r-1+"#10");var i="/topic/"+this.props.id+"/"+o,c="/user/name/"+encodeURI(this.props.lastPostUser),l="",u=this.props.userName;return this.props.tag1?(l=this.props.tag2?"标签："+this.props.tag1+" / "+this.props.tag2:"标签："+this.props.tag1,I.createElement("div",{className:"focus-topic"},I.createElement("a",{className:"focus-topic-left",href:t,target:"_blank",id:"user_"+this.props.id},I.createElement("img",{className:"focus-topic-portraitUrl",src:this.props.portraitUrl}),I.createElement("div",{className:"focus-topic-userName"},u)),I.createElement("div",{className:"focus-topic-middle"},I.createElement("a",{className:"focus-topic-title",href:e,target:"_blank"},this.props.title),I.createElement("div",{className:"focus-topic-info"},I.createElement("div",null,l),I.createElement("div",null,I.createElement("i",{className:"fa fa-clock-o fa-lg"}),this.props.time),I.createElement("div",null,I.createElement("i",{className:"fa fa-eye fa-lg"})," ",this.props.hitCount),I.createElement("div",null,"最后回复：",I.createElement("a",{href:c,target:"_blank",id:"lastpost_"+this.props.id},this.props.lastPostUser)),I.createElement("div",null,I.createElement("a",{href:i,target:"_blank"},this.props.lastPostTime)))),I.createElement("div",{className:"focus-topic-rightBar"}),I.createElement("a",{className:"focus-topic-right",href:n,target:"_blank"},I.createElement("div",{className:"focus-topic-board"},this.props.boardName)))):I.createElement("div",{className:"focus-topic"},I.createElement("a",{className:"focus-topic-left",href:t,target:"_blank",id:"user_"+this.props.id},I.createElement("img",{className:"focus-topic-portraitUrl",src:this.props.portraitUrl}),I.createElement("div",{className:"focus-topic-userName"},this.props.userName)),I.createElement("div",{className:"focus-topic-middle"},I.createElement("a",{className:"focus-topic-title",href:e,target:"_blank"},this.props.title),I.createElement("div",{className:"focus-topic-info"},I.createElement("div",null,I.createElement("i",{className:"fa fa-clock-o fa-lg"}),this.props.time),I.createElement("div",null,I.createElement("i",{className:"fa fa-eye fa-lg"})," ",this.props.hitCount),I.createElement("div",null,"最后回复：",I.createElement("a",{href:c,target:"_blank",id:"lastpost_"+this.props.id},this.props.lastPostUser)),I.createElement("div",null,I.createElement("a",{href:i,target:"_blank"},this.props.lastPostTime)))),I.createElement("div",{className:"focus-topic-rightBar"}),I.createElement("a",{className:"focus-topic-right",href:n,target:"_blank"},I.createElement("div",{className:"focus-topic-board"},this.props.boardName)))},t}(I.Component),Xo=function(a){function e(e){var t=a.call(this,e)||this,n=Yn("AllNewTopic");return n||(n=[]),t.state={data:n,from:0,loading:!0,buttonClassName:""},t.handleScroll=t.handleScroll.bind(t),t}return x.c(e,a),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,ua(0)];case 1:return(t=e.sent())&&($n("AllNewTopic",t),this.setState({data:t,from:t.length})),document.addEventListener("scroll",this.handleScroll),[2]}})})},e.prototype.componentWillUnmount=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return document.removeEventListener("scroll",this.handleScroll),[2]})})},e.prototype.scrollToTop=function(){$("body,html").animate({scrollTop:0},500)},e.prototype.handleScroll=function(){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:if(234<window.pageYOffset&&this.setState({buttonClassName:"btn-show"}),window.pageYOffset<234&&this.setState(function(e){return{buttonClassName:""===e.buttonClassName?"":"btn-disappare"}}),this.state.loading,!Na()||!this.state.loading)return[3,5];if(199<this.state.from)return $("#focus-topic-loading").addClass("displaynone"),$("#focus-topic-loaddone").removeClass("displaynone"),[2];this.setState({loading:!1}),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,function(o,t,i){if(void 0===i&&(i={}),!Number.isFinite(t))throw new TypeError("Expected `wait` to be a finite number");var c,l,u=[];return function(){for(var r=this,s=[],e=0;e<arguments.length;e++)s[e]=arguments[e];return new Promise(function(a){var e=i.leading&&!l;clearTimeout(l),l=setTimeout(function(){l=null;for(var e=i.leading?c:o.apply(r,s),t=0,n=u;t<n.length;t++)(a=n[t])(e);u=[]},t),e?(c=o.apply(r,s),a(c)):u.push(a)})}}(ua,1e3)(this.state.from)];case 2:return t=e.sent(),[3,4];case 3:return e.sent(),this.setState({loading:!0}),[2];case 4:if(!(t&&0<t.length))return this.setState({loading:!0}),[2];for(n=this.state.data,a=0;a<n.length&&n[a].id!==t[0].id;a++);n=n.slice(0,a).concat(t),this.setState({data:n,from:n.length,loading:!0}),$n("AllNewTopic",n),e.label=5;case 5:return[2]}})})},e.prototype.render=function(){return I.createElement("div",{className:"focus-root"},I.createElement(Wt,{title:"查看新帖 - CC98论坛"}),I.createElement("div",{className:"focus"},I.createElement(ei,null),I.createElement("div",{className:"focus-topic-area"},I.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(Zo)),I.createElement("div",{className:"focus-topic-loading",id:"focus-topic-loading"},I.createElement(kn.a,{size:"large"})),I.createElement("div",{className:"focus-topic-loaddone displaynone",id:"focus-topic-loaddone"},"无法加载更多了，小水怡情，可不要沉迷哦~"),I.createElement("button",{type:"button",id:"scrollToTop",className:this.state.buttonClassName,onClick:this.scrollToTop},"回到顶部"))))},e}(I.Component);function Zo(e){return I.createElement(Ko,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}var ei=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"查看新帖"))},t}(I.Component),ti=function(a){function e(e){var t=a.call(this,e)||this,n=Yn("focusBoard_"+t.props.id);return n||(n=[]),t.state={data:n,from:0,loading:!0,buttonClassName:"",stop:!1},t.handleScroll=t.handleScroll.bind(t),t}return x.c(e,a),e.prototype.componentWillReceiveProps=function(t){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getData(t),[2]})})},e.prototype.scrollToTop=function(){$("body,html").animate({scrollTop:0},500)},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getData(this.props),[2]})})},e.prototype.getData=function(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,ma(n.id,n.name,0,this.context.router)];case 1:return(t=e.sent())&&(this.setState({data:t,from:t.length}),$n("focusBoard_"+n.id,t)),document.addEventListener("scroll",this.handleScroll),[2]}})})},e.prototype.componentWillUnmount=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return document.removeEventListener("scroll",this.handleScroll),[2]})})},e.prototype.handleScroll=function(){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:if(234<window.pageYOffset&&this.setState({buttonClassName:"btn-show"}),window.pageYOffset<234&&this.setState(function(e){return{buttonClassName:""===e.buttonClassName?"":"btn-disappare"}}),!Na()||!this.state.loading)return[3,6];if(this.state.stop||199<this.state.from)return $("#focus-topic-loading").addClass("displaynone"),$("#focus-topic-loaddone").removeClass("displaynone"),[2];this.setState({loading:!1}),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,ma(this.props.id,this.props.name,this.state.from,this.context.router)];case 2:return t=e.sent(),[3,5];case 3:return e.sent(),this.setState({loading:!0}),[2];case 4:return 0===t.length&&this.setState({stop:!0}),[7];case 5:if(t&&0<t.length){for(n=this.state.data,a=0;a<n.length&&n[a].id!==t[0].id;a++);n=n.slice(0,a).concat(t),this.setState({data:n,from:n.length,loading:!0}),$n("focusBoard_"+this.props.id,n)}return this.setState({loading:!0}),[2];case 6:return[2]}})})},e.prototype.render=function(){return I.createElement("div",{className:"focus-topic-area"},I.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(ni)),I.createElement("div",{className:"focus-topic-loading",id:"focus-topic-loading"},I.createElement(kn.a,{size:"large"})),I.createElement("div",{className:"focus-topic-loaddone displaynone",id:"focus-topic-loaddone"},"无法加载更多了，小水怡情，可不要沉迷哦~"),I.createElement("button",{type:"button",id:"scrollToTop",className:this.state.buttonClassName,onClick:this.scrollToTop},"回到顶部"))},e}(I.Component);function ni(e){return I.createElement(Ko,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}var ai=function(o){function e(e){var t=o.call(this,e)||this;t.coverFocusBoard=function(e){return I.createElement("div",{className:"focus-board",id:"focusBoard_"+e.id},e.name)};var n=Yn("focusBoardList");n||(n=[]);var a=Yn("currentFocusBoard"),r=0,s="全站帖子";return a&&(r=a.boardId,s=a.boardName),t.state={data:n,currentBoardId:r,currentBoardName:s},t}return x.c(e,o),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l;return x.d(this,function(e){switch(e.label){case 0:t=[],n=Gn("accessToken"),a=Gn("userInfo"),r=a.customBoards,(new Headers).append("Authorization",n),s=0,o=r,e.label=1;case 1:return s<o.length?[4,da(i=o[s])]:[3,4];case 2:c=e.sent(),t.push({id:i,name:c}),e.label=3;case 3:return s++,[3,1];case 4:return this.setState({data:t}),$n("focusBoardList",t),$("#focusBoard_"+this.state.currentBoardId).addClass("focus-hover"),l=this,$(".focus-board").click(function(){var e=this.id.slice(11);$n("currentFocusBoard",{boardId:e,boardName:this.innerHTML}),$(".focus-board").removeClass("focus-hover"),$(this).addClass("focus-hover"),l.setState({currentBoardId:parseInt(e),currentBoardName:this.innerHTML})}),$(".focus-board").dblclick(function(){var e=this.id.slice(11);window.location.href="/board/"+e}),$("#myFocusUser").removeClass("focus-title-hover"),$("#myFocusFavorite").removeClass("focus-title-hover"),$("#myFocusBoard").addClass("focus-title-hover"),[2]}})})},e.prototype.render=function(){return I.createElement("div",null,I.createElement("div",{className:"focus-board-area"},I.createElement("div",{className:"focus-board",id:"focusBoard_0"},"全部帖子"),this.state.data.map(this.coverFocusBoard),I.createElement("div",{className:"focus-boardTip"},"提示：单击版面标签可切换下方展示内容，双击可直接进入版面")),I.createElement(ti,{id:this.state.currentBoardId,name:this.state.currentBoardName}))},e}(I.Component),ri=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){$("#myFocusBoard").removeClass("focus-title-hover"),$("#myFocusFavorite").removeClass("focus-title-hover"),$("#myFocusUser").addClass("focus-title-hover")},t.prototype.render=function(){return I.createElement("div",null,I.createElement(ti,{id:-1,name:"关注用户"}))},t}(I.Component),si=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){$("#myFocusBoard").removeClass("focus-title-hover"),$("#myFocusUser").removeClass("focus-title-hover"),$("#myFocusFavorite").addClass("focus-title-hover")},t.prototype.render=function(){return I.createElement("div",null,I.createElement(ti,{id:-2,name:"收藏主题"}))},t}(I.Component),oi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"focus-root"},I.createElement(Wt,{title:"我的关注 - CC98论坛"}),I.createElement(Go.a,null,I.createElement("div",{className:"focus"},I.createElement("div",{className:"focus-nav"},I.createElement(It.a,{style:{textDecoration:"none"},to:"/focus/board"}," ",I.createElement("div",{className:"focus-title",id:"myFocusBoard"},"关注版面")),I.createElement(It.a,{style:{textDecoration:"none"},to:"/focus/user"}," ",I.createElement("div",{className:"focus-title",id:"myFocusUser"},"关注用户")),I.createElement(It.a,{style:{textDecoration:"none"},to:"/focus/favorite"}," ",I.createElement("div",{className:"focus-title",id:"myFocusFavorite"},"收藏更新"))),I.createElement(Yt.a,{exact:!0,path:"/focus",component:ai}),I.createElement(Yt.a,{path:"/focus/board",component:ai}),I.createElement(Yt.a,{path:"/focus/user",component:ri}),I.createElement(Yt.a,{path:"/focus/favorite",component:si}))))},t}(I.Component),ii=function(n){function e(e){var t=n.call(this,e)||this;return t.state={hoverElement:null},t}return x.c(e,n),e.prototype.componentDidMount=function(){var t=this;window.addEventListener("storage",function(e){if("userInfo"===e.key){if(e.oldValue===e.newValue)return;e.newValue?t.props.reLogOn(JSON.parse(e.newValue.slice(4))):t.props.logOff()}}),ha()&&this.props.refreshCurrentMessageCount(),ha()&&!Gn("shouldNotRefreshUserInfo")&&(this.props.refreshUserInfo(),Jn("shouldNotRefreshUserInfo",!0,86400))},e.prototype.logOff=function(){this.handleMouseEvent("mouseout","userName"),Qn("accessToken"),Qn("refresh_token"),Qn("userInfo"),Qn("usePWA"),qn("all"),or(0),this.props.logOff()},e.prototype.handleMouseEvent=function(e,t){switch(e){case"mouseover":this.setState({hoverElement:t});break;case"mouseout":this.setState({hoverElement:null})}},e.prototype.render=function(){var t=this;if(this.props.isLogOn){var e=this.props.messageCount.atCount+this.props.messageCount.messageCount+this.props.messageCount.replyCount+this.props.messageCount.systemCount,n={display:"block",transitionDuration:".2s",height:"0px"},a="管理员"===this.props.userInfo.privilege?I.createElement(It.a,{to:"/sitemanage",style:{color:"#fff"}},I.createElement("li",null,"全站管理")):null,r="topBarUserCenter";"/"===location.pathname&&(r="topBarUserCenter-mainPage");var s="topBarMessageDetails";"/"===location.pathname&&(s="topBarMessageDetails-mainPage");var o="签到",i=Gn("userInfo");return i&&Gn("signin_"+i.id)&&(o="已签到"),I.createElement("div",{className:"topBarRight"},I.createElement("div",{className:"topBarUserInfo"},I.createElement("div",{className:"topBarMessage",id:"userMessage",onMouseOut:function(e){t.handleMouseEvent(e.type,"message")},onMouseOver:function(e){t.handleMouseEvent(e.type,"message")}},I.createElement(It.a,{to:"/message/response",className:"messageTopBar"},I.createElement("div",{className:"topBarBell"}," ",I.createElement("i",{className:"fa fa-bell-o"})),e?I.createElement("div",{className:"message-counter",id:"unreadCount-totalCount"},e):null)),I.createElement("div",{className:"topBarUserImg",onMouseOut:function(e){t.handleMouseEvent(e.type,"userName")},onMouseOver:function(e){t.handleMouseEvent(e.type,"userName")}},I.createElement("img",{src:this.props.userInfo.portraitUrl})),I.createElement("div",{className:"topBarUserName",onMouseOut:function(e){t.handleMouseEvent(e.type,"userName")},onMouseOver:function(e){t.handleMouseEvent(e.type,"userName")}},this.props.userInfo.name)),I.createElement("div",{className:r,onMouseOut:function(e){t.handleMouseEvent(e.type,"userName")},onMouseOver:function(e){t.handleMouseEvent(e.type,"userName")},style:x.a({},n,{overflow:"hidden",height:"userName"===this.state.hoverElement?"8rem":"0"})},I.createElement("ul",{style:{display:"inherit"}},I.createElement(It.a,{to:"/usercenter"}," ",I.createElement("li",null,"个人中心")),a,I.createElement(It.a,{to:"/signin"},I.createElement("li",null,o)),I.createElement("li",{onClick:this.logOff.bind(this)},"注销"))),I.createElement("div",{className:s,onMouseOut:function(e){t.handleMouseEvent(e.type,"message")},onMouseOver:function(e){t.handleMouseEvent(e.type,"message")},style:x.a({},n,{overflow:"hidden",height:"message"===this.state.hoverElement?"8rem":"0"})},I.createElement("ul",{style:{display:"inherit"}},I.createElement(It.a,{to:"/message/response"},I.createElement("li",null,"回复我的",this.props.messageCount.replyCount?I.createElement("div",{className:"message-counterLi"},this.props.messageCount.replyCount):null)),I.createElement(It.a,{to:"/message/attme"},I.createElement("li",null,"@ 我的",this.props.messageCount.atCount?I.createElement("div",{className:"message-counterLi"},this.props.messageCount.atCount):null)),I.createElement(It.a,{to:"/message/system"},I.createElement("li",null,"系统通知",this.props.messageCount.systemCount?I.createElement("div",{className:"message-counterLi"},this.props.messageCount.systemCount):null)),I.createElement(It.a,{to:"/message/message"},I.createElement("li",null,"我的私信",this.props.messageCount.messageCount?I.createElement("div",{className:"message-counterLi"},this.props.messageCount.messageCount):null)))))}return I.createElement("div",{className:"topBarUserInfo"},I.createElement("div",{className:"topBarText"}," ",I.createElement(It.a,{onClick:function(){localStorage.setItem("logOnRedirectUrl",window.location.href)},to:"/logOn"},"登录")),I.createElement("div",{className:"topBarText"},I.createElement("a",{href:"https://account.cc98.org/"},"注册")))},e}(I.Component);var ci=Object(Nr.b)(function(e){return{userInfo:e.userInfo.currentUserInfo,isLogOn:e.userInfo.isLogOn,messageCount:e.message}},function(t){return{logOff:function(){t(yr.userLogOff())},reLogOn:function(e){or(e.theme),t(yr.changeUserInfo(e)),t(yr.userLogIn())},refreshUserInfo:function(){t(Ys())},refreshCurrentMessageCount:function(){t(Ao())}}})(ii),li=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var c,t,n,a,r,s=this;return x.d(this,function(e){return c=Ee(".searchBoxSelect"),t=Ee(".caret-down"),n=Ee(".searchBoxSub"),a=Ee(".searchIco"),r=n.find("li"),Ee(document).click(function(){n.css("display","none")}),c.click(function(){return"block"===n.css("display")?n.css("display","none"):n.css("display","block"),!1}),t.click(function(){return"block"===n.css("display")?n.css("display","none"):n.css("display","block"),!1}),r.click(function(){c.text(Ee(this).text())}),r.mouseover(function(){this.className="hover"}),r.mouseout(function(){this.className=""}),this,a.click(function(){return x.b(s,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:return(t=Ee("#searchText").val())&&""!=t?"主题"!==c.text()&&"全站"!==c.text()?[3,1]:(this.props.history.push("/search?boardId=0&keyword="+encodeURI(encodeURI(t))),[3,8]):[3,8];case 1:return"版内"!==c.text()?[3,5]:(n=location.href.match(/\/topic\/(\d+)/),a=location.href.match(/\/board\/(\d+)/),r=location.href.match(/\/search\?boardId=(\d+)&/),s=0,n?[4,_a(n[1])]:[3,3]);case 2:return o=e.sent(),s=o.boardId,[3,4];case 3:a?s=parseInt(a[1]):r&&(s=parseInt(r[1]),r[1]),e.label=4;case 4:return this.props.history.push("/search?boardId="+s+"&keyword="+encodeURI(encodeURI(t))),[3,8];case 5:return"用户"!==c.text()?[3,7]:[4,ta(t)];case 6:return(i=e.sent())?this.props.history.push("/user/id/"+i.id):this.props.history.push("/search"),[3,8];case 7:"版面"===c.text()&&this.props.history.push("/searchBoard?keyword="+encodeURI(encodeURI(t))),e.label=8;case 8:return[2]}})})}),[2]})})},t.prototype.keypress_submit=function(e){var t=e||window.event;13===(t.which||t.keyCode||t.charCode)?Ee(".searchIco").click():"Enter"===t.key&&Ee(".searchIco").click()},t.prototype.render=function(){var e=location.href.match(/\/topic\/(\d+)/),t=location.href.match(/\/board\/(\d+)/),n=location.href.match(/\/(searchBoard)/),a=location.href.match(/\/search\?boardId=(\d+)/),r=1;return e?r=0:t?r=0:n||a&&0!==parseInt(a[1])&&(r=0),r?I.createElement("div",{id:"search"},I.createElement("div",{className:"box"},I.createElement("div",{className:"searchBoxSelect"},"主题"),I.createElement("div",{className:"caret-down"},I.createElement("i",{className:"fa fa-caret-down"})),I.createElement("input",{id:"searchText",type:"text",placeholder:"请输入搜索内容",onKeyPress:this.keypress_submit}),I.createElement("div",{className:"searchIco"},I.createElement("i",{className:"fa fa-search"}))),I.createElement("ul",{className:"searchBoxSub"},I.createElement("li",null,"主题"),I.createElement("li",null,"用户"),I.createElement("li",null,"版面"),I.createElement("li",{style:{display:"none"}}))):I.createElement("div",{id:"search"},I.createElement("div",{className:"box"},I.createElement("div",{className:"searchBoxSelect"},"版内"),I.createElement("div",{className:"caret-down"},I.createElement("i",{className:"fa fa-caret-down"})),I.createElement("input",{id:"searchText",type:"text",placeholder:"请输入搜索内容",onKeyPress:this.keypress_submit}),I.createElement("div",{className:"searchIco"},I.createElement("i",{className:"fa fa-search"}))),I.createElement("ul",{className:"searchBoxSub"},I.createElement("li",null,"版内"),I.createElement("li",null,"全站"),I.createElement("li",null,"用户"),I.createElement("li",null,"版面")))},t}(I.Component),ui=Object(Tr.a)(li),mi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return"/"===location.pathname?I.createElement("div",{className:"header"},I.createElement("div",{className:"topBar-mainPage"},I.createElement("div",{className:"topBarRow"},I.createElement("div",{className:"row",style:{display:"flex",flexDirection:"row",alignItems:"center"}},I.createElement("div",{className:"topBarLogo"},I.createElement(It.a,{to:"/"},I.createElement("img",{src:"/static/images/98LOGO.ico"}))),I.createElement("div",{className:"topBarCC98"},I.createElement(It.a,{to:"/"},"CC98论坛")),I.createElement("div",{className:"topBarText"},"|"),I.createElement("div",{className:"topBarText"},I.createElement(It.a,{to:"/boardList"},"版面列表")),I.createElement("div",{className:"topBarText"},I.createElement(It.a,{to:"/newTopics"},"新帖")),I.createElement("div",{className:"topBarText"},I.createElement(It.a,{to:"/focus"},"关注")),I.createElement(Yt.a,{component:ui})),I.createElement(ci,null)))):I.createElement("div",{className:"headerWithoutImage"},I.createElement("div",{className:"topBar"},I.createElement("div",{className:"topBarRow"},I.createElement("div",{className:"row",style:{display:"flex",flexDirection:"row",alignItems:"center"}},I.createElement("div",{className:"topBarLogo"},I.createElement(It.a,{to:"/"},I.createElement("img",{src:"/static/images/98LOGO.ico"}))),I.createElement("div",{className:"topBarCC98"},I.createElement(It.a,{to:"/"},"CC98论坛")),I.createElement("div",{className:"topBarText"},"|"),I.createElement("div",{className:"topBarText"},I.createElement(It.a,{to:"/boardList"},"版面列表")),I.createElement("div",{className:"topBarText"},I.createElement(It.a,{to:"/newTopics"},"新帖")),I.createElement("div",{className:"topBarText"},I.createElement(It.a,{to:"/focus"},"关注")),I.createElement(Yt.a,{component:ui})),I.createElement(ci,null))))},t}(I.Component),pi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"footer"},I.createElement("div",{className:"column"},I.createElement("div",{className:"footerRow"},I.createElement("div",{style:{marginRight:"15px",color:"#000"}},"友情链接"),I.createElement("a",{href:"http://www.zju.edu.cn/"},"浙江大学"),"|",I.createElement("a",{href:"http://www.cs.zju.edu.cn/"},"浙江大学计算机学院"),"|",I.createElement("a",{href:"http://www.zju88.org/agent/index.do"},"飘渺水云间"),"|",I.createElement("a",{href:"http://www.qsc.zju.edu.cn/"},"求是潮"),"|",I.createElement("a",{href:"http://luckweb.057101.com/bt2/index.asp"},"缘网"),"|",I.createElement("a",{href:"http://www.nexushd.org"},"NexusHD"),"|",I.createElement("a",{href:"https://www.zdgd.zju.edu.cn/"},"浙江大学广播电视网"),"|",I.createElement("a",{href:"http://zy.zju.edu.cn/"},"浙大搜索")),I.createElement("div",{className:"footerRow"},"Copyright © 2003-",(new Date).getFullYear()," CC98 Durian v3.2.3 | ",I.createElement("a",{href:"mailto:contact@cc98.org"},"Email: contact@cc98.org"))))},t}(I.Component),di=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"user-center-navigation",id:"userCenterNavigation"},I.createElement("ul",null,I.createElement("li",null,I.createElement(It.a,{to:"/user/id/"+this.props.id,className:"exact"===this.props.currentVisitingUserPage?"user-center-navigation-active fa-home":"fa-home"},I.createElement("span",{style:{width:"0.5rem"}}),"主页")),I.createElement("hr",null),"管理员"===this.props.isManager?I.createElement("li",null,I.createElement(It.a,{to:"/user/id/"+this.props.id+"/manage",className:"manage"===this.props.currentVisitingUserPage?"user-center-navigation-active fa-cog":"fa-cog"},I.createElement("span",{style:{width:"0.5rem"}}),"管理")):null))},t}(I.Component);var hi=Object(Nr.b)(function(e){return{isManager:e.userInfo.currentUserInfo.privilege,currentVisitingUserPage:e.userInfo.currentVisitingUserPage,id:e.userInfo.currentVisitingUserId}})(di),fi=function(){},gi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={ForumUserOperation:new fi,info:""},t}return x.c(e,n),e.prototype.handleForumUserOperationChange=function(n,a){this.setState(function(e){var t;return{ForumUserOperation:x.a({},e.ForumUserOperation,(t={},t[n]=a,t))}})},e.prototype.handleSubmit=function(l){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c;return x.d(this,function(e){switch(e.label){case 0:t=this.state.ForumUserOperation,n=t.Days,a=t.PunishmentType,e.label=1;case 1:if(e.trys.push([1,4,,5]),!this.state.ForumUserOperation.Reason)throw new Error("请填写理由");if(!l&&3===a&&(n<-1||1e3<n||n<7&&-1<n))throw new Error("不合法的TP天数");return r="/user/"+this.props.id+"/operation",[4,Kn()];case 2:return s=e.sent(),(o=new Headers).append("Authorization",s),o.append("Content-Type","application/json"),[4,Zn(r,{method:"PUT",headers:o,body:JSON.stringify(x.a({},this.state.ForumUserOperation,{OperationType:l?0:1}))})];case 3:if(!(i=e.sent()).ok)throw new Error(i.statusText);return this.setState({info:"操作成功"}),[3,5];case 4:return c=e.sent(),this.setState({info:c.message}),[3,5];case 5:return[2]}})})},e.prototype.render=function(){var t=this;return I.createElement("div",null,I.createElement("h2",null,"TP"),I.createElement("div",{className:"user-manager"},I.createElement("p",null,"OperationType: "),I.createElement("select",{value:this.state.ForumUserOperation.PunishmentType||0,onChange:function(e){t.handleForumUserOperationChange("PunishmentType",Number.parseInt(e.target.value))}},I.createElement("option",{value:0,disabled:!0},"未选择"),I.createElement("option",{value:1},"锁定"),I.createElement("option",{value:2},"屏蔽"),I.createElement("option",{value:3},"TP")),I.createElement("p",null,"Reason: "),I.createElement("input",{type:"text",onChange:function(e){t.handleForumUserOperationChange("Reason",e.target.value)},value:this.state.ForumUserOperation.Reason}),I.createElement("p",null,"Days: "),I.createElement("input",{type:"number",onChange:function(e){t.handleForumUserOperationChange("Days",Number.parseInt(e.target.value))},value:this.state.ForumUserOperation.Days}),I.createElement("button",{type:"button",onClick:function(){t.handleSubmit(!1)}},"提交"),I.createElement("button",{type:"button",onClick:function(){t.handleSubmit(!0)}},"解除")),I.createElement("p",{className:"user-manage-return"},this.state.info))},e}(I.Component),vi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={days:0,info:""},t}return x.c(e,n),e.prototype.handleSubmit=function(l){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c;return x.d(this,function(e){switch(e.label){case 0:if(e.trys.push([0,4,,5]),t=l?"post":"topic",n=this.props.id,(a=this.state.days)<1||365<a)throw new Error("请检查日期");return r="/user/"+n+"/"+t+"?days="+a,[4,Kn()];case 1:return s=e.sent(),(o=new Headers).append("Authorization",s),[4,Zn(r,{method:"DELETE",headers:o})];case 2:return[4,e.sent().json()];case 3:return i=e.sent(),this.setState({info:"删掉了"+i+"条"+t}),[3,5];case 4:return c=e.sent(),this.setState({info:c.message}),[3,5];case 5:return[2]}})})},e.prototype.render=function(){var t=this;return I.createElement("div",null,I.createElement("h2",null,"删除用户最近主题与回帖"),I.createElement("div",{className:"user-manager"},I.createElement("p",null,"天数："),I.createElement("input",{type:"number",onChange:function(e){t.setState({days:Number.parseInt(e.target.value)})},value:this.state.days}),I.createElement("button",{type:"button",onClick:function(){t.handleSubmit(!1)}},"删主题"),I.createElement("button",{type:"button",onClick:function(){t.handleSubmit(!0)}},"删回复")),I.createElement("p",{className:"user-manage-return"},this.state.info))},e}(I.Component),bi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={info:"",count:0,from:0,isLoading:!1,days:1,posts:[]},t}return x.c(e,n),e.prototype.handleSubmit=function(u){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l=this;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),this.setState({isLoading:!0}),[4,Kn()];case 1:return t=e.sent(),n=this.props.id,a=this.state.days,r="/User/"+n+"/post?days="+a+"&from="+u+"&size=10",(s=new Headers).append("Authorization",t),[4,Zn(r,{headers:s})];case 2:return[4,e.sent().json()];case 3:return o=e.sent(),i=o.postInfos.map(function(a){return x.b(l,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t=[{},a],n={},[4,da(a.boardId)];case 1:return[2,x.a.apply(void 0,t.concat([(n.boardName=e.sent(),n)]))]}})})}),[4,Promise.all(i)];case 4:return i=e.sent(),this.setState({posts:i,isLoading:!1,count:o.count,info:0===i.length?"啥也没有":"",from:u}),[3,6];case 5:return c=e.sent(),this.setState({info:c.message,isLoading:!1}),[3,6];case 6:return[2]}})})},e.prototype.render=function(){var t=this;return I.createElement("div",null,I.createElement("h2",null,"查看用户最近发言"),I.createElement("div",{className:"user-manager"},I.createElement("p",null,"天数："),I.createElement("input",{type:"number",onChange:function(e){t.setState({days:Number.parseInt(e.target.value)})},value:this.state.days}),I.createElement("button",{type:"button",onClick:function(){t.handleSubmit(0)}},"查看"),I.createElement("button",{type:"button",disabled:0===this.state.from,onClick:function(){t.handleSubmit(t.state.from-10)}},"上一页"),I.createElement("button",{type:"button",disabled:this.state.from+this.state.posts.length===this.state.count,onClick:function(){t.handleSubmit(t.state.from+10)}},"下一页")),I.createElement("div",{className:"user-manage-return"},I.createElement("p",null,this.state.info)),this.state.isLoading?I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"})):I.createElement("div",null,this.state.posts.map(function(e){return I.createElement("div",{className:"user-manage-post",key:e.topicId},I.createElement("p",{className:"user-manage-post-date"},e.time.slice(0,19).replace("T"," ")),-1===e.floor?I.createElement("p",{className:"user-manage-post-content",title:e.content.slice(0,1e3)},e.content):I.createElement(It.a,{className:"user-manage-post-content",to:"/topic/"+e.topicId+"/"+(Math.floor((e.floor-1)/10)+1)+"#"+(e.floor%10==0?10:e.floor%10),title:e.content.slice(0,1e3),target:"_blank"},e.content),I.createElement(It.a,{className:"user-manage-post-board",to:"/board/"+e.boardId,target:"_blank"},e.boardName),I.createElement("p",{className:"user-manage-post-floor"},-1===e.floor?"已删除":e.floor),I.createElement("p",{className:"user-manage-post-ip"},e.ip))}),0<this.state.posts.length?I.createElement("p",{style:{textAlign:"right"}},"总共有",this.state.count,"条帖子，当前显示第",Math.floor(this.state.from/10)+1,"页，共",Math.floor(this.state.count/10)+1,"页"):null))},e}(I.Component),yi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:t=0===this.props.id?Number.parseInt(this.props.match.params.id):this.props.id,this.props.changePage("manage",t),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,ta(t)];case 2:return n=e.sent(),this.setState({userInfo:n}),[3,4];case 3:return e.sent(),this.props.notFoundUser(),[3,4];case 4:return[2]}})})},t.prototype.render=function(){return this.state?I.createElement("div",{className:"user-manage"},I.createElement("div",{className:"user-manage-infos"},I.createElement("h2",null,"用户信息"),I.createElement("div",{className:"user-manage-info"},I.createElement("p",null,"id:",this.state.userInfo.id),I.createElement("p",null,"name: ",this.state.userInfo.name))),I.createElement(gi,{id:this.props.id}),I.createElement(vi,{id:this.props.id}),I.createElement(bi,{id:this.props.id})):I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}))},t}(I.Component);var Ei=Object(Nr.b)(function(e){return{id:e.userInfo.currentVisitingUserId}},function(n){return{changePage:function(e,t){n(ne(e,t))},notFoundUser:function(){n(Q())}}})(Object(Tr.a)(yi)),Ii=function(n){function e(e){var t=n.call(this,e)||this;return t.state={isFollowing:e.userInfo.isFollowing,buttonIsDisabled:!1,buttonInfo:e.userInfo.isFollowing?"已关注":"关注"},t.unfollow=t.unfollow.bind(t),t.follow=t.follow.bind(t),t}return x.c(e,n),e.prototype.getPrivilegeColor=function(){switch(this.props.userInfo.privilege){case"注册用户":return"grey";case"超级版主":return"pink";case"全站贵宾":return"blue";case"管理员":return"red"}},e.prototype.follow=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return this.setState({buttonIsDisabled:!0,buttonInfo:"关注中"}),[4,Sa(this.props.userInfo.id)];case 1:return!0===(t=e.sent())?this.setState({buttonIsDisabled:!1,buttonInfo:"已关注",isFollowing:!0}):"follow_count_limited"===t?this.setState({buttonIsDisabled:!1,buttonInfo:"已达上限",isFollowing:!1}):this.setState({buttonIsDisabled:!1,buttonInfo:"关注失败",isFollowing:!1}),[2]}})})},e.prototype.unfollow=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return this.setState({buttonIsDisabled:!0,buttonInfo:"取关中"}),[4,xa(this.props.userInfo.id)];case 1:return!0===e.sent()?this.setState({buttonIsDisabled:!1,buttonInfo:"重新关注",isFollowing:!1}):this.setState({buttonIsDisabled:!1,buttonInfo:"取关失败",isFollowing:!0}),[2]}})})},e.prototype.render=function(){var e=this,t=!1;if(this.props.userInfo.birthday){var n=this.props.userInfo.birthday.match(/\d+-(\d+)-(\d+)/),a=new Date;Number.parseInt(n[1])===a.getMonth()+1&&Number.parseInt(n[2])===a.getDate()&&(t=!0)}return I.createElement("div",{className:"user-profile"},I.createElement("div",{id:"userId"},I.createElement("div",{id:"userId"},I.createElement("p",null,this.props.userInfo.name,I.createElement("span",{style:{fontSize:"12px",color:this.getPrivilegeColor(),marginLeft:"2rem"}},this.props.userInfo.privilege)),I.createElement("div",{className:"row"},I.createElement(ms.a,{color:"grey",style:{width:"5rem",textAlign:"center",marginRight:0,height:"2rem",borderTopRightRadius:0,borderBottomRightRadius:0,fontSize:16,lineHeight:"2rem"}},"收到的赞"),I.createElement(ms.a,{className:"board-head-information",style:{width:"5rem",height:"2rem",textAlign:"center",marginRight:0,borderLeft:0,borderTopLeftRadius:0,borderBottomLeftRadius:0,fontSize:16,lineHeight:"2rem"}},this.props.userInfo.receivedLikeCount)),I.createElement(It.a,{to:"/message/message?id="+this.props.userInfo.id},I.createElement("button",{type:"button"},"私信")),I.createElement("button",{type:"button",id:this.state.isFollowing?"unfollow":"",onClick:this.state.isFollowing?this.unfollow:this.follow,disabled:this.state.buttonIsDisabled,onMouseOver:function(){e.state.isFollowing&&!e.state.buttonIsDisabled&&e.setState({buttonInfo:"取消关注"})},onMouseLeave:function(){e.state.isFollowing&&!e.state.buttonIsDisabled&&e.setState({buttonInfo:"已关注"})}},this.state.buttonInfo))),I.createElement("div",{id:"userIntroducion"},this.props.userInfo.introduction),I.createElement("div",{id:"userGenderAndBirthday"},I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"性别"),1===this.props.userInfo.gender?"男":"女"," "),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"发帖数"),this.props.userInfo.postCount),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"威望"),this.props.userInfo.prestige),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"粉丝数"),this.props.userInfo.fanCount),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"风评"),this.props.userInfo.popularity),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"注册时间"),this.props.userInfo.registerTime.replace("T"," ")),I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"最后登录"),this.props.userInfo.lastLogOnTime.replace("T"," ")),null===this.props.userInfo.birthday?null:I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"生日"),this.props.userInfo.birthday.slice(0,this.props.userInfo.birthday.indexOf("T")).replace("9999-",""),t?I.createElement("span",{style:{fontFamily:"FontAwesome",marginLeft:"1rem"},className:"fa-birthday-cake",title:"生日快乐~"}):null),this.props.userInfo.displayTitle?I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"用户组"),this.props.userInfo.displayTitle):null,this.props.userInfo.emailAddress?I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"邮箱"),this.props.userInfo.emailAddress):null,this.props.userInfo.qq?I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"QQ"),this.props.userInfo.qq):null,I.createElement("p",null,I.createElement("span",{className:"user-profile-info"},"被删帖数"),-this.props.userInfo.deleteCount)),this.props.userInfo.signatureCode?I.createElement("div",{className:"user-description"},I.createElement("p",null,"个性签名"),I.createElement(Ht,{code:this.props.userInfo.signatureCode,options:x.a({},new Ce,{allowExternalImage:!1})})):null)},e}(I.Component),wi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={userRecentPosts:[],isLoading:!1},t.scrollHandler=t.scrollHandler.bind(t),t}return x.c(e,n),e.prototype.scrollHandler=function(e){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:if(!(document.body.scrollHeight-window.pageYOffset<1500&&!1===this.state.isLoading))return[3,8];e.label=1;case 1:return e.trys.push([1,7,,8]),this.setState({isLoading:!0}),t="/user/"+this.props.id+"/recent-topic?userid="+this.props.id+"&from="+this.state.userRecentPosts.length+"&size=11",[4,Kn()];case 2:return n=e.sent(),(a=new Headers).append("Authorization",n),[4,Zn(t,{headers:a})];case 3:return 200!==(r=e.sent()).status?[3,5]:[4,r.json()];case 4:return s=e.sent(),o=11===s.length?10:s.length,this.setState(function(e){return{userRecentPosts:e.userRecentPosts.concat(s.slice(0,o)),isLoading:!1}}),[3,6];case 5:throw{};case 6:return[3,8];case 7:return e.sent(),this.setState({isLoading:!1}),[3,8];case 8:return[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),t="/user/"+this.props.id+"/recent-topic?userid="+this.props.id+"&from="+this.state.userRecentPosts.length+"&size=11",[4,Kn()];case 1:return n=e.sent(),(a=new Headers).append("Authorization",n),[4,Zn(t,{headers:a})];case 2:return 200!==(r=e.sent()).status?[3,4]:[4,r.json()];case 3:return s=e.sent(),o=11===s.length?10:s.length,this.setState({userRecentPosts:s.slice(0,o)}),11===s.length&&window.addEventListener("scroll",this.scrollHandler),[3,5];case 4:throw new Error;case 5:return[3,7];case 6:return e.sent(),[3,7];case 7:return[2]}})})},e.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this.scrollHandler)},e.prototype.componentWillReceiveProps=function(e){e.id!==this.props.id&&(this.setState({userRecentPosts:[],isLoading:!1}),window.removeEventListener("scroll",this.scrollHandler),window.addEventListener("scroll",this.scrollHandler))},e.prototype.render=function(){if(0===this.state.userRecentPosts.length){return I.createElement("div",{className:"user-activities"},I.createElement("p",null,"发表的主题"),I.createElement("div",{className:"user-posts",style:{marginLeft:"2rem"}},"没有主题"))}for(var e=this.state.userRecentPosts.map(function(e){return I.createElement(Hs,{userRecentTopic:e})}),t=1;t<e.length;t+=2)e.splice(t,0,I.createElement("hr",null));return I.createElement("div",{className:"user-activities"},I.createElement("p",null,"发表的主题"),I.createElement("div",{className:"user-posts"},e))},e}(I.Component),Ci=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"user-center-router"},I.createElement(Yt.a,{path:"/user/:method/:id?",exact:!0,component:Ti}),I.createElement(Yt.a,{path:"/user/:method/:id/manage",component:Ei}))},t}(I.Component),Ni=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getInfo(this.props),[2]})})},t.prototype.componentWillReceiveProps=function(e){this.props.match.params.id!==e.match.params.id&&this.getInfo(e)},t.prototype.getInfo=function(p){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m;return x.d(this,function(e){switch(e.label){case 0:if(e.trys.push([0,5,,6]),t=void 0,n=p.match.params,a=n.id,r=n.method,s=new Headers,o=void 0,!a)throw new Error;return"name"===r?o=a:"id"===r&&(o=Number.parseInt(a)),c=(i=s).append,l=["Authorization"],[4,Kn()];case 1:return c.apply(i,l.concat([e.sent()])),t="number"==typeof o?"/user/"+o:"/user/name/"+o,[4,Xn()];case 2:return u=e.sent(),[4,Zn(t,{headers:u})];case 3:return[4,e.sent().json()];case 4:return m=e.sent(),this.props.history.replace("/user/id/"+m.id),this.props.changePage("exact",m.id),this.setState({userInfo:m}),[3,6];case 5:return e.sent(),this.props.notFoundUser(),[3,6];case 6:return[2]}})})},t.prototype.render=function(){return this.state?I.createElement("div",{className:"user-center-exact"},I.createElement(Wt,{title:this.state.userInfo.name+" - 用户详情 - CC98论坛"}),I.createElement(Qs,{userInfo:this.state.userInfo}),I.createElement(Ii,{userInfo:this.state.userInfo}),I.createElement(wi,{id:this.state.userInfo.id})):I.createElement("div",{className:"user-center-loading"},I.createElement("p",{className:"fa fa-spinner fa-pulse fa-2x fa-fw"}))},t}(I.Component);var Ti=Object(Nr.b)(null,function(n){return{changePage:function(e,t){n(ne(e,t))},notFoundUser:function(){n(Q())}}})(Object(Tr.a)(Ni)),Si=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return this.props.isError?I.createElement(rn,null):I.createElement("div",{className:"user-center"},I.createElement("div",{className:"user-center-content"},I.createElement("div",{className:"user-center-head"},I.createElement("p",null,"用户详情")),I.createElement("div",{className:"user-center-body"},I.createElement(hi,null),I.createElement(Ci,null))))},t}(I.Component);var xi=Object(Nr.b)(function(e){return{isError:!e.userInfo.currentVisitingUserIsExisted}},null)(Si),ki=function(n){function e(e){var t=n.call(this,e)||this;return t.state={loginName:"",loginPassword:"",loginMessage:"",isLoging:!1},t.handleNameChange=t.handleNameChange.bind(t),t.handlePasswordChange=t.handlePasswordChange.bind(t),t.handleLogin=t.handleLogin.bind(t),t}return x.c(e,n),e.prototype.shake=function(e){return e.classList.add("shake"),setTimeout(function(){e.classList.remove("shake")},500),e},e.prototype.handleNameChange=function(e){this.setState({loginName:e.target.value})},e.prototype.handlePasswordChange=function(e){this.setState({loginPassword:e.target.value})},e.prototype.handleLogin=function(l){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c=this;return x.d(this,function(e){switch(e.label){case 0:if(l.preventDefault(),this.state.isLoging)return[2,!1];if(!this.state.loginName)return this.setState({loginMessage:"请输入用户名"}),this.shake(document.getElementById("loginName")).focus(),[2,!1];if(!this.state.loginPassword)return this.setState({loginMessage:"请输入密码"}),this.shake(document.getElementById("loginPassword")).focus(),[2,!1];this.setState({loginMessage:"登录中",isLoging:!0}),this.props.logOff(),e.label=1;case 1:return e.trys.push([1,5,,6]),"https://openid.cc98.org/connect/token",t={client_id:"9a1fd200-8687-44b1-4c20-08d50a96e5cd",client_secret:"8b53f727-08e2-4509-8857-e34bf92b27f2",grant_type:"password",username:this.state.loginName,password:this.state.loginPassword,scope:"cc98-api openid offline_access"},(n=new Headers).append("Content-Type","application/x-www-form-urlencoded"),[4,fetch("https://openid.cc98.org/connect/token",{method:"POST",headers:n,body:Ee.param(t)})];case 2:if(200!==(a=e.sent()).status)throw new Error(a.status.toString());return[4,a.json()];case 3:return r=e.sent(),Jn("accessToken",r.token_type+" "+r.access_token,r.expires_in),Jn("refresh_token",r.refresh_token,2592e3),[4,Da()];case 4:if(e.sent(),1===(s=Gn("userInfo")).lockState||2===s.lockState)throw new Error("账号已锁定");return this.setState({loginMessage:"登录成功 正在返回"}),or(s.theme),this.props.logOn(),setTimeout(function(){if(1===c.props.history.length)document.location.href="/";else{var e=localStorage.getItem("logOnRedirectUrl");document.location.href=e}},100),[3,6];case 5:switch(o=e.sent(),i=void 0,Qn("userInfo"),Qn("accessToken"),Qn("refresh_token"),o.message){case"400":i="密码错误";break;case"账号已锁定":i="账号已锁定";break;default:i="未知错误 "+o.message}return this.setState({loginMessage:"登录失败 "+i,isLoging:!1}),this.props.logOff(),[3,6];case 6:return[2]}})})},e.prototype.render=function(){return I.createElement("div",{className:"login"},I.createElement(Wt,{title:"登录 - CC98论坛"}),I.createElement("div",null,I.createElement("img",{src:"/static/images/login.png"}),I.createElement("div",null,I.createElement("img",{src:"/static/images/login_welcome.png"}),I.createElement("form",{onSubmit:this.handleLogin,autoComplete:"on"},I.createElement("div",{className:"login-form"},I.createElement("p",null,"用户名"),I.createElement("input",{name:"username",type:"text",id:"loginName",onChange:this.handleNameChange,value:this.state.loginName,autoComplete:"username"})),I.createElement("div",{className:"login-form"},I.createElement("p",null,"密码"),I.createElement("input",{name:"password",type:"password",id:"loginPassword",onChange:this.handlePasswordChange,autoComplete:"current-password"})),I.createElement("p",{className:"login-message",id:"loginMessage"},this.state.loginMessage),I.createElement("button",{type:"submit",disabled:this.state.isLoging},"登录账号")),I.createElement("p",{className:"login-message"},I.createElement("span",null,"还没账号？我要 ",I.createElement("a",{href:"//account.cc98.org/",target:"_blank"},"注册"))),I.createElement("p",{className:"login-message"},I.createElement("span",null,"密码错误？我要 ",I.createElement("a",{href:"//account.cc98.org/",target:"_blank"},"找回"))))))},e}(I.Component);var Pi=Object(Nr.b)(function(e){return{isLogOn:e.userInfo.isLogOn}},function(t){return{logOn:function(){t(q())},logOff:function(){t(J())},changeUserInfo:function(e){t(te(e))}}})(ki),Ui=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentDidMount=function(){this.props.tag1||$("#tag_"+this.props.id).addClass("displaynone"),this.props.userId||($("#user_"+this.props.id).removeAttr("href"),$("#user_"+this.props.id).removeAttr("target"),$("#lastpost_"+this.props.id).removeAttr("href"),$("#lastpost_"+this.props.id).removeAttr("target"))},t.prototype.render=function(){var e="";this.props.tag1&&(e=this.props.tag2?"标签："+this.props.tag1+" / "+this.props.tag2:"标签："+this.props.tag1);var t="/topic/"+this.props.id,n="/user/id/"+this.props.userId,a="/board/"+this.props.boardId,r=this.props.floorCount/10+1,s=parseInt(r),o=this.props.floorCount+10-10*s;var i="/user/name/"+encodeURI(this.props.lastPostUser);return I.createElement("div",{className:"focus-topic"},I.createElement("a",{className:"focus-topic-left",href:n,target:"_blank",id:"user_"+this.props.id},I.createElement("img",{className:"focus-topic-portraitUrl",src:this.props.portraitUrl}),I.createElement("div",{className:"focus-topic-userName"},this.props.userName)),I.createElement("div",{className:"focus-topic-middle"},I.createElement("a",{className:"focus-topic-title",href:t,target:"_blank"},this.props.title),I.createElement("div",{className:"focus-topic-info"},I.createElement("div",{id:"tag_"+this.props.id},e),I.createElement("div",null,I.createElement("i",{className:"fa fa-clock-o fa-lg"}),this.props.time),I.createElement("div",null,I.createElement("i",{className:"fa fa-eye fa-lg"})," ",this.props.hitCount),I.createElement("div",null,"最后回复：",I.createElement("a",{href:i,target:"_blank",id:"lastpost_"+this.props.id},this.props.lastPostUser)))),I.createElement("div",{className:"focus-topic-rightBar"}),I.createElement("a",{className:"focus-topic-right",href:a,target:"_blank"},I.createElement("div",{className:"focus-topic-board"},this.props.boardName)))},t}(I.Component),Mi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={boardId:0,boardName:"全站",words:[],data:[],from:0,loading:!0,buttonClassName:""},t.getMore=t.getMore.bind(t),t.handleScroll=t.handleScroll.bind(t),t}return x.c(e,n),e.prototype.getData=function(a,r){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Ua(a.boardId,a.words,r,this.context.router)];case 1:if((t=e.sent())&&0!==t.length)if(-1==t){if(0!==r)return this.setState({loading:!0}),$("#focus-topic-getMore").css("display","flex"),$("#focus-topic-loading").addClass("displaynone"),[2];this.showError(),this.setState({loading:!1})}else t.length<20?($("#focus-topic-getMore").css("display","none"),$("#focus-topic-loading").addClass("displaynone"),$("#focus-topic-loaddone").removeClass("displaynone"),n=this.state.data.concat(t),this.setState({boardName:a.boardName,data:n,from:n.length,loading:!1})):(n=this.state.data.concat(t),this.setState({boardName:a.boardName,data:n,from:n.length,loading:!0}),$("#focus-topic-getMore").css("display","flex"),$("#focus-topic-loading").addClass("displaynone"));else this.showNoResult(),this.setState({loading:!1});return[2]}})})},e.prototype.getNewData=function(n,a){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Ua(n.boardId,n.words,a,this.context.router)];case 1:if((t=e.sent())&&0!==t.length)if(-1==t){if(0!==a)return this.setState({loading:!0}),$("#focus-topic-getMore").css("display","flex"),$("#focus-topic-loading").addClass("displaynone"),[2];this.showError(),this.setState({loading:!1})}else t.length<20?($("#focus-topic-getMore").css("display","none"),$("#focus-topic-loading").addClass("displaynone"),$("#focus-topic-loaddone").removeClass("displaynone"),this.setState({boardName:n.boardName,data:t,from:t.length,loading:!1})):(this.setState({boardName:n.boardName,data:t,from:t.length,loading:!0}),$("#focus-topic-getMore").css("display","flex"),$("#focus-topic-loading").addClass("displaynone"));else this.showNoResult(),this.setState({loading:!1});return[2]}})})},e.prototype.keyWordSearch=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s;return x.d(this,function(e){switch(e.label){case 0:return t=location.href.match(/\/search\?boardId=(\d+)&keyword=(.*)/),n={boardId:0,boardName:"全站",words:null},t?[3,1]:(this.showNoResult(),this.setState({loading:!1}),[3,3]);case 1:return n.boardId=parseInt(t[1]),a=n,[4,da(parseInt(t[1]))];case 2:a.boardName=e.sent(),r=decodeURI(decodeURI(t[2])),5<(s=r.split(" ")).length&&(s=s.splice(5)),n.words=s,e.label=3;case 3:return $n("searchInfo",n),this.setState({boardId:n.boardId,boardName:n.boardName,words:n.words}),$("#focus-topic-getMore").css("display","none"),$("#focus-topic-loading").removeClass("displaynone"),this.getNewData(n,0),document.addEventListener("scroll",this.handleScroll),[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.keyWordSearch(),[2]})})},e.prototype.componentWillReceiveProps=function(e){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return $("#focus-topic-area").removeClass("displaynone"),$("#noResult").addClass("displaynone"),$("#showError").addClass("displaynone"),this.keyWordSearch(),[2]})})},e.prototype.getMore=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){return this.state.loading&&($("#focus-topic-getMore").css("display","none"),$("#focus-topic-loading").removeClass("displaynone"),this.setState({loading:!1}),t=Yn("searchInfo"),this.getData(t,this.state.from)),[2]})})},e.prototype.showNoResult=function(){$("#focus-topic-area").addClass("displaynone"),$("#noResult").removeClass("displaynone")},e.prototype.showError=function(){$("#focus-topic-area").addClass("displaynone"),$("#showError").removeClass("displaynone")},e.prototype.handleScroll=function(e){234<window.pageYOffset&&this.setState({buttonClassName:"btn-show"}),window.pageYOffset<234&&this.setState(function(e){return{buttonClassName:""===e.buttonClassName?"":"btn-disappare"}})},e.prototype.scrollToTop=function(){$("body,html").animate({scrollTop:0},500)},e.prototype.render=function(){return I.createElement("div",{className:"focus-root"},I.createElement(Wt,{title:"搜索结果 - CC98论坛"}),I.createElement("div",{className:"focus"},I.createElement(Oi,null),I.createElement("div",{className:"focus-topic-area",id:"focus-topic-area"},I.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(Ri)),I.createElement("div",{className:"focus-topic-getMore",onClick:this.getMore,id:"focus-topic-getMore"},I.createElement("div",null,"点击获取更多搜索结果~"),I.createElement("div",null,"······")),I.createElement("div",{className:"focus-topic-loading displaynone",id:"focus-topic-loading"},I.createElement("img",{src:"http://file.cc98.org/uploadfile/2017/12/20/6514723843.gif"})),I.createElement("div",{className:"focus-topic-loaddone displaynone",id:"focus-topic-loaddone"}," 没有更多帖子啦~"),I.createElement("button",{type:"button",id:"scrollToTop",className:this.state.buttonClassName,onClick:this.scrollToTop},"回到顶部")),I.createElement("div",{id:"noResult",className:"noResult displaynone"},I.createElement("img",{src:"/static/images/searchNone.png",className:"noResultPic"}),I.createElement("div",{className:"noResultText"},"-----------------------抱歉呢前辈，没有找到你想要的帖子哦~----------------------")),I.createElement("div",{id:"showError",className:"resultErr displaynone"},"查询出错了，请刷新重试")))},e}(I.Component);function Ri(e){return I.createElement(Ui,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}var Oi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"搜索主题"))},t}(I.Component),Di=function(n){function e(e){var t=n.call(this,e)||this;return t.state={data:[]},t}return x.c(e,n),e.prototype.getData=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t=location.href.match(/\/searchBoard\?keyword=(.*)/),n=[],t?[3,1]:(this.showNoResult(),[3,3]);case 1:return[4,function(t,e){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return t?[4,Zn("/board/search?keyword="+t)]:[3,3];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()];case 3:return[2]}})})}(decodeURI(decodeURI(t[1])),this.context.router)];case 2:(n=e.sent())?this.setState({data:n}):this.showNoResult(),e.label=3;case 3:return[2]}})})},e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getData(),[2]})})},e.prototype.componentWillReceiveProps=function(e){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){return this.getData(),[2]})})},e.prototype.showNoResult=function(){$("#noResultBoard").removeClass("displaynone")},e.prototype.render=function(){return I.createElement("div",{className:"focus-root"},I.createElement(Wt,{title:"搜索结果 - CC98论坛"}),I.createElement("div",{className:"focus"},I.createElement(Li,null),I.createElement("div",{className:"focus-board-area"},this.state.data.map(ji))),I.createElement("div",{id:"noResultBoard",className:"noResult displaynone"},I.createElement("img",{src:"/static/images/searchNone.png",className:"noResultPic"}),I.createElement("div",{className:"noResultText"},"-----------------------抱歉呢前辈，没有找到你想要的版面哦~----------------------")))},e}(I.Component);function ji(e){var t="/board/"+e.id;return I.createElement("a",{href:t,target:"_blank"},I.createElement("div",{className:"focus-board"},e.name))}var Li=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:"/boardList"},"版面列表"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"搜索版面"))},t}(I.Component),Fi=function(n){function e(e){var t=n.call(this,e)||this;return t.update=t.update.bind(t),t.signin=t.signin.bind(t),t.state={signinInfo:{lastSignInCount:0,lastSignInTime:0},content:""},t}return x.c(e,n),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return[4,Zn("/me/signin",{headers:e.sent()})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}()];case 1:return t=e.sent(),this.setState({signinInfo:t}),[2]}})})},e.prototype.update=function(e){this.setState({content:e})},e.prototype.signin=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c;return x.d(this,function(e){switch(e.label){case 0:return function(n){x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),[4,Zn("/me/signin",{method:"POST",headers:t,body:n})];case 2:return e.sent(),[2]}})})}(this.state.content),[4,function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return[4,Zn("/config/global",{headers:e.sent()})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}()];case 1:return t=e.sent(),[4,_a(n=t.signInTopicId)];case 2:return a=e.sent(),r=a.replyCount,s=Va(r),0===(o=(r+1)%10)&&(o=10),this.props.history.push("/topic/"+n+"/"+s+"#"+o),this.setState({content:""}),i=Gn("userInfo"),c=(new Date((new Date).setHours(0,0,0,0)).getTime()+864e5-(new Date).getTime())/1e3,Jn("signin_"+i.id,!0,c),[2]}})})},e.prototype.render=function(){var e;if(this.state.signinInfo.hasSignedInToday){var t=Gn("userInfo"),n=(new Date((new Date).setHours(0,0,0,0)).getTime()+864e5-(new Date).getTime())/1e3;Jn("signin_"+t.id,!0,n),e=I.createElement("div",null,I.createElement("div",{className:"row",style:{justifyContent:"center"}},"你上次的签到日期是",Cn(this.state.signinInfo.lastSignInTime).format("YYYY-MM-DD HH:mm:ss")),I.createElement("div",{className:"row",style:{justifyContent:"center"}},"你已经连续签到了",this.state.signinInfo.lastSignInCount,"天"))}else{Qn("signin_"+(t=Gn("userInfo")).id),e=I.createElement("div",{className:"column"},I.createElement("div",{className:"row"},"你今天还未签到"),I.createElement("div",{style:{marginTop:"1.5rem"}},I.createElement(jr,{update:this.update,value:this.state.content,option:{height:10}}),I.createElement("div",{className:"row",style:{justifyContent:"center",marginBottom:"1.25rem "}},I.createElement("div",{id:"post-topic-button",onClick:this.signin,className:"button blue",style:{marginTop:"1.25rem",width:"6rem",height:"2rem",lineHeight:"2rem",letterSpacing:"0.3125rem"}},"签到"))))}return I.createElement("div",{className:"sign-in"},I.createElement("div",{className:"row",style:{width:"100%",justifyContent:"center"}},"论坛签到"),I.createElement("div",{className:"row"},"签到功能是 CC98 论坛提供的一项娱乐功能。每个用户每天可以签到一次，并获得额外的论坛财富值奖励。如果连续多日签到，则奖励会不断增加。目前财富值的奖励情况如下表所示："),I.createElement("div",{className:"column",style:{marginLeft:"2rem"}},I.createElement("div",{className:"row"},"第 1 天： ",600," 到 ",1200," 论坛财富值"),I.createElement("div",{className:"row"},"第 2 天： ",700," 到 ",1400," 论坛财富值"),I.createElement("div",{className:"row"},"第 3 天： ",800," 到 ",1600," 论坛财富值"),I.createElement("div",{className:"row"},"第 4 天： ",900," 到 ",1800," 论坛财富值"),I.createElement("div",{className:"row"},"第 5 天及以后： ",1e3," 到 ",2e3," 论坛财富值")),e)},e}(I.Component),Bi=(Object(Tr.a)(Fi),Br.a.TextArea),Ai=function(n){function e(e){var t=n.call(this,e)||this;return t.state={announcement:"加载中",info:""},t.changeSiteAnnouncement=t.changeSiteAnnouncement.bind(t),t.clearMainPageCache=t.clearMainPageCache.bind(t),t}return x.c(e,n),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Zn("/config/global")];case 1:return[4,e.sent().json()];case 2:return t=e.sent(),this.setState({announcement:t.announcement}),[2]}})})},e.prototype.changeSiteAnnouncement=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i=this;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),t="/config/global/announcement",[4,Kn()];case 1:return n=e.sent(),a=this.state.announcement,(r=new Headers).append("Authorization",n),r.append("Content-Type","application/json"),[4,Zn(t,{method:"PUT",headers:r,body:JSON.stringify({announcement:a})})];case 2:if(200!==(s=e.sent()).status)throw new Error(s.status.toString());return this.setState({info:"修改全站公告成功"}),setTimeout(function(){i.setState({info:""})},1e3),[3,4];case 3:return o=e.sent(),this.setState({info:"修改失败"+o.message}),[3,4];case 4:return[2]}})})},e.prototype.clearMainPageCache=function(){return x.b(this,void 0,void 0,function(){var t,n,a=this;return x.d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,Xn()];case 1:return[4,Zn("/config/index/update",{method:"PUT",headers:e.sent()})];case 2:if(200!==(t=e.sent()).status)throw new Error(t.status.toString());return this.setState({info:"清除首页缓存成功"}),setTimeout(function(){a.setState({info:""})},1e3),[3,4];case 3:return n=e.sent(),this.setState({info:"清除首页缓存失败 "+n.message}),[3,4];case 4:return[2]}})})},e.prototype.render=function(){var t=this;return I.createElement("div",{style:{marginLeft:"1rem",marginRight:"1rem"}},I.createElement("p",{style:{height:"2rem"}},this.state.info),I.createElement("div",null,I.createElement("div",{style:{display:"flex",fontSize:"20px",alignItems:"center",justifyContent:"center",marginBottom:"1rem"}},I.createElement("div",{style:{marginTop:"10px",marginLeft:"15px",marginRight:"15px"}},"全站公告"),I.createElement("div",{style:{marginLeft:"15px"}}," ",I.createElement(xn.a,{type:"primary",onClick:this.changeSiteAnnouncement},"提交修改")," "),I.createElement("div",{style:{marginLeft:"15px"}}," ",I.createElement(xn.a,{type:"primary",onClick:this.clearMainPageCache},"清除首页缓存")," ")),I.createElement(Bi,{spellCheck:!1,rows:8,onChange:function(e){t.setState({announcement:e.target.value})},value:this.state.announcement}),I.createElement("div",{className:"announcement"},I.createElement("div",{className:"mainPageTitle1"},I.createElement("div",{className:"mainPageTitleRow",style:{width:"100%"}},I.createElement("i",{className:"fa fa-volume-up"}),I.createElement("div",{style:{flexGrow:1},className:"mainPageTitleText"},"全站公告"))),I.createElement("div",{className:"announcementContent"},I.createElement(Ht,{code:this.state.announcement})))))},e}(I.Component),_i=n(507),zi=["推荐阅读","推荐功能","校园新闻","广告"],Vi=["/index/column/recommandationreading","/index/column/recommandationfunction","/index/column/schoolnews","/config/global/advertisement"],Hi=function(){},Wi=function(n){function e(e){var t=n.call(this,e)||this;return t.onPageChange=function(e){t.setState({current:e.current})},t.state={info:"",data:[],type:0,current:1},t.getInfo=t.getInfo.bind(t),t.putCurData=t.putCurData.bind(t),t.handleTdChange=t.handleTdChange.bind(t),t.add=t.add.bind(t),t}return x.c(e,n),e.prototype.getInfo=function(s){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:this.setState({type:Vi.indexOf(s)+1,data:[]}),e.label=1;case 1:return e.trys.push([1,5,,6]),[4,Kn()];case 2:return t=e.sent(),(n=new Headers).append("Authorization",t),[4,Zn(s+"/all",{headers:n})];case 3:return[4,e.sent().json()];case 4:return a=e.sent(),this.setState({data:a}),[3,6];case 5:return r=e.sent(),this.setState({info:r.message}),[3,6];case 6:return[2]}})})},e.prototype.handleTdChange=function(a,r,s){var o=this;this.setState(function(e){var t,n=e.data;n[s]=x.a({},n[s],((t={})[a]=r,t)),o.setState({data:n})})},e.prototype.putCurData=function(i){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o;return x.d(this,function(e){switch(e.label){case 0:this.state.data[i].isNew?(t="/index/column/",n="POST"):(t="/index/column/"+this.state.data[i].id,n="PUT"),e.label=1;case 1:return e.trys.push([1,4,,5]),[4,Kn()];case 2:return a=e.sent(),(r=new Headers).append("Authorization",a),r.append("Content-Type","application/json"),[4,Zn(t,{method:n,headers:r,body:JSON.stringify(this.state.data[i])})];case 3:if(200!==(s=e.sent()).status)throw new Error(s.status.toString());return this.setState({info:"修改成功"}),[3,5];case 4:return o=e.sent(),this.setState({info:o.message}),[3,5];case 5:return[2]}})})},e.prototype.add=function(){this.setState(function(e){var t=new Hi;return t.enable=!0,t.isNew=!0,t.type=e.type,t.id=e.data[0].id+1,{data:[t].concat(e.data)}})},e.prototype.render=function(){var a=this,r=this.state.current,e=[{title:"id",dataIndex:"id",key:"id",width:60},{title:"type",dataIndex:"type",key:"type",width:100,render:function(e){return zi[e-1]}},{title:"title",dataIndex:"title",key:"title",width:200,render:function(e,t,n){return I.createElement(Br.a,{type:"text",onChange:function(e){return a.handleTdChange("title",e.target.value,10*(r-1)+n)},value:e})}},1===this.state.type?{title:"content",dataIndex:"content",key:"content",width:200,render:function(e,t,n){return I.createElement(Br.a,{type:"text",onChange:function(e){return a.handleTdChange("content",e.target.value,10*(r-1)+n)},value:e})}}:null,{title:"url",dataIndex:"url",key:"url",width:140,render:function(e,t,n){return I.createElement(Br.a,{type:"text",onChange:function(e){return a.handleTdChange("url",e.target.value,10*(r-1)+n)},value:e})}},3!==this.state.type?{title:"imageUrl",dataIndex:"imageUrl",key:"imageUrl",width:200,render:function(e,t,n){return I.createElement(Br.a,{type:"text",onChange:function(e){return a.handleTdChange("imageUrl",e.target.value,10*(r-1)+n)},value:e})}}:null,1===this.state.type||2===this.state.type?{title:"orderWeight",dataIndex:"orderWeight",key:"orderWeight",width:150,render:function(e,t,n){return I.createElement(Br.a,{type:"text",onChange:function(e){return a.handleTdChange("orderWeight",e.target.value,10*(r-1)+n)},value:e})}}:null,{title:"enable",dataIndex:"enable",key:"enable",width:80,render:function(e,t,n){return I.createElement(_r.a,{checked:e,onChange:function(e){return a.handleTdChange("enable",e.target.checked,10*(r-1)+n)}})}},4===this.state.type?{title:"days",dataIndex:"days",key:"days",render:function(e,t,n){return I.createElement(Br.a,{type:"text",onChange:function(e){return a.handleTdChange("days",e.target.value,10*(r-1)+n)},value:e})}}:null,4===this.state.type?{title:"expiredTime",dataIndex:"expiredTime",key:"expiredTime",render:function(e){return Cn(e).format("YYYY-MM-DD HH:mm:ss")}}:null,{title:"save",dataIndex:"save",key:"save",width:100,render:function(e,t,n){return I.createElement(xn.a,{type:"primary",onClick:function(e){return a.putCurData(10*(r-1)+n)}},"保存")}}].filter(function(e){if(e)return e});return I.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:"1rem",borderTop:"#eaeaea solid thin",paddingTop:"1rem"}},I.createElement("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center",width:"100%",marginBottom:"1rem"}},I.createElement("div",{style:{marginTop:"10px"}},"自定义栏目"),I.createElement("div",null,I.createElement(xn.a,{type:"primary",disabled:1===this.state.type,onClick:function(){return a.getInfo(Vi[0])}},"推荐阅读")),I.createElement("div",null,I.createElement(xn.a,{type:"primary",disabled:2===this.state.type,onClick:function(){return a.getInfo(Vi[1])}},"推荐功能")),I.createElement("div",null,I.createElement(xn.a,{type:"primary",disabled:3===this.state.type,onClick:function(){return a.getInfo(Vi[2])}},"校园新闻")),I.createElement("div",null,I.createElement(xn.a,{type:"primary",disabled:4===this.state.type,onClick:function(){return a.getInfo(Vi[3])}},"广告")),0<this.state.type?I.createElement("div",null,I.createElement(xn.a,{type:"primary",onClick:function(){return a.add()}},"添加")):null),I.createElement("div",null,I.createElement(_i.a,{bordered:!0,onChange:this.onPageChange,columns:e,dataSource:this.state.data}),I.createElement("p",null,this.state.info)))},e}(I.Component),$i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{style:{backgroundColor:"white",width:"100%"}},I.createElement("div",{style:{display:"flex",justifyContent:"center",fontSize:"24px"}},"全站管理"),I.createElement(Ai,null),I.createElement(Wi,null))},t}(I.Component),Yi=function(n){function e(e){var t=n.call(this,e)||this;return t.addVoteItem=t.addVoteItem.bind(t),t.removeItem=t.removeItem.bind(t),t.changeValue=t.changeValue.bind(t),t}return x.c(e,n),e.isFormIllegal=function(e){if(1e3<e.expiredDays||e.expiredDays<1)return"请输入合法的过期天数";if(e.maxVoteCount>e.voteItems.length||e.maxVoteCount<1)return"请输入合法的最大投票数";for(var t=0;t<e.voteItems.length;t++)if(!e.voteItems[t])return"投票选项不能为空";return!1},e.prototype.addVoteItem=function(){if(19<this.props.voteInfo.voteItems.length)return null;this.props.onVoteInfoChange(x.a({},this.props.voteInfo,{voteItems:this.props.voteInfo.voteItems.concat([""])}))},e.prototype.removeItem=function(e){if(this.props.voteInfo.voteItems.length<3)return null;var t=this.props.voteInfo.voteItems.slice();t.splice(e,1),this.props.onVoteInfoChange(x.a({},this.props.voteInfo,{voteItems:t}))},e.prototype.changeValue=function(e,t){var n;this.props.onVoteInfoChange(x.a({},this.props.voteInfo,((n={})[e]=t,n)))},e.prototype.changeItemValue=function(e,t){var n=this.props.voteInfo.voteItems.slice();n[e]=t,this.props.onVoteInfoChange(x.a({},this.props.voteInfo,{voteItems:n}))},e.prototype.render=function(){var n=this,e=this.props.voteInfo,t=0===e.expiredDays?"":e.expiredDays,a=0===e.maxVoteCount?"":e.maxVoteCount;return I.createElement(I.Fragment,null,I.createElement("div",{className:"createTopicTitle"},I.createElement("span",{className:"createTopicListName"},"投票设置"),I.createElement("span",{style:{paddingLeft:"1rem"}},"有效天数（至少1天，最多1000天）"),I.createElement("input",{style:{width:"8.5rem",borderWidth:"0 1px 0 0",borderStyle:"solid",borderColor:"#e9e9e9",boxSizing:"border-box",margin:"1rem"},name:"expiredDays",type:"number",min:1,max:1e3,placeholder:"请输入有效天数",value:t,onChange:function(e){var t=parseInt(e.target.value||"0");if(1e3<t||t<0)return null;n.changeValue(e.target.name,t)}}),I.createElement("span",null,"最多可投数量（至少1项，最多不超过选项数）"),I.createElement("input",{style:{width:"10rem",borderWidth:"0 1px 0 0",borderStyle:"solid",borderColor:"#e9e9e9",boxSizing:"border-box",margin:"1rem"},name:"maxVoteCount",type:"number",min:1,max:this.props.voteInfo.voteItems.length,placeholder:"请输入最多可投数量",value:a,onChange:function(e){var t=parseInt(e.target.value||"0");if(t>n.props.voteInfo.voteItems.length||t<0)return null;n.changeValue(e.target.name,t)}}),I.createElement("input",{style:{width:"1rem"},id:"needVote",name:"needVote",type:"checkbox",checked:this.props.voteInfo.needVote,onChange:function(e){n.changeValue(e.target.name,e.target.checked)}}),I.createElement("label",{htmlFor:"needVote"},"投票后结果可见")),this.props.voteInfo.voteItems.map(function(e,t){return I.createElement("div",{className:"createTopicTitle"},I.createElement("span",{className:"createTopicListName"},"投票选项",t+1),I.createElement("input",{name:"voteItem",type:"text",value:e,placeholder:"请输入选项内容，不能为空，最多50个字符",maxLength:50,onChange:function(e){if(50<e.target.value.length)return null;n.changeItemValue(t,e.target.value)}}),2<n.props.voteInfo.voteItems.length?I.createElement("button",{type:"button",className:"fa fa-times",onClick:function(){return n.removeItem(t)}}):null)}),I.createElement("button",{type:"button",onClick:this.addVoteItem,className:"hiddenImage",style:{width:"16rem",margin:"0 auto 1rem"}},"添加选项（最少2项，最多20项）"))},e}(I.PureComponent),qi="";var Ji={buttonContentBuilder:function(e){e.iconProvider;return I.createElement("div",null,I.createElement("label",{id:"upload-label",style:{cursor:"pointer",paddingBottom:"0.5rem",paddingTop:"0,5rem",paddingLeft:"1rem",paddingRight:"1rem"},htmlFor:"upload-files"},I.createElement("i",{className:"fa fa-image"})),I.createElement("input",{type:"file",id:"upload-files",style:{display:"none "},onChange:function(n){return x.b(void 0,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return t=n.target,[4,function(a,r){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Ta(a)];case 1:return qi=e.sent(),t=r.editor,n="\n\n![]("+qi+")\n\n",t.setValue(n),[2]}})})}(n,Ji)];case 1:return e.sent(),t.value="",[2]}})})}}))},buttonProps:{handleSubmit:function(e){}},editor:null},Gi=Ji,Qi=n(1236),Ki=n(233),Xi=(Qi.a.MonthPicker,Qi.a.RangePicker),Zi=Ar.a.Option,ec=Br.a.TextArea,tc=function(t){function e(e){var n=t.call(this,e)||this;return n.handleValueChange=function(e){n.setState({mdeState:e})},n.sendMdTopic=function(E){return x.b(n,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f,g,v,b,y;return x.d(this,function(e){switch(e.label){case 0:return t=E,(1!==this.state.tags.length||this.state.tag1)&&(2!==this.state.tags.length||this.state.tag1&&this.state.tag2)?"postVoteTopic"===this.match.params.mode&&(t=!1,n=Yi.isFormIllegal(this.state.voteInfo))?(alert(n),[2,null]):""!=this.state.title?[3,1]:(alert("请输入标题!"),[3,11]):(alert("请选择标签"),[2]);case 1:return e.trys.push([1,10,,11]),r=a=void 0,s="/board/"+this.match.params.id+"/topic",o=this.state.mdeState,i=void 0,this.state.type,[4,Ja(this.state.tag1)];case 2:return a=e.sent(),[4,Ja(this.state.tag2)];case 3:return r=e.sent(),i=a&&!r?{content:o,contentType:1,title:this.state.title,tag1:a,type:this.state.type,notifyPoster:this.state.notice,isAnonymous:t}:r?{content:o,contentType:1,title:this.state.title,tag1:a,tag2:r,type:this.state.type,notifyPoster:this.state.notice,isAnonymous:t}:{content:o,contentType:1,title:this.state.title,type:this.state.type,notifyPoster:this.state.notice,isAnonymous:t},"postVoteTopic"===this.match.params.mode&&(i=x.a({},i,{isVote:!0,voteInfo:this.state.voteInfo})),c=JSON.stringify(i),[4,Kn()];case 4:return l=e.sent(),(u=new Headers).append("Authorization",l),u.append("Content-Type","application/json"),[4,Zn(s,{method:"POST",headers:u,body:c})];case 5:return 402===(m=e.sent()).status&&alert("请输入内容"),400===m.status&&alert("你的财富值余额不足，在本版面发表匿名主题需要10000财富值"),[4,m.text()];case 6:return p=e.sent(),(d=ar(o))?[4,ca(Number(p),1)]:[3,9];case 7:return h=e.sent(),f=h[0],g=f.id,v=JSON.stringify(d),b="/notification/at?topicid="+p+"&postid="+g,(y=new Headers).append("Content-Type","application/json"),y.append("Authorization",l),[4,Zn(b,{method:"POST",headers:y,body:v})];case 8:e.sent(),e.label=9;case 9:return Qn("contentCache"),this.props.history.push("/topic/"+p),[3,11];case 10:return e.sent(),[3,11];case 11:return[2]}})})},n.sendUbbTopic=function(b){return x.b(n,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f,g,v;return x.d(this,function(e){switch(e.label){case 0:return t=b,this.state,(1!==this.state.tags.length||this.state.tag1)&&(2!==this.state.tags.length||this.state.tag1&&this.state.tag2)?"postVoteTopic"===this.match.params.mode&&(t=!1,n=Yi.isFormIllegal(this.state.voteInfo))?(alert(n),[2,null]):""!=this.state.title?[3,1]:(alert("请输入标题！"),[3,11]):(alert("请选择标签"),[2]);case 1:return a="/board/"+this.match.params.id+"/topic",o=s=r=void 0,[4,Ja(this.state.tag1)];case 2:return s=e.sent(),[4,Ja(this.state.tag2)];case 3:return o=e.sent(),r=s&&!o?{content:this.state.content,contentType:0,title:this.state.title,tag1:s,type:this.state.type,notifyPoster:this.state.notice,isAnonymous:t}:o?{content:this.state.content,contentType:0,title:this.state.title,tag1:s,tag2:o,type:this.state.type,notifyPoster:this.state.notice,isAnonymous:t}:{content:this.state.content,contentType:0,title:this.state.title,type:this.state.type,notifyPoster:this.state.notice,isAnonymous:t},"postVoteTopic"===this.match.params.mode&&(r=x.a({},r,{isVote:!0,voteInfo:this.state.voteInfo})),i=JSON.stringify(r),[4,Kn()];case 4:return c=e.sent(),(l=new Headers).append("Authorization",c),l.append("Content-Type","application/json"),[4,Zn(a,{method:"POST",headers:l,body:i})];case 5:return[4,e.sent().text()];case 6:return"cannot_post_in_this_board"!==(u=e.sent())?[3,7]:(Cr.dispatch(fe("CannotPost")),[3,11]);case 7:return(m=ar(this.state.content))?[4,ca(Number(u),1)]:[3,10];case 8:return p=e.sent(),d=p[0],h=d.id,f=JSON.stringify(m),g="/notification/at?topicid="+u+"&postid="+h,(v=new Headers).append("Content-Type","application/json"),v.append("Authorization",c),[4,Zn(g,{method:"POST",headers:v,body:f})];case 9:e.sent(),e.label=10;case 10:Qn("contentCache"),this.props.history.push("/topic/"+u),e.label=11;case 11:return[2]}})})},n.sendOnymousUbbTopic=function(){n.sendUbbTopic(!1)},n.sendAnonymousUbbTopic=function(){n.sendUbbTopic(!0)},n.sendOnymousMdTopic=function(){n.sendMdTopic(!1)},n.sendAnonymousMdTopic=function(){n.sendMdTopic(!0)},n.setValue=function(e){n.setState({mdeState:n.state.mdeState+e},function(){n.setState({mdeState:n.state.mdeState})})},n.notNotice=function(){return x.b(n,void 0,void 0,function(){return x.d(this,function(e){return this.setState({notice:!this.state.notice}),[2]})})},n.showModal=function(){n.setState({houseTmpVisible:!0})},n.handleOk=function(e){n.setState({houseTmpVisible:!1})},n.handleCancel=function(e){n.setState({houseTmpVisible:!1})},n.handleTmpForm=function(e){e.validDate[0];var t="[table]\n    [tr][th]序号[/th][th]信息项[/th][th]描述[/th][/tr]\n    [tr][td]01[/td][td]有效日期[/td][td]"+Cn(e.validDate[0]).format("YYYY-MM-DD")+"-"+Cn(e.validDate[1]).format("YYYY-MM-DD")+"[/td][/tr]\n    [tr][td]02[/td][td]类型[/td][td]"+(e.type||"")+"[/td][/tr]\n    [tr][td]03[/td][td]地区[/td][td]"+(e.district||"")+"[/td][/tr]\n    [tr][td]04[/td][td]小区名称[/td][td]"+(e.neighborhood||"")+"[/td][/tr]\n    [tr][td]05[/td][td]详细地址[/td][td]"+(e.address||"")+"[/td][/tr]\n    [tr][td]06[/td][td]联系方式[/td][td]"+(e.contact||"")+"[/td][/tr]\n    [tr][td]07[/td][td]价格[/td][td]"+(e.price||"")+"[/td][/tr]\n    [tr][td]08[/td][td]租期[/td][td]"+(e.rentDays||"")+"[/td][/tr]\n    [tr][td]09[/td][td]房户类型[/td][td]"+(e.houseType||"")+"[/td][/tr]\n    [tr][td]10[/td][td]出租户型[/td][td]"+(e.rentType||"")+"[/td][/tr]\n    [tr][td]11[/td][td]出租面积[/td][td]"+(e.area||"")+"[/td][/tr]\n    [tr][td]12[/td][td]可租期限[/td][td]"+(e.range||"")+"[/td][/tr]\n    [tr][td]13[/td][td]付款方式[/td][td]"+(e.paymentType||"")+"[/td][/tr]\n    [tr][td]14[/td][td]是否为隔间[/td][td]"+(e.isSingleRoom||"")+"[/td][/tr]\n    [tr][td]15[/td][td]独立电表[/td][td]"+(e.isElectricIsolated||"")+"[/td][/tr]\n    [tr][td]16[/td][td]水电缴费[/td][td]"+(e.waterElecValue||"")+"[/td][/tr]\n    [tr][td]17[/td][td]日常卫生[/td][td]"+(e.cleaning||"")+"[/td][/tr]\n    [tr][td]18[/td][td]维修物业[/td][td]"+(e.repairing||"")+"[/td][/tr]\n    [tr][td]19[/td][td]网络带宽[/td][td]"+(e.networking||"")+"[/td][/tr]\n    [tr][td]20[/td][td]退租方式[/td][td]"+(e.checkout||"")+"[/td][/tr]\n    [tr][td]21[/td][td]其他描述[/td][td]"+(e.otherDescriptions||"")+"[/td][/tr]\n    [tr][td]22[/td][td]其他要求[/td][td]"+(e.otherDemands||"")+"[/td][/tr]\n    [/table]";n.setState({content:t+"\n\n"+n.state.content,houseTmpVisible:!1})},n.update=n.update.bind(n),n.changeEditor=n.changeEditor.bind(n),n.editUBB=n.editUBB.bind(n),n.changeAcademicType=n.changeAcademicType.bind(n),n.changeActivityType=n.changeActivityType.bind(n),n.changeNormalType=n.changeNormalType.bind(n),n.onVoteInfoChange=n.onVoteInfoChange.bind(n),n.converter=new Zr.Converter({tables:!0,simplifiedAutoLink:!0}),n.state={masters:[],tags:[],boardName:"",ready:!1,mode:0,content:"",title:"",postInfo:{floor:0,title:"",content:"",contentType:0},tag1:"",tag2:"",fetchState:"ok",boardId:1,type:0,topicInfo:{},voteInfo:{voteItems:["",""],expiredDays:0,maxVoteCount:0,needVote:!1},mdeState:"",commands:[],notice:!0,houseTmpVisible:!1,anonymousState:0,isAnonymous:!1,wealth:""},n}return x.c(e,t),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m,p,d,h,f,g,v,b,y;return x.d(this,function(e){switch(e.label){case 0:return t=this.match.params.mode,n=this.match.params.id,[4,Kn()];case 1:switch(a=e.sent(),(r=new Headers).append("Authorization",a),Gi.editor=this,c=function(){return[{commands:[Gi]}]},l=Kr.ReactMdeCommands.getDefaultCommands(),(u=l.concat(c()))[1].commands.length=3,this.setState({commands:u}),t){case"postTopic":case"postVoteTopic":return[3,2];case"edit":return[3,6]}return[3,16];case 2:return[4,Zn("/Board/"+n,{headers:r})];case 3:return[4,(s=e.sent()).json()];case 4:return o=e.sent(),m=o.name,p=o.anonymousState,[4,Wa(n)];case 5:return i=e.sent(),this.setState({boardName:m,tags:i,boardId:n,masters:o.boardMasters,anonymousState:p}),[3,16];case 6:return[4,Zn("/post/"+n+"/original",{headers:r})];case 7:return 403===(s=e.sent()).status&&this.setState({fetchState:"not allowed"}),[4,s.json()];case 8:return[4,_a((o=e.sent()).topicId)];case 9:return[4,Ga((d=e.sent()).tag1)];case 10:return(h=e.sent())||(h=""),[4,Ga(d.tag2)];case 11:return(f=e.sent())||(f=""),g=d.type,[4,Wa(o.boardId)];case 12:return i=e.sent(),Jn("contentCache",o.content),Gn("contentCache"),[4,Zn("/Board/"+o.boardId,{headers:r})];case 13:return[4,(s=e.sent()).json()];case 14:return v=e.sent().boardMasters,Gn("userInfo")&&!Ha(v)&&-1===(Gn("userInfo").userTitleIds||[]).indexOf(91)&&1===g&&(g=0),[4,da(o.boardId)];case 15:return b=e.sent(),0===o.contentType?this.setState({masters:v,postInfo:o,content:o.content,title:o.title,boardName:b,boardId:o.boardId,type:g,tags:i,topicInfo:d,tag1:h,tag2:f,mode:0,notice:d.notifyPoster,isAnonymous:o.isAnonymous}):this.setState({masters:v,postInfo:o,content:o.content,title:o.title,boardName:b,boardId:o.boardId,type:g,tags:i,topicInfo:d,tag1:h,tag2:f,mode:1,mdeState:o.content,notice:d.notifyPoster,isAnonymous:o.isAnonymous}),[3,16];case 16:return e.trys.push([16,18,,19]),[4,pr()];case 17:return y=e.sent(),[3,19];case 18:return e.sent(),y="查询财富值余额失败，请前往个人中心查看",[3,19];case 19:return this.setState({wealth:y}),[2]}})})},e.prototype.changeNormalType=function(){this.setState({type:0})},e.prototype.changeAcademicType=function(){this.setState({type:2})},e.prototype.changeActivityType=function(){this.setState({type:1})},e.prototype.ready=function(){this.setState({ready:!0})},e.prototype.changeEditor=function(){confirm("切换编辑器会丢失您之前的编辑内容，确定要切换吗？")&&(0===this.state.mode?this.setState({mode:1}):this.setState({mode:0}))},e.prototype.update=function(e){this.setState({content:e})},e.prototype.editUBB=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u;return x.d(this,function(e){switch(e.label){case 0:return t="/post/"+this.match.params.id,[4,Ja(this.state.tag1)];case 1:return n=e.sent(),[4,Ja(this.state.tag2)];case 2:return a=e.sent(),r=n&&!a?{content:this.state.content,contentType:0,title:this.state.title,tag1:n,type:this.state.type,notifyPoster:this.state.notice}:a?{content:this.state.content,contentType:0,title:this.state.title,tag1:n,tag2:a,type:this.state.type,notifyPoster:this.state.notice}:{content:this.state.content,contentType:0,title:this.state.title,type:this.state.type,notifyPoster:this.state.notice},s=JSON.stringify(r),[4,Kn()];case 3:return e.sent(),[4,Xn()];case 4:return(o=e.sent()).append("Content-Type","application/json"),[4,Zn(t,{method:"PUT",headers:o,body:s})];case 5:return e.sent(),i=this.state.postInfo.floor,c=i%10==0?10:i%10,l=i%10==0?i/10:(i-i%10)/10+1,Qn("contentCache"),u="/topic/"+this.state.postInfo.topicId+"/"+l+"#"+c,this.props.history.push(u),[2]}})})},e.prototype.editMd=function(){return x.b(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u,m;return x.d(this,function(e){switch(e.label){case 0:return t="/post/"+this.match.params.id,n=this.state.mdeState,[4,Ja(this.state.tag1)];case 1:return r=e.sent(),[4,Ja(this.state.tag2)];case 2:return s=e.sent(),!r||s?[3,4]:[4,Ja(this.state.tag1)];case 3:return r=e.sent(),a={content:n,contentType:1,title:this.state.title,tag1:r,type:this.state.type,notifyPoster:this.state.notice},[3,5];case 4:a=s?{content:n,contentType:1,title:this.state.title,tag1:r,tag2:s,type:this.state.type,notifyPoster:this.state.notice}:{content:n,contentType:1,title:this.state.title,type:this.state.type,notifyPoster:this.state.notice},e.label=5;case 5:return o=JSON.stringify(a),[4,Kn()];case 6:return e.sent(),[4,Xn()];case 7:return(i=e.sent()).append("Content-Type","application/json"),[4,Zn(t,{method:"PUT",headers:i,body:o})];case 8:return e.sent(),c=this.state.postInfo.floor,l=c%10==0?10:c%10,u=c%10==0?c/10:(c-c%10)/10+1,m="/topic/"+this.state.postInfo.topicId+"/"+u+"#"+l,Qn("contentCache"),this.props.history.push(m),[2]}})})},e.prototype.onTitleChange=function(e,t,n){""!=e?this.setState({title:e,tag1:t,tag2:n}):this.setState({tag1:t,tag2:n})},e.prototype.onUbbChange=function(e){this.setState({content:e})},e.prototype.onVoteInfoChange=function(e){this.setState({voteInfo:e})},e.prototype.render=function(){var e,t=this,n=(Gn("contentCache"),this.match.params.mode),a=this.match.params.id,r="/board/"+this.state.boardId,s=null;if("postTopic"===n||"postVoteTopic"===n){s=I.createElement(ac,{boardId:a,tags:this.state.tags,onChange:this.onTitleChange.bind(this),title:this.state.postInfo.title,tag1:0,tag2:0});var o=void 0,i=void 0;0===this.state.anonymousState||"postVoteTopic"===n?(o=I.createElement("div",{className:"row",style:{justifyContent:"center"}},I.createElement("button",{id:"post-topic-button",onClick:this.sendOnymousUbbTopic,className:"button blue"},"发帖")),i=I.createElement("div",{className:"row",style:{justifyContent:"center"}},I.createElement("button",{id:"post-topic-button",onClick:this.sendOnymousMdTopic,className:"button blue"},"发帖"))):1===this.state.anonymousState?(o=I.createElement("div",{className:"row",style:{justifyContent:"center"}},I.createElement("button",{id:"post-topic-button-anonymous",onClick:this.sendAnonymousUbbTopic,className:"button grey"},"匿名发帖")),i=I.createElement("div",{className:"row",style:{justifyContent:"center"}},I.createElement("button",{id:"post-topic-button-anonymous",onClick:this.sendAnonymousMdTopic,className:"button grey"},"匿名发帖"))):2===this.state.anonymousState&&(o=I.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},I.createElement("div",null,I.createElement("button",{id:"post-topic-button",onClick:this.sendOnymousUbbTopic,className:"button blue"},"发帖"),I.createElement("button",{id:"post-topic-button-anonymous",onClick:this.sendAnonymousUbbTopic,className:"button grey"},"匿名发帖")),I.createElement("p",null,"在本版面匿名发主题每次需消耗10000财富值。你当前的财富值余额为：",this.state.wealth)),i=I.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},I.createElement("div",null,I.createElement("button",{id:"post-topic-button",onClick:this.sendOnymousMdTopic,className:"button blue"},"发帖"),I.createElement("button",{id:"post-topic-button-anonymous",onClick:this.sendAnonymousMdTopic,className:"button grey"},"匿名发帖")),I.createElement("p",null,"在本版面匿名发主题每次需消耗10000财富值。你当前的财富值余额为：",this.state.wealth))),e=0===this.state.mode?I.createElement("div",null,I.createElement("div",{className:"createTopicContent"},I.createElement("div",{className:"createTopicListName"},"主题内容"),I.createElement("div",{id:"post-topic-changeMode",onClick:this.changeEditor,className:"hiddenImage",style:{width:"12rem",marginTop:"0rem"}},"切换到Markdown编辑器")),I.createElement(jr,{update:this.update,value:this.state.content,option:{height:20,submit:this.sendOnymousUbbTopic}}),o):I.createElement("div",{style:{display:"flex",flexDirection:"column"}},I.createElement("div",{className:"createTopicContent"},I.createElement("div",{className:"createTopicListName"},"主题内容"),I.createElement("div",{id:"post-topic-changeMode",onClick:this.changeEditor,className:"hiddenImage",style:{width:"12rem",marginTop:"0rem"}},"切换到UBB编辑器")),I.createElement(Xr.a,{value:this.state.mdeState,onChange:this.handleValueChange,generateMarkdownPreview:function(e){return Promise.resolve(t.converter.makeHtml(e))},commands:this.state.commands,minEditorHeight:330,maxEditorHeight:500,buttonContentOptions:{iconProvider:function(e){return"heading"===e?I.createElement("i",{className:"fa fa-header"}):I.createElement("i",{className:"fa fa-"+e})}}}),i)}else"edit"===n&&(0===this.state.mode?e=I.createElement("div",null,I.createElement("div",{className:"createTopicContent"},I.createElement("div",{className:"createTopicListName"},"主题内容"),I.createElement("div",{id:"post-topic-changeMode",onClick:this.changeEditor,className:"hiddenImage",style:{width:"12rem",marginTop:"0rem"}},"切换到Markdown编辑器")),I.createElement(jr,{update:this.update,value:this.state.content,option:{submit:this.editUBB.bind(this)}}),I.createElement("div",{className:"row",style:{justifyContent:"center"}},I.createElement("button",{id:"post-topic-button",onClick:this.editUBB,className:"button blue"},"编辑"))):1===this.state.mode&&(e=I.createElement("div",{style:{display:"flex",flexDirection:"column"}},I.createElement("div",{className:"createTopicContent"},I.createElement("div",{className:"createTopicListName"},"主题内容"),I.createElement("div",{id:"post-topic-changeMode",onClick:this.changeEditor,className:"hiddenImage",style:{width:"12rem",marginTop:"0rem"}},"切换到UBB编辑器")),I.createElement(Xr.a,{value:this.state.mdeState,onChange:this.handleValueChange,generateMarkdownPreview:function(e){return Promise.resolve(t.converter.makeHtml(e))},commands:this.state.commands,minEditorHeight:330,maxEditorHeight:500,buttonContentOptions:{iconProvider:function(e){return"heading"===e?I.createElement("i",{className:"fa fa-header"}):I.createElement("i",{className:"fa fa-"+e})}}}),I.createElement("button",{id:"post-topic-button",onClick:this.editMd.bind(this),className:"button blue"},"编辑"))),1===this.state.postInfo.floor&&(s=I.createElement(ac,{boardId:a,tags:this.state.tags,onChange:this.onTitleChange.bind(this),title:this.state.postInfo.title,tag1:this.state.topicInfo.tag1,tag2:this.state.topicInfo.tag2})));this.state.type;var c=I.createElement("div",{className:"createTopicType"},I.createElement("div",{className:"createTopicListName"},"发帖类型"),I.createElement("input",{type:"radio",name:"type",value:"普通",onClick:this.changeNormalType,checked:0===this.state.type})," ","普通",I.createElement("input",{type:"radio",name:"type",value:"学术信息",onClick:this.changeAcademicType,checked:2===this.state.type})," ","学术信息",I.createElement("div",{style:{color:"rgb(255,0,0)"}},"（活动帖和学术帖请选择正确的发帖类型)"));Ha(this.state.masters),Gn("userInfo")&&(Ha(this.state.masters)||-1!==(Gn("userInfo").userTitleIds||[]).indexOf(91))&&(c=I.createElement("div",{className:"createTopicType"},I.createElement("div",{className:"createTopicListName"},"发帖类型"),I.createElement("input",{type:"radio",name:"type",value:"普通",onClick:this.changeNormalType,checked:0===this.state.type})," ","普通",I.createElement("input",{type:"radio",name:"type",value:"学术信息",onClick:this.changeAcademicType,checked:2===this.state.type})," ","学术信息",I.createElement("input",{type:"radio",name:"type",value:"校园活动",onClick:this.changeActivityType,checked:1===this.state.type})," ","校园活动",I.createElement("div",{style:{color:"rgb(255,0,0)"}},"（活动帖和学术帖请选择正确的发帖类型)")));var l=I.createElement("div",{className:"createTopicType"},I.createElement("div",{className:"createTopicListName"},"高级选项"),I.createElement("input",{style:{marginLeft:"5px"},type:"checkbox",name:"option",value:"notNotice",onClick:this.notNotice,checked:this.state.notice})," ","接收消息提醒");1!==this.state.postInfo.floor&&"edit"===n&&(l=c=null);var u=null;return 515===Number(this.state.boardId)&&(u=I.createElement(I.Fragment,null,I.createElement("div",{style:{marginBottom:"15px"}},I.createElement(xn.a,{style:{width:"150px"},type:"primary",size:"default",onClick:this.showModal},"住房信息模板"),I.createElement("span",{style:{color:"red",marginLeft:"10px"}},"(出租、合租、转租、出售等已有房源必填)")),I.createElement(sc,{visible:this.state.houseTmpVisible,submit:this.handleTmpForm}))),I.createElement("div",{className:"createTopic"},I.createElement(nc,{url:r,boardName:this.state.boardName,mode:n}),s,c,l,u,"postVoteTopic"===n?I.createElement(Yi,{voteInfo:this.state.voteInfo,onVoteInfoChange:this.onVoteInfoChange}):null,e)},e}(Sr),nc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={url:"",boardName:""},t}return x.c(e,n),e.prototype.componentWillReceiveProps=function(e){this.setState({url:e.url,boardName:e.boardName})},e.prototype.render=function(){var e;return"postTopic"===this.props.mode?e="发表主题":"edit"===this.props.mode?e="编辑主题":"postVoteTopic"===this.props.mode&&(e="发表投票主题"),I.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"},to:this.state.url},this.state.boardName),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},e))},e}(I.Component),ac=(function(n){function e(e){var t=n.call(this,e)||this;return t.state={},t}x.c(e,n),e.prototype.render=function(){return I.createElement("div",null)}}(I.Component),function(n){function e(e){var t=n.call(this,e)||this;return t.bindEvent=function(){return x.b(t,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u;return x.d(this,function(e){switch(e.label){case 0:return 0===(t=Ee(".tagBoxSelect")).length?[2]:(this.setState({hasEvent:!0}),n=Ee(".downArrow"),a=Ee(".tagBoxSub"),r=a.find("li"),Ee(document).click(function(){a.css("display","none")}),t.click(function(){return"block"===a.css("display")?a.css("display","none"):a.css("display","block"),!1}),n.click(function(){return"block"===a.css("display")?a.css("display","none"):a.css("display","block"),!1}),r.click(function(){t.text(Ee(this).text())}),r.mouseover(function(){this.className="hover"}),r.mouseout(function(){this.className=""}),s=Ee(".tagBoxSelect1"),o=Ee(".downArrow1"),i=Ee(".tagBoxSub1"),c=i.find("li"),Ee(document).click(function(){i.css("display","none")}),s.click(function(){return"block"===i.css("display")?i.css("display","none"):i.css("display","block"),!1}),o.click(function(){return"block"===i.css("display")?i.css("display","none"):i.css("display","block"),!1}),c.click(function(){s.text(Ee(this).text())}),c.mouseover(function(){this.className="hover"}),c.mouseout(function(){this.className=""}),u=l="",0===this.props.tag1?[3,2]:[4,Ga(this.props.tag1)]);case 1:l=e.sent(),e.label=2;case 2:return 0===this.props.tag2?[3,4]:[4,Ga(this.props.tag2)];case 3:u=e.sent(),e.label=4;case 4:return this.props.title&&!this.state.title?this.setState({title:this.props.title,tags:this.props.tags,tag1:l,tag2:u}):this.setState({tags:this.props.tags,tag1:l,tag2:u}),[2]}})})},t.handleTagChange=t.handleTagChange.bind(t),t.handleTitleChange=t.handleTitleChange.bind(t),t.generateTagOption=t.generateTagOption.bind(t),t.state={title:t.props.title,tags:t.props.tags,tag1:"",tag2:"",hasEvent:!1},t}return x.c(e,n),e.prototype.handleTitleChange=function(e){var t,n;0===this.state.tags.length?this.props.onChange(e.target.value,"",""):1===this.state.tags.length?(t=Ee(".tagBoxSelect").text(),this.props.onChange(e.target.value,t,"")):(t=Ee(".tagBoxSelect").text(),n=Ee(".tagBoxSelect1").text(),this.props.onChange(e.target.value,t,n)),this.setState({title:e.target.value})},e.prototype.handleTagChange=function(){var e=Ee(".tagBoxSelect").text(),t=Ee(".tagBoxSelect1").text();this.props.onChange("",e,t)},e.prototype.componentWillReceiveProps=function(e){e.title&&!this.state.title?this.setState({title:e.title,tags:e.tags}):this.setState({tags:e.tags})},e.prototype.componentDidMount=function(){0<this.state.tags.length&&this.bindEvent()},e.prototype.componentDidUpdate=function(){this.state.hasEvent||this.bindEvent()},e.prototype.generateTagOption=function(e){return I.createElement("li",{onClick:this.handleTagChange},e.name)},e.prototype.render=function(){var e=null,t=null;0<this.state.tags.length&&(e=I.createElement("ul",{className:"tagBoxSub"},this.state.tags[0].tags.map(this.generateTagOption))),2===this.state.tags.length&&(t=I.createElement("ul",{className:"tagBoxSub1"},this.state.tags[1].tags.map(this.generateTagOption)));var n=null;if(2===this.state.tags.length){var a="",r="";this.state.tag1&&(a=this.state.tag1),this.state.tag2&&(r=this.state.tag2),n=I.createElement("div",{className:"row"},I.createElement("div",{className:"row"},I.createElement("div",{className:"tagBoxSelect"},a),I.createElement("div",{className:"downArrow"},I.createElement("img",{src:"/static/images/downArrow.png",width:"12",height:"12"})),e),I.createElement("div",{className:"row"},I.createElement("div",{className:"tagBoxSelect1"},r),I.createElement("div",{className:"downArrow1"},I.createElement("img",{src:"/static/images/downArrow.png",width:"12",height:"12"})),t))}else if(1==this.state.tags.length){a="";this.state.tag1&&(a=this.state.tag1),n=I.createElement("div",{className:"row"},I.createElement("div",{className:"tagBoxSelect"},a),I.createElement("div",{className:"downArrow"},I.createElement("img",{src:"/static/images/downArrow.png",width:"12",height:"12"})),e)}return I.createElement("div",{className:"createTopicTitle"},I.createElement("div",{className:"createTopicListName"},"主题标题"),n,I.createElement("input",{value:this.state.title,placeholder:"请输入新主题的标题",onChange:this.handleTitleChange.bind(this)}))},e}(I.Component)),rc=(function(n){function e(e){var t=n.call(this,e)||this;return t.state={},t}x.c(e,n),e.prototype.render=function(){return I.createElement("div",{className:"createTopicOption"},I.createElement("div",{className:"createTopicListName"},"选项"),I.createElement("input",{type:"radio",checked:!0,name:"option",value:"all"}),"回复所有人可见",I.createElement("input",{type:"radio",name:"option",value:"host"}),"回复仅楼主可见",I.createElement("input",{type:"radio",name:"option",value:"special"}),"回复仅特定用户可见")}}(I.Component),function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={elecRadio:"",waterElecRadio:"",elecValue:"",waterElecValue:"",visible:n.props.visible},n.onWaterElecChange=function(e){n.setState({waterElecRadio:e.target.value})},n.onElecChange=function(e){n.setState({elecRadio:e.target.value})},n.onHandleSubmit=function(e){e.preventDefault();n.refs.tmpForm;n.props.form.validateFields(function(e,t){e||("其他"===n.state.elecRadio&&(t.isElectricIsolated=n.state.elecValue),"其他"===n.state.waterElecRadio&&(t.waterElecValue=n.state.waterElecValue),n.props.submit(t),n.setState({visible:!1}))})},n.onCancel=function(){n.setState({visible:!1})},n}return x.c(t,e),t.prototype.componentWillReceiveProps=function(e){this.setState({visible:e.visible})},t.prototype.render=function(){var t=this,e=this.props.form.getFieldDecorator;return I.createElement(Tn.a,{title:"住房信息模板",visible:this.state.visible,onOk:this.onHandleSubmit,onCancel:this.onCancel},I.createElement(Lr.a,x.a({ref:"tmpForm",style:{maxHeight:"500px",overflowY:"scroll"}},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.onHandleSubmit}),I.createElement(Lr.a.Item,{label:"有效时间"},e("validDate",{rules:[{type:"array",required:!0,message:"Please select time!"}]})(I.createElement(Xi,{renderExtraFooter:function(){return"不能大于2周，到期可编辑"}}))),I.createElement(Lr.a.Item,{label:"类型",hasFeedback:!0},e("type",{rules:[{required:!0,message:"请选择类型!"}]})(I.createElement(Ar.a,{placeholder:"请选择类型"},I.createElement(Zi,{value:"整租"},"整租"),I.createElement(Zi,{value:"合租"},"合租"),I.createElement(Zi,{value:"转租"},"转租"),I.createElement(Zi,{value:"出售"},"出售"),I.createElement(Zi,{value:"其他"},"其他")))),I.createElement(Lr.a.Item,{label:"地区"},e("district",{})(I.createElement(Br.a,{placeholder:"例如：紫金港 / 玉泉 / 文一西路xx路交叉口处 / 上海的xx路附近"}))),I.createElement(Lr.a.Item,{label:"小区名称"},e("neighborhood",{})(I.createElement(Br.a,{placeholder:"例如：港湾家园"}))),I.createElement(Lr.a.Item,{label:"详细地址"},e("address",{})(I.createElement(Br.a,{placeholder:"例如：余杭塘路866号港湾家园X幢X单元X号"}))),I.createElement(Lr.a.Item,{label:"联系方式"},e("contact",{})(I.createElement(Br.a,{placeholder:"例如：张房东 电话18888888888 / 李女士 微信1234abc"}))),I.createElement(Lr.a.Item,{label:"价格"},e("price",{})(I.createElement(Br.a,{placeholder:"例如：2000元/月"}))),I.createElement(Lr.a.Item,{label:"租期"},e("rentDays",{})(I.createElement(Br.a,{placeholder:"例如：6个月起租"}))),I.createElement(Lr.a.Item,{label:"房户类型"},e("houseType",{})(I.createElement(Br.a,{placeholder:"例如：4室0厅1阳1卫1厨（指包括要出租的房间数量，加上公用的区域，私用的不算入）"}))),I.createElement(Lr.a.Item,{label:"出租类型"},e("rentType",{})(I.createElement(Br.a,{placeholder:"（指本次出租的房间）例如： 单间（独卫带阳台）/ 单间（独卫）/  单间 "}))),I.createElement(Lr.a.Item,{label:"出租面积"},e("area",{})(I.createElement(Br.a,{placeholder:"（指本次出租的房间）例如：20平米"}))),I.createElement(Lr.a.Item,{label:"可租期限"},e("range",{})(I.createElement(Br.a,{placeholder:"例如：到2017年11月7日 / 长期 （指合约可以签到什么时候）"}))),I.createElement(Lr.a.Item,{label:"付款方式"},e("paymentType",{})(I.createElement(Br.a,{placeholder:" 例如：押1付1  /  押1付2"}))),I.createElement(Lr.a.Item,{label:"是否为隔间"},e("isSingleRoom",{rules:[{required:!0,message:"请输入是否为隔间!"}]})(I.createElement(Ki.a.Group,null,I.createElement(Ki.a,{value:"是"},"是"),I.createElement(Ki.a,{value:"否"},"否")))),I.createElement(Lr.a.Item,{label:"独立电表"},e("isElectricIsolated",{rules:[{required:!0,message:"请输入电表方式!"}]})(I.createElement(Ki.a.Group,{onChange:this.onElecChange},I.createElement(Ki.a,{value:"是"},"是"),I.createElement(Ki.a,{value:"否"},"否"),I.createElement(Ki.a,{value:"空调独立电表"},"空调独立电表"),I.createElement(Ki.a,{value:"其他"},"其他","其他"===this.state.elecRadio?I.createElement(Br.a,{onChange:function(e){return t.setState({elecValue:e.target.value})},style:{width:100,marginLeft:10}}):null)))),I.createElement(Lr.a.Item,{label:"水电缴费"},e("waterElecValue",{rules:[{required:!0,message:"请输入水电缴费!"}]})(I.createElement(Ki.a.Group,{onChange:this.onWaterElecChange},I.createElement(Ki.a,{value:"每月一付"},"每月一付"),I.createElement(Ki.a,{value:"每季一付"},"每季一付"),I.createElement(Ki.a,{value:"退租结算"},"退租结算"),I.createElement(Ki.a,{value:"其他"},"其他","其他"===this.state.elecRadio?I.createElement(Br.a,{onChange:function(e){return t.setState({waterElecValue:e.target.value})},style:{width:100,marginLeft:10}}):null)))),I.createElement(Lr.a.Item,{label:"日常卫生"},e("cleaning",{})(I.createElement(Br.a,{placeholder:"例如：自理 / 每周1次"}))),I.createElement(Lr.a.Item,{label:"维修物业"},e("repairing",{})(I.createElement(Br.a,{placeholder:"例如：合租统一由房东承担、整租自行商议"}))),I.createElement(Lr.a.Item,{label:"网络带宽"},e("networking",{})(I.createElement(Br.a,{placeholder:"例如：有，电信20M宽带 / 无，自理"}))),I.createElement(Lr.a.Item,{label:"退租方式"},e("checkout",{})(I.createElement(Br.a,{placeholder:"例如：合同到期，退还钥匙取回全额押金"}))),I.createElement(Lr.a.Item,{label:"其他描述"},e("otherDescriptions",{rules:[{required:!1}]})(I.createElement(ec,{rows:4,placeholder:"此处添加任何合适的描述，可以包括家具设备、地理优势、水电网物业详细、入住情况、朝向等相关信息描述"}))),I.createElement(Lr.a.Item,{label:"其他要求"},e("otherDemands",{rules:[{required:!1}]})(I.createElement(ec,{rows:4,placeholder:"例如：无 / 由于XXX原因，希望找一个男生/女生/上班族/不接受情侣/……"}))),I.createElement(Lr.a.Item,null,"图片请点击下方编辑器的图片上传按钮上传，其他未尽内容请在下方编辑器输入。")))},t}(I.Component)),sc=Lr.a.create()(rc),oc=Object(Tr.a)(tc),ic=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"30日热门话题"))},t}(I.Component);function cc(e){return I.createElement(Ko,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}var lc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={data:[],from:0,loading:!0,buttonClassName:""},t}return x.c(e,n),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,lr("monthly")];case 1:return t=e.sent(),this.setState({data:t}),[2]}})})},e.prototype.render=function(){return I.createElement("div",{className:"focus-root"},I.createElement(Wt,{title:"30日热门话题 - CC98论坛"}),I.createElement("div",{className:"focus"},I.createElement(ic,null),I.createElement("div",{className:"focus-topic-area"},I.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(cc)))))},e}(I.Component),uc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"7日热门话题"))},t}(I.Component);function mc(e){return I.createElement(Ko,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}var pc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={data:[],from:0,loading:!0,buttonClassName:""},t}return x.c(e,n),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,lr("weekly")];case 1:return t=e.sent(),this.setState({data:t}),[2]}})})},e.prototype.render=function(){return I.createElement("div",{className:"focus-root"},I.createElement(Wt,{title:"7日热门话题 - CC98论坛"}),I.createElement("div",{className:"focus"},I.createElement(uc,null),I.createElement("div",{className:"focus-topic-area"},I.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(mc)))))},e}(I.Component),dc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){return I.createElement("div",{className:"row",style:{alignItems:"baseline",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement("div",{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem",marginRight:"0.5rem"}},"历史上的今天"))},t}(I.Component);function hc(e){return I.createElement(Ko,{title:e.title,hitCount:e.hitCount,id:e.id,boardId:e.boardId,boardName:e.boardName,replyCount:e.replyCount,userId:e.userId,userName:e.userName,portraitUrl:e.portraitUrl,time:e.time,likeCount:e.likeCount,dislikeCount:e.dislikeCount,lastPostUser:e.lastPostUser,lastPostTime:e.lastPostTime,tag1:e.tag1,tag2:e.tag2,floorCount:e.floorCount})}var fc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={data:[],from:0,loading:!0,buttonClassName:""},t}return x.c(e,n),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,lr("history")];case 1:return t=e.sent(),this.setState({data:t}),[2]}})})},e.prototype.render=function(){return I.createElement("div",{className:"focus-root"},I.createElement(Wt,{title:"历史上的今天 - CC98论坛"}),I.createElement("div",{className:"focus"},I.createElement(dc,null),I.createElement("div",{className:"focus-topic-area"},I.createElement("div",{className:"focus-topic-topicArea"},this.state.data.map(hc)))))},e}(I.Component),gc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.componentWillReceiveProps=function(e){this.props.location.pathname!==e.location.pathname&&this.props.solveError()},t.prototype.render=function(){return null},t}(I.Component);var vc=Object(Nr.b)(function(e){return{isError:e.error.isError}},function(e){return{solveError:function(){e(ge())}}})(gc),bc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=this.props.data;return i.a.createElement("div",{className:"annual-review-2020-page annual-review-2020-page-bg-cat",style:{lineHeight:1.25}},i.a.createElement("div",{style:{fontWeight:"bolder",marginTop:"2rem"}},"亲爱的CC98用户 ",e.userInfo.name,"："),i.a.createElement("img",{style:{borderRadius:"50%",marginTop:"0.5rem"},width:"60px",src:""+e.userInfo.portraitUrl}),i.a.createElement("div",null,"在过去的2020年里，你有",i.a.createElement("span",{className:"annual-review-page2-topicCount"},e.postDay),"天"),i.a.createElement("div",null,"在CC98论坛上留下了痕迹。"),i.a.createElement("div",{style:{marginTop:"1rem"}},"你发表了",i.a.createElement("span",{className:"annual-review-page2-topicCount"},e.topicCount),"个主题帖，"),i.a.createElement("div",null,"进行了",i.a.createElement("span",{className:"annual-review-page2-replyCount"},e.replyCount),"次回复，"),0!==e.hotTopicCount&&i.a.createElement("div",null,"上了",i.a.createElement("span",{className:"annual-review-page2-hotTopicCount"},e.hotTopicCount),"次十大热门话题。"),0===e.hotTopicCount&&i.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"1rem"}},i.a.createElement("div",null,"很遗憾，"),i.a.createElement("div",null,"你的主题帖没上过十大热门话题。")))},t}(i.a.Component),yc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=this.props.data;return i.a.createElement("div",{className:"annual-review-2020-page annual-review-2020-page-bg-rabbit"},i.a.createElement("div",{style:{marginTop:"1rem"}},"你送出了",i.a.createElement("span",{className:"annual-review-page2-topicCount"},e.sendLikeCount),"个赞，"),i.a.createElement("div",null,"收到他人给你的",i.a.createElement("span",{className:"annual-review-page2-replyCount"},e.receiveLikeCount),"个赞。"),i.a.createElement("div",{style:{marginTop:"1.5rem"}},"你给他人评分",i.a.createElement("span",{className:"annual-review-page2-topicCount"},e.sendRateCount),"次，"),i.a.createElement("div",null,"收到了他人给你的",i.a.createElement("span",{className:"annual-review-page2-replyCount"},e.receiveRateCount),"次评分。"),20<e.sofaCount&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{marginTop:"1.5rem"}},"你眼疾手快，"),i.a.createElement("div",null,"抢到了",i.a.createElement("span",{className:"annual-review-page2-replyCount"},e.sofaCount),"次沙发。")),e.sofaCount<=20&&0<e.sofaCount&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{marginTop:"1.5rem"}},"你手速尚可，"),i.a.createElement("div",null,"抢到了",i.a.createElement("span",{className:"annual-review-page2-replyCount"},e.sofaCount),"次沙发。")),0===e.sofaCount&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{marginTop:"1.5rem"}},"你佛系水帖，"),i.a.createElement("div",null,"从未抢到过沙发。")))},t}(i.a.Component),Ec=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=this.props.data;return e.mostReplyTopicCount||e.mostViewTopicCount?i.a.createElement("div",{className:"annual-review-2020-page annual-review-2020-page-bg-cat"},i.a.createElement("div",null,"在你一年发表的主题帖中，"),0!==e.mostReplyTopicCount&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"收到最多回复的一次，"),i.a.createElement("div",null,"共有",i.a.createElement("span",{className:"annual-review-page2-topicCount"},e.mostReplyTopicCount),"个回复；")),0!==e.mostViewTopicCount&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"点击量最多的一次，"),i.a.createElement("div",null,"共有",i.a.createElement("span",{className:"annual-review-page2-replyCount"},e.mostViewTopicCount),"次点击。")),0!==e.mostReceiveLikePostCount&&i.a.createElement("div",{style:{marginTop:"2rem"}},"你收获他人点赞最多的一个发言，"),0!==e.mostReceiveLikePostCount&&i.a.createElement("div",null,"共收到了",i.a.createElement("span",{className:"annual-review-page2-hotTopicCount"},e.mostReceiveLikePostCount),"个赞。")):i.a.createElement("div",{className:"annual-review-2020-page annual-review-2020-page-bg-cat"},"在过去的一年里，你还没有发过主题帖...")},t}(i.a.Component);n(1220);Nn.a.locale("zh-cn");var Ic=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.getBoardUrlById=function(e){return"/board/"+e},t.prototype.render=function(){var e=this.props.data,t=null;return t=e.board1||e.board2||e.board3?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{marginTop:"2rem"}},"你最爱发言的版面是："),i.a.createElement("div",null,i.a.createElement("a",{href:this.getBoardUrlById(e.board1)},i.a.createElement("span",{className:"annual-review-page2-topicCount"},pa(e.board1)))),i.a.createElement("div",null,e.board2&&i.a.createElement("a",{href:this.getBoardUrlById(e.board2)},i.a.createElement("span",{className:"annual-review-page2-replyCount"},pa(e.board2)))),i.a.createElement("div",null,e.board3&&i.a.createElement("a",{href:this.getBoardUrlById(e.board3)},i.a.createElement("span",{className:"annual-review-page2-hotTopicCount"},pa(e.board3))))):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"你在过去的一年中没有发言，"),i.a.createElement("div",null,"新的一年要加油哦~")),i.a.createElement("div",{className:"annual-review-2020-page annual-review-2020-page-bg-rabbit"},t,e.latestPostTime&&i.a.createElement("div",{style:{marginTop:"1rem"}},"在"," ",i.a.createElement("span",{className:"annual-review-page2-hotTopicCount"},Nn()(e.latestPostTime).format("LL")),"这天，"),e.latestPostTime&&i.a.createElement("div",null,"你熬夜得最晚，"),e.latestPostTime&&i.a.createElement("div",null," ",i.a.createElement("span",{className:"annual-review-page2-topicCount"},Nn()(e.latestPostTime).format("a hh [:] mm")),"还在98发言。"))},t}(i.a.Component),wc=n(159),Cc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.getBoardUrlById=function(e){return"/board/"+e},t.prototype.render=function(){var e=this.props.data,t=null;0<e.postCount06&&(t="深夜"),e.postCount612>e.postCount06&&e.postCount612>e.postCount1218&&e.postCount612>e.postCount1824&&(t="上午"),e.postCount1218>e.postCount06&&e.postCount1218>e.postCount612&&e.postCount1218>e.postCount1824&&(t="下午"),e.postCount1824>e.postCount06&&e.postCount1824>e.postCount1218&&e.postCount1824>e.postCount612&&(t="晚上");var n=[{time:"上午",posts:e.postCount612},{time:"下午",posts:e.postCount1218},{time:"晚上",posts:e.postCount1824},{time:"深夜",posts:e.postCount06}];return i.a.createElement("div",{className:"annual-review-2020-page annual-review-2020-page-bg-cat"},t&&i.a.createElement("div",{style:{marginTop:"7rem",marginBottom:"-2rem"}},"你最喜欢在",i.a.createElement("span",{className:"annual-review-page1-during"},t),"水98。"),i.a.createElement("div",{style:{marginTop:"3rem"}},"你发言的时间段统计如下："),i.a.createElement("div",{style:{marginTop:"1rem",marginRight:"2rem"}},i.a.createElement(wc.Chart,{width:.5*document.body.clientHeight,height:.35*document.body.clientHeight,data:n,scale:{posts:{alias:"帖数"}},forceFit:!0},i.a.createElement(wc.Axis,{name:"time"}),i.a.createElement(wc.Axis,{name:"posts"}),i.a.createElement(wc.Tooltip,{crosshairs:{type:"y"}}),i.a.createElement(wc.Geom,{type:"interval",position:"time*posts"}))))},t}(i.a.Component),Nc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=this.props.data.achievement.split("|"),n=["magenta","volcano","gold","lime"];return i.a.createElement("div",{className:"annual-review-2020-page annual-review-2020-page-bg-rabbit"},i.a.createElement("div",null,"你获得了以下成就："),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-around",marginTop:"0.5rem",marginLeft:"1rem",marginRight:"1rem",flexWrap:"wrap"}},e.map(function(e,t){return i.a.createElement(ms.a,{style:{fontSize:"2vh",height:"3vh",lineHeight:"2.5vh",marginBottom:"0.5rem"},color:n[t%4]},e)})),i.a.createElement("div",{style:{marginTop:"2rem"}},"在新春佳节到来之际，"),i.a.createElement("div",null,"CC98论坛祝你："),i.a.createElement("div",null,i.a.createElement("span",{className:"annual-review-page6-congratulation"},"身体健康")),i.a.createElement("div",null,i.a.createElement("span",{className:"annual-review-page6-congratulation"},"学习生活顺利")),i.a.createElement("div",null,i.a.createElement("span",{className:"annual-review-page6-congratulation"},"幸福2021")))},t}(i.a.Component),Tc=function(){return i.a.createElement("div",{className:"annual-review-2020-page",style:{backgroundImage:"url('/static/images/annual-review/cover.jpg')"}})},Sc=n(29),xc=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={data:null,page:0},t.previousPage=function(){0<t.state.page&&t.setState({page:t.state.page-1})},t.nextPage=function(){t.state.page<6&&t.setState({page:t.state.page+1})},t.handleWheel=function(e){0<e.deltaY?t.nextPage():e.deltaY<0&&t.previousPage()},t}return x.c(t,e),t.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return ha()?(t="/me/annual-review-2020",[4,Xn()]):(Cr.dispatch(fe("LogOut")),[2,null]);case 1:return n=e.sent(),[4,Zn(t,{headers:n})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}()];case 1:return t=e.sent(),this.setState({data:t}),[2]}})})},t.prototype.render=function(){var t=this,e=this.state,n=e.data,a=e.page;navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i);return n?(Gn("userInfo")&&(n.userInfo=Gn("userInfo")),i.a.createElement("div",{className:"annual-review-body"},0!==a?i.a.createElement(Sc.a,{type:"up",onClick:this.previousPage,style:{fontSize:"2rem",cursor:"pointer",zIndex:99}}):i.a.createElement("div",{style:{height:"2rem"}}),0===a&&i.a.createElement("div",{onWheel:function(e){return t.handleWheel(e)}},i.a.createElement(Tc,null)),1===a&&i.a.createElement("div",{onWheel:function(e){return t.handleWheel(e)},onMouseDown:this.nextPage},i.a.createElement(bc,{data:n})),2===a&&i.a.createElement("div",{onWheel:function(e){return t.handleWheel(e)},onMouseDown:this.nextPage},i.a.createElement(yc,{data:n})),3===a&&i.a.createElement("div",{onWheel:function(e){return t.handleWheel(e)},onMouseDown:this.nextPage},i.a.createElement(Ec,{data:n})),4===a&&i.a.createElement("div",{onWheel:function(e){return t.handleWheel(e)},onMouseDown:this.nextPage},i.a.createElement(Ic,{data:n})),5===a&&i.a.createElement("div",{onWheel:function(e){return t.handleWheel(e)},onMouseDown:this.nextPage},i.a.createElement(Cc,{data:n})),6===a&&i.a.createElement("div",{onWheel:function(e){return t.handleWheel(e)}},i.a.createElement(Nc,{data:n})),6!==a&&i.a.createElement(Sc.a,{type:"down",onClick:this.nextPage,style:{fontSize:"2rem",cursor:"pointer",zIndex:99}}))):i.a.createElement(kn.a,null)},t}(i.a.Component),kc={announcement:"",hotTopic:[{id:0,title:"",boardId:0,boardName:"",participantCount:0,replyCount:0,hitCount:0,authorName:"",createTime:"",type:0}],recommendationReading:[{id:0,type:0,title:"",content:"",url:"",imageUrl:"",enable:!1,time:"",orderWeight:0,expiredTime:null}],recommendationFunction:[{id:0,type:0,title:"",content:null,url:"",imageUrl:"",enable:!1,time:"",orderWeight:0,expiredTime:null}],schoolNews:[{id:0,type:0,title:"",content:null,url:"",imageUrl:null,enable:!1,time:"",orderWeight:0,expiredTime:null}],schoolEvent:[{id:0,boardId:0,title:"",state:0,type:0,isInternalOnly:!1,isVote:!1}],academics:[{id:0,boardId:0,title:"",state:0,type:0,isInternalOnly:!1,isVote:!1}],study:[{id:0,boardId:0,title:"",state:0,type:0,isInternalOnly:!1,isVote:!1}],emotion:[{id:0,boardId:0,title:"",state:0,type:0,isInternalOnly:!1,isVote:!1}],fleaMarket:[{id:0,boardId:0,title:"",state:0,type:0,isInternalOnly:!1,isVote:!1}],partTimeJob:[{id:0,boardId:0,title:"",state:0,type:0,isInternalOnly:!1,isVote:!1}],fullTimeJob:[{id:0,boardId:0,title:"",state:0,type:0,isInternalOnly:!1,isVote:!1}],todayCount:0,topicCount:0,postCount:0,userCount:0,lastUserName:"",onlineUserCount:0,lastUpdateTime:""},Pc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={data:kc},t}return x.c(e,n),e.prototype.render=function(){return I.createElement(I.Fragment,null,I.createElement(Wt,{title:"CC98论坛"}))},e}(I.Component);function Uc(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn(a,{headers:t})];case 2:switch((n=e.sent()).status){case 404:return[2,"not found"];case 500:return[2,"server error"]}return[4,n.json()];case 3:return[2,e.sent()]}})})}function Mc(a,r){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t="/board/"+a+"/events?from="+r+"&size=7",[4,Xn()];case 1:return n=e.sent(),[4,Zn(t,{headers:n})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}var Rc=n(1233),Oc=as.a.Panel,Dc=Br.a.TextArea,jc={background:"#f7f7f7",borderRadius:4,marginBottom:24,border:0,overflow:"hidden",width:"100%"},Lc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={isFollow:Ra(e.props.data.id),loading:!1,editVisible:!1,content:e.props.data.bigPaper},e}return x.c(e,t),e.prototype.onError=function(e){e.preventDefault(),e.target.src="/static/images/_CC98.png"},e.prototype.generateMasters=function(e){var t=e.toString(),n="/user/name/"+encodeURIComponent(e.toString());return I.createElement("div",{style:{marginRight:"10px",fontSize:"0.75rem"}},I.createElement("a",{href:n},t))},e.prototype.follow=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return this.setState({loading:!0}),[4,Oa(this.props.data.id)];case 1:return e.sent(),this.setState({isFollow:!0,loading:!1}),[2]}})})},e.prototype.unfollow=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return this.setState({loading:!0}),[4,ja(this.props.data.id)];case 1:return e.sent(),this.setState({isFollow:!1,loading:!1}),[2]}})})},e.prototype.editBigPaper=function(){return x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return[4,function(r,s){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return t="/board/"+r+"/big-paper",[4,Xn()];case 1:return(n=e.sent()).append("Content-Type","application/json"),a=JSON.stringify({content:s}),[4,Zn(t,{method:"PUT",headers:n,body:a})];case 2:return[2,e.sent()]}})})}(this.props.data.id.toString(),this.state.content)];case 1:return e.sent(),this.setState({editVisible:!1}),[2]}})})},e.prototype.render=function(){var t=this,e=this.props,n=e.data,a=e.isFirstPage,r=this.state,s=r.isFollow,o=r.loading,i=r.editVisible,c=r.content,l="/static/images/_"+n.name+".png",u=Ha(n.boardMasters),m=I.createElement("div",{className:"row",style:{height:"4rem"}},I.createElement("div",null,I.createElement("img",{className:"board-avatar",onError:this.onError,src:l})),I.createElement("div",{className:"board-head-name"},n.name),I.createElement(Rc.a,{type:"vertical"}),I.createElement("div",{className:"column",style:{marginLeft:"1rem",marginRight:"1rem"}},I.createElement("div",null,"版面简介：",n.description),I.createElement("div",{className:"row"},"版主：",n.boardMasters.map(this.generateMasters))),I.createElement("div",{className:"row",style:{marginRight:"1rem",flexGrow:2,justifyContent:"flex-end",height:"100%"}},I.createElement("div",{className:"column",style:{marginLeft:"1rem",marginRight:"1rem",height:"100%",justifyContent:"space-around"}},I.createElement("div",{className:"row"},I.createElement(ms.a,{color:"grey",style:{width:"5rem",textAlign:"center",marginRight:0,borderTopRightRadius:0,borderBottomRightRadius:0}},"今日贴数"),I.createElement(ms.a,{className:"board-head-information",style:{width:"5rem",textAlign:"center",marginRight:0,borderLeft:0,borderTopLeftRadius:0,borderBottomLeftRadius:0}},n.todayCount)),I.createElement("div",{className:"row"},I.createElement(ms.a,{color:"grey",style:{width:"5rem",textAlign:"center",marginRight:0,borderTopRightRadius:0,borderBottomRightRadius:0}},"总主题数"),I.createElement(ms.a,{className:"board-head-information",style:{width:"5rem",textAlign:"center",marginRight:0,borderLeft:0,borderTopLeftRadius:0,borderBottomLeftRadius:0}},n.topicCount))),I.createElement(xn.a,{loading:o,onClick:s?function(){return t.unfollow()}:function(){return t.follow()}},s?"取关":"关注"),u&&I.createElement(xn.a,{style:{marginLeft:"0.5rem"},onClick:function(){return t.setState({editVisible:!0})}},"编辑")));return I.createElement("div",{style:{width:"100%"}},I.createElement(Tn.a,{title:"编辑大字报",visible:i,onOk:function(){return t.editBigPaper()},onCancel:function(){return t.setState({editVisible:!1})},width:"50rem"},"支持UBB代码",I.createElement(Dc,{rows:6,defaultValue:n.bigPaper,onChange:function(e){return t.setState({content:e.target.value})}}),I.createElement(Ht,{code:c,options:x.a({},new Ce,{allowToolbox:!0})})),I.createElement(as.a,{className:"board-bigpaper",bordered:!1,defaultActiveKey:a?["1"]:[]},I.createElement(Oc,{key:"1",showArrow:!1,header:m,style:jc},n.bigPaper&&I.createElement(I.Fragment,null," ",I.createElement(Rc.a,null),I.createElement(Ht,{code:n.bigPaper,options:x.a({},new Ce,{allowToolbox:!0})})))))},e}(I.Component),Fc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=this.props,t=e.data,n=e.page,a=null,r=!1,s=!1,o=!0;return Gn("userInfo")?(r=!0,Gn("userInfo").isVerified?s=!0:(s=!1,a=I.createElement("div",{style:{marginLeft:"1rem",color:"red"}},"您的帐号未认证，无法发言，请先前往",I.createElement("a",{href:"https://account.cc98.org"},"https://account.cc98.org"),"认证激活。")),0!==Gn("userInfo").lockState?(o=!0,a=I.createElement("div",{style:{marginLeft:"1rem",color:"red"}},"您被全站禁言。")):o=!1):a=I.createElement("div",{style:{marginLeft:"1rem",color:"red"}},"您还未登录，不能发帖，请先登录"),I.createElement("div",{className:"board-head-body"},I.createElement(Bc,{data:t}),I.createElement(Lc,{key:n,data:t,isFirstPage:"1"===n}),I.createElement("div",{className:"board-head-bar"},r&&s&&!o?I.createElement("div",{className:"row"},I.createElement(It.a,{to:"/editor/postTopic/"+t.id},I.createElement(xn.a,{className:"board-head-button"},"发主题")),I.createElement(It.a,{to:"/editor/postVoteTopic/"+t.id},I.createElement(xn.a,{className:"board-head-button",style:{marginLeft:"1rem"}},"发投票"))):a,I.createElement(bn,null)))},t}(I.Component),Bc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e="/board/"+this.props.data.id;return I.createElement("div",{className:"row",style:{alignItems:"baseline",width:"100% ",justifyContent:"flex-start",color:"grey",fontSize:"0.75rem",marginBottom:"1rem"}},I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem"},to:"/"},"首页"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginRight:"0.5rem",marginLeft:"0.5rem"},to:"/boardlist"},"版面列表"),I.createElement("i",{className:"fa fa-chevron-right"}),I.createElement(It.a,{style:{color:"grey",fontSize:"1rem",marginLeft:"0.5rem"},to:e},this.props.data.name))},t}(I.Component),Ac=n(231),_c=n(1234),zc=n(232);var Vc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={posts:[]},e}return x.c(e,t),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,function(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/topic/"+a+"/post?from=0&size=10",{headers:t})];case 2:switch((n=e.sent()).status){case 404:return[2,"not found"];case 500:return[2,"server error"]}return[4,n.json()];case 3:return[2,e.sent()]}})})}(this.props.data.id)];case 1:return t=e.sent(),this.setState({posts:t}),[2]}})})},e.prototype.render=function(){var e=this.state.posts;return 0===e.length?I.createElement(kn.a,{size:"large"}):I.createElement("div",{className:"board-postItem-cards"},e.map(function(e){return I.createElement(Hc,{key:e.id,item:e})}))},e}(I.Component),Hc=function(e){var t=e.item;return I.createElement("div",{className:"board-postItem-card-body"},I.createElement("div",{className:"board-postItem-card-information"},I.createElement("div",null,t.floor,"L"),I.createElement(It.a,{to:"/user/id/"+t.userId},I.createElement("div",{className:"board-postItem-card-username"},t.userName))),I.createElement("div",{className:"board-postItem-card-content"},I.createElement(Ht,{code:t.content,options:x.a({},new Ce,{allowToolbox:!0})})))},Wc=function(e){var t,r=e.data,n=e.order,a="normal",s="普通帖子";switch(Gn("userInfo")&&(t=Gn("userInfo").name),r.userName===t&&(a="my",s="我的帖子"),100<r.replyCount&&(a="hot",s="热帖"),1===r.state&&(a="lock",s="已被锁定"),1===r.bestState&&(a="star",s="精华"),r.topState){case 4:a="top-red",s="全站置顶";break;case 2:a="top-orange",s="版面置顶"}var o="/static/images/icon/"+a+".png",i="";i=n%2==0?"board-postItem-body board-postItem-body-even":"board-postItem-body board-postItem-body-odd";var c=I.createElement(Vc,{key:r.id,data:r}),l="#000",u="normal",m="normal";r.highlightInfo&&(r.highlightInfo.isBold&&(u="bold"),r.highlightInfo.isItalic&&(m="italic"),r.highlightInfo.color&&(l=r.highlightInfo.color));var p=r.replyCount+1,d=p%10==0?p/10:(p-p%10)/10+1,h=[];if(1===d);else if(d<=7)for(var f=1;f<=d;f++)h.push(f);else h.push(1,2,3,4,-1,d-2,d-1,d);for(var g="",v="",b=0,y=JSON.parse(localStorage.getItem("tagInfo").slice(4));b<y.length;b++){var E=y[b];E.id===r.tag1&&(g="["+E.name+"]"),E.id===r.tag2&&(v="["+E.name+"]")}return I.createElement(_c.a,{title:I.createElement(It.a,{style:{lineHeight:"1rem"},to:"/topic/"+r.id},r.title),content:c,mouseEnterDelay:1.5},I.createElement("div",{className:i},I.createElement(zc.a,{title:s},I.createElement("div",{className:"board-postItem-icon"},I.createElement("img",{src:o}))),I.createElement("div",{className:"board-postItem-title",style:{display:"flex"}},I.createElement(It.a,{to:"/topic/"+r.id,style:{color:l,fontWeight:u,fontStyle:m,marginRight:"0.3rem",fontSize:"1rem"}},""+g+v+r.title),h.map(function(e){return t=e,n=r.id,a="/topic/"+n+"/"+t,-1!=t?I.createElement("div",{style:{marginRight:"0.3rem"}},I.createElement(It.a,{style:{color:"#79b8ca"},to:a},t)):I.createElement("div",{style:{marginRight:"0.3rem"}},"...");var t,n,a})),I.createElement("div",{className:"board-postItem-right"},r.userName?I.createElement(It.a,{className:"board-postItem-userName",to:"/user/id/"+r.userId},r.userName):I.createElement("div",{className:"board-postItem-userName"},"匿名"),I.createElement("div",{className:"board-postItem-tags"},I.createElement("div",{className:"board-postItem-tag"},I.createElement(ms.a,{style:{width:60,textAlign:"center"},color:"blue"},1e4<r.hitCount?(r.hitCount/1e4).toFixed(0)+"万":r.hitCount)),I.createElement("div",{className:"board-postItem-tag"},I.createElement(ms.a,{style:{width:60,textAlign:"center"},color:"cyan"},r.replyCount))),I.createElement(It.a,{to:"/topic/"+r.id+"/"+Math.ceil((r.replyCount+1)/10)},I.createElement("div",{className:"board-postItem-lastReply"},I.createElement("span",null,r.lastPostUser),"/",I.createElement("span",null,Nn()(r.lastPostTime).format("YY-MM-DD HH:mm")))))))},$c=function(e){var t=e.list;return I.createElement("div",{className:"board-list-body"},t.map(function(e,t){return I.createElement(Wc,{key:t,order:t,data:e})}))},Yc=Ar.a.Option,qc=function(e){var t=e.onChange,n=e.tags,a=e.handleTag1Change,r=e.handleTag2Change;return I.createElement("div",{className:"board-postItem-head"},I.createElement("div",{className:"board-postItem-head-left"},I.createElement("div",{className:"board-postItem-head-left-part"},I.createElement("div",{className:"board-postItem-head-option",onClick:function(){return t(0)}},"全部"),I.createElement("div",{className:"board-postItem-head-option",onClick:function(){return t(1)}},"精华"),I.createElement("div",{className:"board-postItem-head-option",onClick:function(){return t(2)}},"保存")),I.createElement("div",{className:"board-postItem-head-left-part"},0<n.length?I.createElement(Ar.a,{defaultValue:-1,style:{width:120},onChange:a},I.createElement(Yc,{value:-1},"全部"),n[0].tags.map(function(e){return I.createElement(Yc,{value:e.id},e.name)})):null,1<n.length?I.createElement(Ar.a,{defaultValue:-1,style:{width:120,marginLeft:20},onChange:r},I.createElement(Yc,{value:-1},"全部"),n[1].tags.map(function(e){return I.createElement(Yc,{value:e.id},e.name)})):null)),I.createElement("div",{className:"board-postItem-head-right"},I.createElement("div",{className:"board-postItem-head-userName"},"作者"),I.createElement("div",{className:"board-postItem-head-hitcount"},"点击"),I.createElement("div",{className:"board-postItem-head-reply"},"回复"),I.createElement("div",{className:"board-postItem-head-lastReply"},"最后回复")))},Jc=n(1239),Gc=n(1238),Qc=Ar.a.Option,Kc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={visible:!1,tpList:[],loading:!1,hasMore:!0,manageVisible:!1,recordVisible:!1},e.showModal=function(){return x.b(e,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,ur(this.props.data.id,0,6)];case 1:return t=e.sent(),n=!0,t.length<21?n=!1:t.pop(),this.setState({visible:!0,tpList:t,hasMore:n}),[2]}})})},e.handleOk=function(){e.setState({manageVisible:!1})},e.handleCancel=function(){e.setState({visible:!1})},e.cancelTp=function(a){return x.b(e,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,La(a.userId,this.props.data.id)];case 1:return"ok"!==(t=e.sent())?[3,3]:[4,ur(this.props.data.id,0,5)];case 2:return n=e.sent(),this.setState({tpList:n}),[3,4];case 3:alert("操作失败,原因："+t),e.label=4;case 4:return[2]}})})},e.openRecord=function(){return e.setState({recordVisible:!0})},e}return x.c(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.data,a=e.list,r=n.id,s=Ha(n.boardMasters);return I.createElement(I.Fragment,null,I.createElement("div",{className:"row",style:{width:"100%",justifyContent:"flex-end"}},I.createElement(xn.a,{onClick:this.openRecord},"查看版面事件"),I.createElement(xn.a,{onClick:this.showModal},"小黑屋"),s&&I.createElement(xn.a,{onClick:function(){return t.setState({manageVisible:!0})}},"批量管理")),I.createElement(Xc,{key:this.state.manageVisible.toString(),data:n,list:a,visible:this.state.manageVisible,onClose:this.handleOk}),I.createElement(Tn.a,{title:"小黑屋",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,width:s?"60rem":"45rem"},I.createElement(Sn.a,{dataSource:this.state.tpList,pagination:{onChange:function(a){return x.b(t,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,ur(r,5*(a-1),6)];case 1:return 0<(t=e.sent()).length&&(this.state.tpList.pop(),n=this.state.tpList.concat(t),this.setState({tpList:n})),[2]}})})},pageSize:5,simple:!0},renderItem:function(e){return I.createElement(Sn.a.Item,{key:e.userId},I.createElement(Sn.a.Item.Meta,{title:e.userName?I.createElement("a",{href:"https://www.cc98.org/user/"+e.userId},e.userName):I.createElement("div",null,"匿名"),description:I.createElement("div",null,I.createElement("span",null,"天数:",e.days),I.createElement("span",{style:{marginLeft:"2rem",marginRight:"2rem"}},"到期时间:",Nn()(e.expiredTime).format("YYYY-MM-DD HH:mm:ss")),I.createElement(xn.a,{onClick:t.cancelTp.bind(t,e),type:"primary",style:{display:s?"":"none"}},"解除tp"))}),I.createElement("div",null,"操作人:",e.operatorUserName))}},this.state.loading&&this.state.hasMore&&I.createElement("div",{className:"demo-loading-container"},I.createElement(kn.a,null)))),I.createElement(Tn.a,{title:"版面事件",visible:this.state.recordVisible,onOk:function(){return t.setState({recordVisible:!1})},onCancel:function(){return t.setState({recordVisible:!1})},width:"60rem"},I.createElement(Zc,{id:r.toString()})))},e}(I.Component),Xc=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={targetKeys:[],selectedKeys:[],lockVisible:!1,deleteVisible:!1,reason:"",value:7},n.handleChange=function(e){n.setState({targetKeys:e})},n.handleSelectChange=function(e,t){n.setState({selectedKeys:e.concat(t)})},n.handleScroll=function(e,t){t.target},n.openNotification=function(){var e={message:"操作错误",description:"请至少选择一个帖子",duration:4.5,icon:I.createElement(Sc.a,{type:"close-circle",style:{color:"red"}})};Jc.a.open(e)},n.multiDelete=function(){return x.b(n,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return t=this.state,n=t.targetKeys,a=t.reason,0===n.length?(this.openNotification(),[2]):[4,function(s,o){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return(t=e.sent()).append("Content-Type","application/json"),n="id=",n+=s.join("&id="),a="/topic/multi-delete?"+n,r=JSON.stringify({reason:o}),[4,Zn(a,{method:"PUT",headers:t,body:r})];case 2:return[2,e.sent()]}})})}(n,a)];case 1:return e.sent(),this.setState({deleteVisible:!1}),[2]}})})},n.multiLock=function(){return x.b(n,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return t=this.state,n=t.targetKeys,a=t.reason,r=t.value,0===n.length?(this.openNotification(),[2]):[4,function(s,o,i){return x.b(this,void 0,void 0,function(){var t,n,a,r;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),n="id=",n+=s.join("&id="),a="/topic/multi-lock?"+n,r=JSON.stringify({reason:o,value:i}),t.append("Content-Type","application/json"),[4,Zn(a,{method:"PUT",headers:t,body:r})];case 2:return[2,e.sent()]}})})}(n,a,r)];case 1:return e.sent(),this.setState({lockVisible:!1}),[2]}})})},n}return x.c(t,e),t.prototype.render=function(){for(var t=this,e=this.props,n=(e.data,e.list),a=e.visible,r=this.state,s=r.targetKeys,o=r.selectedKeys,i=r.lockVisible,c=r.deleteVisible,l=[],u=0,m=n;u<m.length;u++){var p=m[u];l.push({key:p.id.toString(),title:p.title})}return I.createElement(I.Fragment,null,I.createElement(Tn.a,{title:"批量管理",visible:a,onOk:function(){return t.props.onClose()},onCancel:function(){return t.props.onClose()},maskClosable:!1,width:"50rem",footer:[I.createElement(xn.a,{onClick:function(){return t.props.onClose()}},"取消"),I.createElement(xn.a,{type:"primary",onClick:function(){return t.setState({lockVisible:!0})}},"锁沉"),I.createElement(xn.a,{type:"primary",onClick:function(){return t.setState({deleteVisible:!0})}},"删除")]},I.createElement(Gc.a,{dataSource:l,titles:["Source","Target"],targetKeys:s,selectedKeys:o,onChange:this.handleChange,onSelectChange:this.handleSelectChange,render:function(e){return e.title},listStyle:{width:"20rem",height:"40rem"}})),I.createElement(Tn.a,{title:"批量删除",visible:c,onOk:function(){return t.multiDelete()},onCancel:function(){return t.setState({deleteVisible:!1})}},I.createElement("div",null,"理由"),I.createElement(Ar.a,{style:{width:120},mode:"tags",onSelect:function(e){t.setState({reason:e.toString()})}},I.createElement(Qc,{value:"重复发帖"},"重复发帖"),I.createElement(Qc,{value:"管理要求"},"管理要求"),I.createElement(Qc,{value:"已解决"},"已解决"),I.createElement(Qc,{value:"内容不符"},"内容不符"),I.createElement(Qc,{value:"违反版规"},"违反版规"))),I.createElement(Tn.a,{title:"批量锁沉",visible:i,onOk:function(){return t.multiLock()},onCancel:function(){return t.setState({lockVisible:!1})}},I.createElement("div",null,"理由"),I.createElement(Ar.a,{style:{width:120},mode:"tags",onSelect:function(e){return t.setState({reason:e.toString()})}},I.createElement(Qc,{value:"重复发帖"},"重复发帖"),I.createElement(Qc,{value:"管理要求"},"管理要求"),I.createElement(Qc,{value:"已解决"},"已解决"),I.createElement(Qc,{value:"内容不符"},"内容不符"),I.createElement(Qc,{value:"违反版规"},"违反版规")),I.createElement("div",null,"天数"),I.createElement(Ar.a,{style:{width:120},defaultValue:"7",onSelect:function(e){return t.setState({value:parseInt(e.toString())})}},I.createElement(Qc,{value:"7"},"7"),I.createElement(Qc,{value:"30"},"30"),I.createElement(Qc,{value:"98"},"98"),I.createElement(Qc,{value:"1000"},"1000"))))},t}(I.Component),Zc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={current:1,data:null,loading:!1},e}return x.c(e,t),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return this.setState({loading:!0}),[4,Mc(this.props.id,0)];case 1:return t=e.sent(),this.setState({data:t,loading:!1}),[2]}})})},e.prototype.render=function(){var e=this,r=this.props.id,t=this.state,n=t.loading,a=t.data;return a&&I.createElement(Sn.a,{dataSource:a?a.boardEvents:[],pagination:{onChange:function(a){return x.b(e,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return this.setState({loading:!0}),[4,Mc(r,7*(a-1))];case 1:return t=e.sent(),n=t.boardEvents,t.boardEvents=n,this.setState({data:t,loading:!1}),[2]}})})},pageSize:7,total:a.count},renderItem:function(e){return I.createElement(Sn.a.Item,{key:e.id},I.createElement(Sn.a.Item.Meta,{title:I.createElement("a",{href:"https://www.cc98.org/topic/"+e.topicId},e.content),description:I.createElement("div",null,I.createElement("span",null,"对象:",e.targetUserName||"匿名"),I.createElement("span",{style:{marginLeft:"2rem",marginRight:"2rem"}},"时间:",Nn()(e.time).format("YYYY-MM-DD HH:mm:ss")))}),I.createElement("div",null,"操作人:",e.operatorUserName))}},n&&I.createElement("div",{className:"demo-loading-container"},I.createElement(kn.a,null)))},e}(I.Component),el=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.state={list:[],topList:[],type:0,topicCount:0,tags:[],tag1:-1,tag2:-1},a.getBoardTags=function(){return x.b(a,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,function(n){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/board/"+n+"/tag",{headers:t})];case 2:return[4,e.sent().json()];case 3:return[2,e.sent()]}})})}(this.props.data.id)];case 1:return t=e.sent(),this.setState({tags:t}),[2]}})})},a.getTopics=function(c){return x.b(a,void 0,void 0,function(){var t,n,a,r,s,o,i;return x.d(this,function(e){switch(e.label){case 0:return t=this.props.data,n=this.state,a=n.type,r=n.tag1,s=n.tag2,o=[],i=null,-1!==r||-1!==s?[3,7]:0!==a?[3,2]:[4,function(n,a){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return t=20*(parseInt(a)-1),[4,Uc("/board/"+n+"/topic?from="+t+"&size=20")];case 1:return[2,e.sent()]}})})}(t.id,c)];case 1:return o=e.sent(),this.setState({list:o}),[3,6];case 2:return 1!==a?[3,4]:[4,function(n,a){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return t=20*(parseInt(a)-1),[4,Uc("/topic/best/board/"+n+"?from="+t+"&size=20")];case 1:return[2,e.sent()]}})})}(t.id,c)];case 3:return i=e.sent(),o=i.topics,this.setState({list:o,topicCount:i.count}),[3,6];case 4:return[4,function(n,a){return x.b(this,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return t=20*(parseInt(a)-1),[4,Uc("/topic/save/board/"+n+"?from="+t+"&size=20")];case 1:return[2,e.sent()]}})})}(t.id,c)];case 5:i=e.sent(),o=i.topics,this.setState({list:o,topicCount:i.count}),e.label=6;case 6:return[3,9];case 7:return[4,function(a,r,s,o){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return t=20*(parseInt(r)-1),n="",-1!==s&&(n+="tag1="+s+"&"),-1!==o&&(n+="tag2="+o+"&"),[4,Uc("/topic/search/board/"+a+"/tag?"+n+"from="+t+"&size=20")];case 1:return[2,e.sent()]}})})}(t.id,c,r,s)];case 8:i=e.sent(),o=i.topics,this.setState({list:o,topicCount:i.count}),e.label=9;case 9:return[2]}})})},a.getTopTopics=function(){return x.b(a,void 0,void 0,function(){var t;return x.d(this,function(e){switch(e.label){case 0:return[4,function(a){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/topic/toptopics?boardid="+a,{headers:t})];case 2:switch((n=e.sent()).status){case 404:return[2,"not found"];case 500:return[2,"server error"]}return[4,n.json()];case 3:return[2,e.sent()]}})})}(this.props.data.id)];case 1:return t=e.sent(),this.setState({topList:t}),[2]}})})},a.onChange=function(e){a.getTopics(e);var t=window.location.pathname;"1"===a.props.page?"1"===t.substr(t.lastIndexOf("/")+1)?a.props.history.push(t.substr(0,t.lastIndexOf("/"))+"/"+e):a.props.history.push(t+"/"+e):a.props.history.push(t.substr(0,t.lastIndexOf("/"))+"/"+e)},a.changeType=function(e){var t=a.props,n=(t.data,t.page);a.setState({type:e},function(){return a.getTopics(n)})},a.handleTag1Change=function(e){a.setState({tag1:e},function(){return a.getTopics(a.props.page)})},a.handleTag2Change=function(e){a.setState({tag2:e},function(){return a.getTopics(a.props.page)})},a}return x.c(t,e),t.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){return t=this.props,n=t.page,a=t.data,this.setState({topicCount:a.topicCount}),this.getTopTopics(),this.getTopics(n),this.getBoardTags(),[2]})})},t.prototype.render=function(){var t=this,e=this.props.data,n=this.state,a=n.list,r=n.topList,s=n.topicCount,o=n.tags,i=parseInt(this.props.page),c=1===i?[].concat(r).concat(a):[].concat(a);return 0===c.length?I.createElement(kn.a,{size:"large"}):I.createElement(I.Fragment,null,I.createElement("div",{className:"board-list-bar"},I.createElement(Ac.a,{className:"board-pagination",showQuickJumper:!0,current:i,total:s,pageSize:20,onChange:this.onChange})),I.createElement(qc,{onChange:function(e){return t.changeType(e)},tags:o,handleTag1Change:this.handleTag1Change,handleTag2Change:this.handleTag2Change}),I.createElement($c,{list:c}),I.createElement("div",{className:"board-list-bar"},I.createElement(Ac.a,{className:"board-pagination",showQuickJumper:!0,current:i,pageSize:20,total:s,onChange:this.onChange})),I.createElement(Kc,{data:e,list:a}))},t}(Sr),tl=Object(Tr.a)(el),nl=Object(Tr.a)(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={data:null},e}return x.c(e,t),e.prototype.componentDidMount=function(){return x.b(this,void 0,void 0,function(){var t,n;return x.d(this,function(e){switch(e.label){case 0:return[4,Ya()];case 1:return e.sent(),t=this.match.params,[4,function(r){return x.b(this,void 0,void 0,function(){var t,n,a;return x.d(this,function(e){switch(e.label){case 0:return[4,Xn()];case 1:return t=e.sent(),[4,Zn("/board/"+r,{headers:t})];case 2:switch((n=e.sent()).status){case 404:return[2,"not found"];case 500:return[2,"server error"]}return[4,n.json()];case 3:return!1===(a=e.sent()).canEntry?[2,"unauthorized"]:[2,a]}})})}(t.id)];case 2:return"not found"===(n=e.sent())?this.props.history.push("/error/404"):"unauthorized"===n?this.props.history.push("/error/401"):"server error"===n?this.props.history.push("/error/500"):this.setState({data:n}),[2]}})})},e.prototype.render=function(){var e=this.state.data,t=this.match.params.page;return e?I.createElement("div",{className:"board-body"},I.createElement(Fc,{data:e,page:t||"1"}),I.createElement(tl,{data:e,page:t||"1"})):null},e}(Sr)),al=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x.c(t,e),t.prototype.render=function(){var e=I.createElement($t.a,null,I.createElement(Yt.a,{exact:!0,path:"/",component:wn}),I.createElement(Yt.a,{exact:!0,path:"/topic/hot-monthly",component:lc}),I.createElement(Yt.a,{exact:!0,path:"/topic/hot-weekly",component:pc}),I.createElement(Yt.a,{exact:!0,path:"/topic/hot-history",component:fc}),I.createElement(Yt.a,{exact:!0,path:"/topic/:topicid/:page?",component:js}),I.createElement(Yt.a,{exact:!0,path:"/topic/:topicId/postid/:postId/:page?",component:Ps}),I.createElement(Yt.a,{path:"/list/:boardId/:type?/:page?",component:Un}),I.createElement(Yt.a,{exact:!0,path:"/boardlist",component:Ls}),I.createElement(Yt.a,{path:"/usercenter",component:Do}),I.createElement(Yt.a,{path:"/message",component:Qo}),I.createElement(Yt.a,{path:"/focus",component:oi}),I.createElement(Yt.a,{path:"/newtopics",component:Xo}),I.createElement(Yt.a,{path:"/user/:method/:id",component:xi}),I.createElement(Yt.a,{path:"/logon",exact:!0,component:Pi}),I.createElement(Yt.a,{path:"/search",component:Mi}),I.createElement(Yt.a,{path:"/searchBoard",component:Di}),I.createElement(Yt.a,{path:"/signin",component:Fi}),I.createElement(Yt.a,{path:"/sitemanage",component:$i}),I.createElement(Yt.a,{path:"/editor/:mode/:id?",component:oc}),I.createElement(Yt.a,{path:"/board/:id/:page?",component:nl}),I.createElement(Yt.a,{path:"/annual-review-2020",component:xc}),I.createElement(Yt.a,{path:"/error/401",component:Xt}),I.createElement(Yt.a,{path:"/index",component:Pc}),I.createElement(Yt.a,{component:ln}));return I.createElement(I.Fragment,null,I.createElement(m.a,{history:Ir},I.createElement("div",{className:"main-container"},I.createElement(mi,null),I.createElement(Yt.a,{component:vc}),this.props.isError?I.createElement(Yt.a,{component:o[this.props.errorMessage]}):e,I.createElement(pi,null))))},t}(I.Component);var rl=Object(Nr.b)(function(e){return{isError:e.error.isError,errorMessage:e.error.errorMessage}})(al),sl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={isError:!1,error:null},e}return x.c(e,t),e.prototype.componentDidCatch=function(e){console.error(e),this.setState({isError:!0,error:e})},e.prototype.handleClick=function(e){e.preventDefault(),location.reload(!0)},e.prototype.render=function(){if(this.state.isError){var e={cursor:"pointer",color:"#0000ee"};return I.createElement("div",{style:{paddingLeft:"2rem"}},I.createElement("h1",null,"Something went wrong"),I.createElement("p",null,"you can ",I.createElement("a",{href:"#",style:e,onClick:this.handleClick},"refresh")," to retry."),I.createElement("p",null,"if this still happens, please contact with ",I.createElement("a",{style:e,href:"mailto:contact@cc98.org"},"contact@cc98.org"),"."),I.createElement("hr",null),I.createElement("p",null,this.state.error.name,": ",this.state.error.message),I.createElement("p",null,"URL: ",location.href),I.createElement("p",null,"platform: ",navigator.platform),I.createElement("p",null,"appVersion: ",navigator.appVersion),I.createElement("p",{style:{whiteSpace:"pre-wrap"}},this.state.error.stack))}return this.props.children},e}(I.PureComponent),ol=n(506),il=n.n(ol),cl=n(1235);Nn.a.locale("zh-cn"),function(){x.b(this,void 0,void 0,function(){return x.d(this,function(e){switch(e.label){case 0:return[4,At.loadConfig()];case 1:return e.sent(),ea?[4,zt.start()]:[3,3];case 2:e.sent(),e.label=3;case 3:return console.info("%cCC98 Durian","font-size: 80px; fontFamily: Big"),c.render(I.createElement(sl,null,I.createElement(Nr.a,{store:Cr},I.createElement(cl.a,{locale:il.a},I.createElement(rl,null)))),document.getElementById("root")),[2]}})})}()},13:function(e,t){e.exports=$},936:function(e){e.exports=JSON.parse('[{"tagName":"b","tagIcon":"fa-bold","title":"加粗","type":"text"},{"tagName":"i","tagIcon":"fa-italic","title":"斜体","type":"text"},{"tagName":"u","tagIcon":"fa-underline","title":"下划线","type":"text"},{"tagName":"del","tagIcon":"fa-strikethrough","title":"删除线","type":"text"},{"tagName":"align","tagIcon":"fa-align-left","title":"左对齐","type":"text","mainValue":"left"},{"tagName":"align","tagIcon":"fa-align-center","title":"居中","type":"text","mainValue":"center"},{"tagName":"align","tagIcon":"fa-align-right","title":"右对齐","type":"text","mainValue":"right"},{"tagName":"replyview","tagIcon":"fa-eye-slash","title":"回复后可见","type":"text"},{"tagName":"size","tagIcon":"fa-text-height","title":"选择字号","type":"fontSize","fontSize":[0,1,2,3,4,5,6,7]},{"tagIcon":"fa-eyedropper","type":"color"},{"tagName":"emoji","tagIcon":"fa-smile-o","title":"插入表情","type":"emoji"},{"tagName":"url","tagIcon":"fa-link","tagDescription":"","title":"插入url","type":"extend","contentValueInfo":"在此输入连接地址"},{"tagName":"img","tagIcon":"fa-picture-o","tagDescription":"","title":"插入图片","type":"extend","contentValueInfo":"在此输入图片文件地址","allowUpload":true,"hasCompassOption":true},{"tagName":"video","tagIcon":"fa-film","title":"插入视频","type":"extend","contentValueInfo":"在此输入视频文件地址","allowUpload":true},{"tagName":"bili","tagDescription":"Bili","title":"插入Bilibili视频","type":"extend","contentValueInfo":"在此输入AV号（纯数字）或者BV号（以BV开头的字符串）","propertiesInfos":[{"key":"","title":"在此输入要显示的分P序号（默认为1）","defaultValue":"1"}]},{"tagName":"audio","tagIcon":"fa-music","title":"插入音频","type":"extend","contentValueInfo":"在此输入音频文件地址","allowUpload":true},{"tagName":"upload","tagIcon":"fa-file","type":"upload","title":"上传文件"}]')},937:function(e){e.exports=JSON.parse('{"fileExtendedNames":{"video":[],"audio":[],"image":[]},"shouldNotSelect":["img","video","audio","upload","bili"]}')}});